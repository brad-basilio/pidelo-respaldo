import{j as e}from"./AboutHeader-COUW3Uy_.js";import{r as n}from"./index-CqkZ-sT_.js";import{C as I}from"./CardHoverBtn-CgVpcroB.js";import{I as K}from"./ItemsRest-COC0wVJZ.js";import{L as V,N as T}from"./NoResult-CROInX6p.js";import{C as v}from"./chevron-down-CxOx8ByU.js";import{S as $}from"./search-DhoFIDMi.js";import{C as Z}from"./check-CvqheCNB.js";import{c as D}from"./createLucideIcon-D0vxYqnu.js";import"./ProductCard-DppMoL6U.js";import"./main-CkMzf7wF.js";import"./___vite-browser-external_commonjs-proxy-DA7w84js.js";import"./BasicEditing-CqE15M_Q.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=D("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),U=({options:u=[],placeholder:f="Select an option",onChange:C,valueKey:k,labelKey:_,label:b,labelClass:S,className:P,disabled:d=!1})=>{const[x,c]=n.useState(!1),[i,m]=n.useState(null),[j,F]=n.useState(""),h=n.useRef(null),y=u.length>0&&typeof u[0]=="object",L=y?k||Object.keys(u[0])[0]:null,O=y?_||Object.keys(u[0])[1]:null,p=u.map(t=>y?{value:t[L],label:t[O]}:{value:t,label:t}).filter(t=>t.label.toLowerCase().includes(j.toLowerCase()));n.useEffect(()=>{const t=N=>{h.current&&!h.current.contains(N.target)&&c(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const g=t=>{m(t),C(t.value),c(!1)};return e.jsxs("div",{className:"relative w-full",ref:h,children:[b&&e.jsx("label",{className:`block text-sm mb-1 customtext-neutral-dark ${S}`,children:b}),e.jsxs("button",{className:`w-full relative text-start  px-4 py-3 border customtext-neutral-dark   rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300 ${P}`,onClick:()=>c(!x),"aria-haspopup":"listbox","aria-expanded":x,disabled:d,children:[e.jsx("span",{className:"block truncate",children:i?i.label:f}),e.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center justify-center py-3 pr-2 pointer-events-none",children:e.jsx(v,{className:`w-5 h-5 customtext-neutral-dark transition-transform duration-200 ${x?"rotate-180":""}`})})]}),x&&e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white rounded-lg shadow-lg max-h-60 overflow-auto",children:[e.jsx("div",{className:"sticky top-0 bg-white p-2",children:e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Search options...",value:j,onChange:t=>F(t.target.value)})]})}),e.jsx("ul",{className:"py-1",role:"listbox",children:p.map(t=>e.jsxs("li",{className:`px-4 py-2 cursor-pointer flex items-center justify-between 
                                    ${i&&i.value===t.value?"bg-blue-500 text-white":"hover:bg-gray-100"}`,onClick:()=>g(t),role:"option","aria-selected":i&&i.value===t.value,children:[e.jsx("span",{className:"block truncate",children:t.label}),i&&i.value===t.value&&e.jsx(Z,{className:"w-5 h-5"})]},t.value))})]})]})},q=new K,ce=({items:u,data:f,filteredData:C,cart:k,setCart:_})=>{const{categories:b,brands:S,priceRanges:P}=C,[d,x]=n.useState({marca:!0,precio:!0,categoria:!0,colores:!1}),[c,i]=n.useState({category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[m,j]=n.useState([]),[F,h]=n.useState(!1),[y,L]=n.useState({currentPage:1,totalPages:1}),O=s=>{const a=[];if(s.category_id.length>0){const r=s.category_id.map(l=>["category_id","=",l]);a.push(["or",...r])}if(s.subcategory_id.length>0){const r=s.subcategory_id.map(l=>["subcategory_id","=",l]);a.push(["and",...r])}if(s.brand_id.length>0){const r=s.brand_id.map(l=>["brand_id","=",l]);a.push(["or",...r])}return s.price&&a.push(["and",[["final_price",">=",s.price.min],"and",["final_price","<=",s.price.max]]]),s.name&&a.push(["name","contains",s.name]),a},A=async(s=1)=>{h(!0);try{const r={filter:O(c),sort:c.sort,take:20},l=await q.paginate(r);j(l.data),L({currentPage:l.currentPage,totalPages:l.lastPage})}catch(a){console.error("Error fetching products:",a)}finally{h(!1)}};n.useEffect(()=>{A()},[c]),n.useEffect(()=>{const s=new URLSearchParams(window.location.search),a=s.get("category");if(a){const l=b.find(o=>o.slug===a);l&&i(o=>({...o,category_id:[l.id]}))}const r=s.get("search");r&&i(l=>({...l,name:r}))},[u]);const p=(s,a)=>{i(r=>{if(s==="price")return{...r,price:r.price&&r.price.min===a.min&&r.price.max===a.max?null:a};const l=Array.isArray(r[s])?r[s]:[],o=l.includes(a)?l.filter(w=>w!==a):[...l,a];return{...r,[s]:o}})},g=s=>{x(a=>({...a,[s]:!a[s]}))},t=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[N,R]=n.useState(""),[E,B]=n.useState(""),M=b.filter(s=>s.name.toLowerCase().includes(N.toLowerCase())),z=S.filter(s=>s.name.toLowerCase().includes(E.toLowerCase()));return e.jsx("section",{className:"py-12 bg-[#F7F9FB]",children:e.jsxs("div",{className:"mx-auto px-primary",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 pb-4 border-b-2",children:[e.jsx("h2",{className:"text-4xl font-bold w-6/12",children:f==null?void 0:f.title}),e.jsxs("div",{className:"flex items-center gap-4 w-5/12",children:[e.jsxs("span",{className:"block w-6/12",children:["Productos seleccionados: ",e.jsx("strong",{children:m==null?void 0:m.length})]}),e.jsx("div",{className:"w-6/12",children:e.jsx(U,{options:t,placeholder:"Ordenar por",onChange:s=>{const[a,r]=s.split(":"),l=[{selector:a,desc:r==="desc"}];i(o=>({...o,sort:l}))},labelKey:"label",valueKey:"value"})})]})]}),e.jsxs("div",{className:"relative flex gap-4",children:[e.jsxs("div",{className:"w-3/12 bg-white p-4 rounded-lg h-max",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsx(H,{className:"h-5 w-5"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>g("marca"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Marca"}),e.jsx(v,{className:`h-5 w-5 transform transition-transform ${d.marca?"":"-rotate-180"}`})]}),d.marca&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:E,onChange:s=>B(s.target.value)})]}),e.jsx("div",{className:"space-y-3",children:z.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>p("brand_id",s.id)}),e.jsx("span",{children:s.name})]},s.id))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>g("precio"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(v,{className:`h-5 w-5 transform transition-transform ${d.precio?"":"-rotate-180"}`})]}),d.precio&&e.jsx("div",{className:"space-y-3",children:P.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>p("price",s),checked:c.price&&c.price.min===s.min&&c.price.max===s.max}),e.jsx("span",{children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>g("categoria"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Categoría"}),e.jsx(v,{className:`h-5 w-5 transform transition-transform ${d.categoria?"":"-rotate-180"}`})]}),d.categoria&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:N,onChange:s=>R(s.target.value)})]}),M.map(s=>{var a,r,l;return e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>p("category_id",s.id),checked:(a=c.category_id)==null?void 0:a.includes(s.id)}),e.jsx("span",{children:s.name})]}),((r=c.category_id)==null?void 0:r.includes(s.id))&&((l=s.subcategories)==null?void 0:l.length)>0&&e.jsx("ul",{className:"ml-6 mt-2 space-y-2",children:s.subcategories.map(o=>{var w;return e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>p("subcategory_id",o.id),checked:(w=c.subcategory_id)==null?void 0:w.includes(o.id)}),e.jsx("span",{children:o.name})]},o.id)})})]},s.id)})]})]}),e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl hover:brightness-90 transition-colors text-sm font-bold",children:"Aplicar Filtro"})]}),e.jsx("div",{className:"w-9/12 py-4",children:F?e.jsx(V,{}):e.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:Array.isArray(m)&&m.length>0?m.map(s=>e.jsx(I,{product:s,widthClass:"lg:w-1/4",cart:k,setCart:_},s.id)):e.jsx(T,{})})})]})]})})};export{ce as default};
