import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as n}from"./index-BH53Isel.js";import{c as T}from"./ReactAppend-DTVVXReZ.js";import{R as U}from"./RepositoryRest-Cgba5LN2.js";import{m}from"./main-BSEyQEJW.js";import{i as N}from"./tippy-react.esm-BWiGTO87.js";import{S as W}from"./ProductCard-C2H10lUi.js";import{G as w}from"./Global-ErywZRdd.js";import{M as O}from"./Modal-CIqmjseY.js";import{I as M}from"./InputFormGroup-D5I6zpZc.js";import{C as K}from"./CreateReactScript-B3e40jAW.js";import{B as X}from"./Base-9EI29Nvl.js";import"./index-yBjzXJbu.js";import"./index-fNjTmf9T.js";import"./BasicRest-DEv02zgs.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./index-rimy3MAc.js";import"./index.esm-BE8-iLxT.js";/* empty css               *//* empty css              */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";import"./Logout-jUU_tfUq.js";import"./MenuItemContainer-BkmzVQNY.js";const f=new U,Z=100*1024*1024,H=r=>r.startsWith("image/")?"mdi-image":r.startsWith("video/")?"mdi-video":r.startsWith("audio/")?"mdi-music":r.includes("pdf")?"mdi-file-pdf":r.includes("word")?"mdi-file-word":r.includes("sheet")?"mdi-file-excel":"mdi-file",J=r=>{if(r===0)return"0 Bytes";const o=1024,c=["Bytes","KB","MB","GB"],d=Math.floor(Math.log(r)/Math.log(o));return parseFloat((r/Math.pow(o,d)).toFixed(2))+" "+c[d]},Q=({files:r,height:o="calc(100vh - 240px)",selectable:c,multiple:d=!0,selectedFiles:B=[],setSelectedFiles:x=()=>{}})=>{const h=n.useRef(),g=n.useRef(),j=n.useRef(),v=n.useRef(),R=n.useRef(),[k,b]=n.useState(!1),[C,D]=n.useState(!1),[y,u]=n.useState(r||[]),E=t=>{t.preventDefault(),t.stopPropagation(),b(!0)},_=t=>{t.preventDefault(),t.stopPropagation(),b(!1)},P=async t=>{t.preventDefault(),t.stopPropagation(),b(!1);const i=Array.from(t.dataTransfer.files);F(i)},A=t=>{const i=Array.from(t.target.files);F(i),g.current.value=null},F=async t=>{D(!0);for(const i of t){if(i.size>Z){m.Notify.add({title:"Error",type:"danger",body:`El archivo ${i.name} excede el límite de 40MB`,icon:"/assets/img/icon.svg"});continue}const a=new FormData;a.append("name",i.name),a.append("file",i);try{const s=await f.save(a),l=s;s&&(u(p=>[...p,l]),m.Notify.add({title:"Operación correcta",body:`Archivo ${i.name} subido correctamente`,icon:"/assets/img/icon.svg"}))}catch{m.Notify.add({title:"Error",type:"danger",body:`Error al subir ${i.name}`,icon:"/assets/img/icon.svg"})}}D(!1)},L=t=>{j.current.value=t.id,R.current.value=t.name,v.current.value=t.name,$(h.current).modal("show")},I=async t=>{t.preventDefault();const i=new FormData;i.append("id",j.current.value),i.append("name",v.current.value);const a=await f.save(i);if(!a)return;const s=a.data;u(l=>l.map(p=>p.id===s.id?s:p)),$(h.current).modal("hide")},S=({name:t,file:i,relative:a=!1})=>{const s=a?`/cloud/${i}`:`${w.APP_URL}/cloud/${i}`;m.Clipboard.copy(s,()=>{m.Notify.add({title:"Enlace copiado",body:`${a?"La ruta":"El enlace"} al archivo ${t} ha sido copiado al portapapeles`,icon:"/assets/img/icon.svg"})})},z=async t=>{const{isConfirmed:i}=await W.fire({title:"¿Estás seguro?",text:"¿Estás seguro de que deseas eliminar este archivo?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!i||!await f.delete(t)||u(s=>s.filter(l=>l.id!==t))},q=async()=>{const t=await f.paginate({isLoadingAll:!0});t&&u(t.data)};n.useEffect(()=>{y.length==0&&q()},[null]);const G=(t,i)=>{const a=t.target.checked;if(!d)return x([i]);x(a?s=>[...s,i]:s=>s.filter(l=>l.id!==i.id))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`${k?"dragging":""}`,onDragEnter:E,onDragOver:E,onDragLeave:_,onDrop:P,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("input",{type:"file",ref:g,className:"d-none",multiple:!0,onChange:A}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>g.current.click(),disabled:C,type:"button",children:C?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-loading mdi-spin me-1"}),"Subiendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-upload me-1"}),"Subir archivos"]})})]}),e.jsx("div",{className:"repository-dropzone",style:{height:o,userSelect:"none"},children:k?e.jsxs("div",{className:"drop-overlay",children:[e.jsx("i",{className:"mdi mdi-cloud-upload mdi-48px mb-2"}),e.jsx("h4",{children:"Suelta los archivos aquí"})]}):y.length>0?e.jsx("div",{className:"d-flex flex-wrap align-items-center justify-content-center gap-2",children:y.map((t,i)=>{const a=B.find(s=>s.id===t.id);return e.jsxs("div",{className:"card my-0",style:{width:"140px",height:"max-content",boxShadow:"5px 5px 10px rgba(0, 0, 0, 0.2)"},children:[e.jsxs("label",{href:`${w.APP_URL}/cloud/${t.file}`,className:"rounded position-relative w-100 bg-dark d-flex align-items-center justify-content-center text-white cursor-pointer",style:{aspectRatio:5/3},onClick:()=>{if(!c){const s=document.createElement("a");s.href=`${w.APP_URL}/cloud/${t.file}`,s.target="_blank",s.click(),s.remove()}},children:[c&&e.jsx("input",{name:"input-file-selectable",type:d?"checkbox":"radio",className:"position-absolute form-check-input m-0",style:{top:"6px",left:"6px"},checked:!!a,onChange:s=>G(s,t)}),t.file_mimetype.startsWith("image/")&&t.file_mimetype!=="image/svg+xml"?e.jsx("img",{className:"rounded img-fluid w-100 h-100",src:`/cloud/${t.file}`,alt:t.name,style:{objectFit:"cover",objectPosition:"center",aspectRatio:5/3}}):e.jsx("i",{className:`mdi ${H(t.file_mimetype)} mdi-36px`})]}),e.jsxs("div",{className:"card-body p-1",children:[e.jsx("small",{className:"d-block text-truncate w-100 my-0",title:t.name,children:e.jsx("b",{children:t.name})}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[e.jsx("small",{className:"card-text",children:J(t.file_size)}),!c&&e.jsxs("div",{className:"d-flex gap-1",children:[e.jsxs("div",{className:"dropdown d-inline",children:[e.jsx(N,{content:"Copiar enlace",children:e.jsx("i",{className:"mdi mdi-link cursor-pointer","data-bs-toggle":"dropdown"})}),e.jsxs("ul",{className:"dropdown-menu",children:[e.jsx("li",{children:e.jsxs("a",{className:"dropdown-item",href:"#",onClick:()=>S(t),children:[e.jsx("i",{className:"mdi mdi-link-variant me-1"}),"Copiar enlace"]})}),e.jsx("li",{children:e.jsxs("a",{className:"dropdown-item",href:"#",onClick:()=>S({...t,relative:!0}),children:[e.jsx("i",{className:"mdi mdi-folder-outline me-1"}),"Copiar ruta relativa"]})})]})]}),e.jsx(N,{content:"Cambiar nombre",children:e.jsx("i",{className:"mdi mdi-pencil cursor-pointer",onClick:()=>L(t)})}),e.jsx(N,{content:"Eliminar",children:e.jsx("i",{className:"mdi mdi-delete cursor-pointer text-danger",onClick:()=>z(t.id)})})]})]})]})]},i)})}):e.jsxs("div",{className:"text-center p-5",children:[e.jsx("i",{className:"mdi mdi-folder-multiple-outline mdi-48px mb-2"}),e.jsx("h4",{children:"Arrastra archivos aquí o usa el botón de subir"}),e.jsx("small",{className:"text-muted",children:"Tamaño máximo por archivo: 40MB"})]})})]}),e.jsxs(O,{modalRef:h,title:"Modificar nombre",onSubmit:I,zIndex:1070,children:[e.jsx("input",{ref:j,type:"hidden"}),e.jsx(M,{eRef:R,label:"Nombre anterior",disabled:!0}),e.jsx(M,{eRef:v,label:"Nombre nuevo",required:!0})]})]})},V=({files:r})=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"repository-container",children:e.jsx(Q,{files:r})})});K((r,o)=>{T.createRoot(r).render(e.jsx(X,{...o,title:"Repositorio",children:e.jsx(V,{...o})}))});
