import{j as e}from"./AboutHeader-ClKiNAEV.js";import{r as c,R as F}from"./index-DFv2mRv-.js";import"./ProductCard-NsyC22vv.js";import{I as H}from"./ItemsRest-DK8CnWHO.js";import"./HeaderBananaLab-C6xLnU5a.js";import"./main-rZoj-gSW.js";import{L as J}from"./Loading-O_y8BNFU.js";import{N as Q}from"./NoResult-BasQTFzm.js";import{S as W}from"./SelectForm-Ckz_d_he.js";import{P as X}from"./ProductCardSimple-BWc0etaM.js";import{C as Y}from"./CardProductBananaLab-C-YziXew.js";import{C as w}from"./chevron-down-Bgb5hLdB.js";import{F as ee}from"./filter-BoD8ff5S.js";import{C as L}from"./chevron-left-OH0FPGKr.js";import{C as M}from"./chevron-right-DU_xZzgH.js";import"./ModalImportItem-DaJ_kNWW.js";import"./index-BOPJobjj.js";import"./index-Sd7so-oN.js";import"./index-Cevqm-zP.js";import"./CartItemRow-BRRZMnl0.js";import"./tippy-react.esm-CGYKl-Jd.js";import"./Number2Currency-e57Tgsuk.js";import"./minus-C_LiTw_8.js";import"./createLucideIcon-CC2OGGjd.js";import"./plus-DqVREqgL.js";import"./___vite-browser-external_commonjs-proxy-BQdpDcDf.js";import"./search-BlyVC63b.js";import"./check-sPmXvS3y.js";import"./shopping-cart-DH8mvArW.js";const se=new H,Ee=({items:te,data:d,filteredData:R,cart:C,setCart:v})=>{const{collections:p,priceRanges:u}=R||{collections:[],priceRanges:[]},[N,A]=c.useState([]),[f,E]=c.useState([]),[m,I]=c.useState({collection:!0,marca:!0,precio:!0,categoria:!0,colores:!1}),[o,g]=c.useState({collection_id:[],category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort:[{selector:"created_at",desc:!0}]}),[P,z]=c.useState([]),[B,k]=c.useState(!1),[a,K]=c.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),O=s=>{const t=[];if(s.collection_id.length>0){const r=s.collection_id.map(i=>["collection_id","=",i]);t.push(["or",...r])}if(s.category_id.length>0){const r=s.category_id.map(i=>["category_id","=",i]);t.push(["or",...r])}if(s.subcategory_id.length>0){const r=s.subcategory_id.map(i=>["subcategory_id","=",i]);t.push(["and",...r])}if(s.brand_id.length>0){const r=s.brand_id.map(i=>["brand_id","=",i]);t.push(["or",...r])}return s.price&&t.push(["and",[["final_price",">=",s.price.min],"and",["final_price","<=",s.price.max]]]),s.name&&t.push(["name","contains",s.name]),t},_=async(s=1)=>{var t,r;k(!0);try{const n={filter:O(o),sort:o.sort,skip:(s-1)*a.itemsPerPage,take:a.itemsPerPage,requireTotalCount:!0},l=await se.paginate(n);l&&l.data&&(z(l.data),K({currentPage:s,totalPages:Math.ceil(l.totalCount/a.itemsPerPage),totalItems:l.totalCount,itemsPerPage:a.itemsPerPage,from:(s-1)*a.itemsPerPage+1,to:Math.min(s*a.itemsPerPage,l.totalCount)}),A(((t=l==null?void 0:l.summary)==null?void 0:t.brands)??[]),E(((r=l==null?void 0:l.summary)==null?void 0:r.categories)??[]))}catch(i){console.error("Error fetching products:",i)}finally{k(!1)}};c.useEffect(()=>{_(a.currentPage)},[o]),c.useEffect(()=>{const s=new URLSearchParams(window.location.search),t=s.get("category");if(t){const n=f.find(l=>l.slug===t);n&&g(l=>({...l,category_id:[n.id]}))}const r=s.get("collection");if(r){const n=p.find(l=>l.slug===r);n&&g(l=>({...l,collection_id:[n.id]}))}const i=s.get("search");i&&g(n=>({...n,name:i}))},[f,p]);const x=s=>{s>=1&&s<=a.totalPages&&_(s)},S=()=>{const s=[],t=a.totalPages,r=a.currentPage,i=2;for(let n=1;n<=t;n++)n===1||n===t||n>=r-i&&n<=r+i?s.push(n):(n===r-i-1||n===r+i+1)&&s.push("...");return s.filter((n,l,G)=>n!=="..."||G[l-1]!=="...")},j=(s,t)=>{g(r=>{if(s==="price")return{...r,price:r.price&&r.price.min===t.min&&r.price.max===t.max?null:t};const i=Array.isArray(r[s])?r[s]:[],n=i.includes(t)?i.filter(l=>l!==t):[...i,t];return{...r,[s]:n}})},y=s=>{I(t=>({...t,[s]:!t[s]}))},V=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[Z,ae]=c.useState(""),[q,re]=c.useState(""),[D,ie]=c.useState("");p==null||p.filter(s=>s.name.toLowerCase().includes(q.toLowerCase()));const h=f==null?void 0:f.filter(s=>s.name.toLowerCase().includes(Z.toLowerCase()));N==null||N.filter(s=>s.name.toLowerCase().includes(D.toLowerCase()));const T=s=>{const[t,r]=s.split(":"),i=[{selector:t,desc:r==="desc"}];g(n=>({...n,sort:i}))},[$,b]=c.useState(!1),U=()=>e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:()=>b(!1)}),e.jsx("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 w-full sm:align-middle sm:max-w-lg sm:w-full h-[80vh]",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 border-b sticky top-0 z-10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold leading-6 text-gray-900",children:"Filtros"}),e.jsxs("button",{type:"button",className:"text-gray-400 hover:text-gray-500 focus:outline-none",onClick:()=>b(!1),children:[e.jsx("span",{className:"sr-only",children:"Cerrar"}),"✕"]})]})}),e.jsxs("div",{className:"bg-white px-4 pt-2 pb-4 sm:p-6 sm:pb-4 overflow-y-auto h-[calc(100%-60px)]",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>y("categoria"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-bold",children:"Categorias"}),e.jsx(w,{className:`h-5 w-5 transform transition-transform ${m.categoria?"":"-rotate-180"}`})]}),m.categoria&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"space-y-2",children:h==null?void 0:h.map(s=>{var r;const t=(r=o.category_id)==null?void 0:r.includes(s.id);return e.jsx("div",{className:`group py-2 rounded-md ${t?"bg-secondary":"bg-transparent"}`,children:e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>j("category_id",s.id),checked:t}),e.jsx("span",{children:s.name}),e.jsx("img",{src:`/storage/images/category/${s.image}`,onError:i=>i.target.src="assets/img/noimage/no_imagen_circular.png",alt:s.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"})]})},s.id)})})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>y("precio"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(w,{className:`h-5 w-5 transform transition-transform ${m.precio?"":"-rotate-180"}`})]}),m.precio&&e.jsx("div",{className:"space-y-3",children:u==null?void 0:u.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>j("price",s),checked:o.price&&o.price.min===s.min&&o.price.max===s.max}),e.jsx("span",{children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`))})]})]}),e.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse sticky bottom-0 border-t",children:e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-3 bg-primary text-white text-base font-medium hover:bg-primary-dark focus:outline-none sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>b(!1),children:"Aplicar filtros"})})]})})]});return e.jsxs("section",{className:"p-[5%] mx-auto w-full",children:[$&&e.jsx(U,{}),e.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"hidden lg:block w-full sm:w-1/5 bg-white p-4 rounded-lg h-max",children:[e.jsx("div",{className:"sm:hidden flex justify-between items-center mb-4",children:e.jsx("button",{onClick:()=>b(!1),className:"customtext-primary hover:customtext-accent",children:"✕"})}),e.jsx("p",{className:"text-xl font-bold pb-4 mb-4 border-b",children:(d==null?void 0:d.title)||"Filtros"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>y("categoria"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-bold",children:"Categorias"}),e.jsx(w,{className:`h-5 w-5 transform transition-transform ${m.categoria?"":"-rotate-180"}`})]}),m.categoria&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"space-y-2",children:h==null?void 0:h.map(s=>{var r;const t=(r=o.category_id)==null?void 0:r.includes(s.id);return e.jsx("div",{className:`group py-2 rounded-md ${t?"bg-secondary":"bg-transparent"}`,children:e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>j("category_id",s.id),checked:t}),e.jsx("span",{children:s.name}),e.jsx("img",{src:`/storage/images/category/${s.image}`,onError:i=>i.target.src="assets/img/noimage/no_imagen_circular.png",alt:s.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"})]})},s.id)})})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>y("precio"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(w,{className:`h-5 w-5 transform transition-transform ${m.precio?"":"-rotate-180"}`})]}),m.precio&&e.jsx("div",{className:"space-y-3",children:u==null?void 0:u.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>j("price",s),checked:o.price&&o.price.min===s.min&&o.price.max===s.max}),e.jsx("span",{children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`))})]})]}),e.jsxs("div",{className:"w-full sm:w-4/5 py-4",children:[e.jsxs("div",{className:"flex justify-between items-end mb-4 w-full",children:[e.jsxs("div",{className:"flex gap-4  items-start lg:items-center flex-col w-8/12 lg:w-auto lg:flex-row",children:[e.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),e.jsx(W,{options:V,placeholder:"Recomendados",onChange:T,labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),e.jsx("div",{className:"lg:hidden flex items-end h-full mb-4",children:e.jsx("button",{onClick:()=>b(!$),className:" h-12 w-12 gap-2 bg-primary text-white flex items-center justify-center  rounded-full lg:hidden",children:e.jsx(ee,{size:20})})}),e.jsx("div",{className:"customtext-primary font-semibold hidden lg:block",children:e.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[e.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>x(a.currentPage-1),disabled:a.currentPage===1,children:e.jsx(L,{})}),S().map((s,t)=>e.jsx(F.Fragment,{children:s==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                              ${s===a.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>x(s),children:s})},t)),e.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===a.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>x(a.currentPage+1),disabled:a.currentPage===a.totalPages,children:e.jsx(M,{})})]})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[a.from," - ",a.to," de ",a.totalItems," Resultados"]})})]})})]}),B?e.jsx(J,{}):e.jsx("div",{className:"flex items-center flex-wrap gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray(P)&&P.length>0?P.map(s=>(d==null?void 0:d.card)==="CardProductBananaLab"?e.jsx(Y,{product:s,widthClass:"lg:w-1/3",cart:C,setCart:v},s.id):e.jsx(X,{product:s,widthClass:"lg:w-1/3",cart:C,setCart:v},s.id)):e.jsx(Q,{})}),e.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[e.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>x(a.currentPage-1),disabled:a.currentPage===1,children:e.jsx(L,{})}),S().map((s,t)=>e.jsx(F.Fragment,{children:s==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                          ${s===a.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>x(s),children:s})},t)),e.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===a.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>x(a.currentPage+1),disabled:a.currentPage===a.totalPages,children:e.jsx(M,{})})]})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[a.from," - ",a.to," de ",a.totalItems," Resultados"]})})]})]})]})]})};export{Ee as default};
