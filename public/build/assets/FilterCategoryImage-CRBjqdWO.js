import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as l,R as L}from"./index-BH53Isel.js";import"./ProductNavigation-DCpLFFtg.js";import{I as J}from"./ItemsRest-CGu6Sw-g.js";import{L as Q}from"./Loading-B-FwDSWi.js";import{N as W}from"./NoResult-C9qZVva5.js";import{S as X}from"./SelectForm-G0J6yhhv.js";import{C as w}from"./Number2Currency-DqtNgFrj.js";import"./ProductCard-Bvp3XiVT.js";import{P as Y}from"./ProductCardSimple-CUArLit_.js";import{C as ee}from"./CardProductBananaLab-D9u3PWZm.js";import{C as N}from"./chevron-down-DS-mdh9v.js";import{F as se}from"./filter-Ci9tsc_e.js";import{C as M}from"./chevron-left-B2s3ZsB7.js";import{C as R}from"./chevron-right-Ckt5D2ka.js";import"./index-yBjzXJbu.js";import"./HeaderSearch-DuZIuoXV.js";import"./main-BvVILmTO.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./index-Bv81MoWS.js";import"./index-fNjTmf9T.js";import"./index-Chjiymov.js";import"./CartItemRow-Dh23MZc8.js";import"./tippy-react.esm-BWiGTO87.js";import"./index-rimy3MAc.js";import"./minus-jyhodMPN.js";import"./createLucideIcon-Cy5Ya80P.js";import"./plus-Bot15Khs.js";import"./BasicRest-C_0LADdJ.js";import"./search-TwiiKGP5.js";import"./check-DQ7QoS0v.js";import"./Global-CQLDm_nT.js";import"./index-CMHsc23u.js";import"./HeaderBananaLab-C_HbcogJ.js";/* empty css              */import"./proxy-BTYtmp9V.js";import"./trash-2-DK1wnsDn.js";import"./index-CFtDjG4d.js";import"./x-DBMwyD6F.js";import"./shopping-cart-CZEUxbmv.js";import"./arrow-right-DR00rP9v.js";const te=new J,He=({items:ae,data:d,filteredData:A,cart:v,setCart:k})=>{const{collections:h,priceRanges:u}=A||{collections:[],priceRanges:[]},[P,E]=l.useState([]),[f,I]=l.useState([]),[m,z]=l.useState({collection:!0,marca:!0,precio:!0,categoria:!0,colores:!1}),[c,b]=l.useState({collection_id:[],category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort:[{selector:"created_at",desc:!0}]}),[C,B]=l.useState([]),[K,_]=l.useState(!1),[a,O]=l.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),V=s=>{const t=[];if(s.collection_id.length>0){const r=s.collection_id.map(i=>["collection_id","=",i]);t.push(["or",...r])}if(s.category_id.length>0){const r=s.category_id.map(i=>["category_id","=",i]);t.push(["or",...r])}if(s.subcategory_id.length>0){const r=s.subcategory_id.map(i=>["subcategory_id","=",i]);t.push(["and",...r])}if(s.brand_id.length>0){const r=s.brand_id.map(i=>["brand_id","=",i]);t.push(["or",...r])}return s.price&&t.push(["and",[["final_price",">=",s.price.min],"and",["final_price","<=",s.price.max]]]),s.name&&t.push(["name","contains",s.name]),t},$=async(s=1)=>{var t,r;_(!0);try{const n={filter:V(c),sort:c.sort,skip:(s-1)*a.itemsPerPage,take:a.itemsPerPage,requireTotalCount:!0},o=await te.paginate(n);o&&o.data&&(B(o.data),O({currentPage:s,totalPages:Math.ceil(o.totalCount/a.itemsPerPage),totalItems:o.totalCount,itemsPerPage:a.itemsPerPage,from:(s-1)*a.itemsPerPage+1,to:Math.min(s*a.itemsPerPage,o.totalCount)}),E(((t=o==null?void 0:o.summary)==null?void 0:t.brands)??[]),I(((r=o==null?void 0:o.summary)==null?void 0:r.categories)??[]))}catch(i){console.error("Error fetching products:",i)}finally{_(!1)}};l.useEffect(()=>{$(a.currentPage)},[c]),l.useEffect(()=>{const s=new URLSearchParams(window.location.search),t=s.get("category");if(t){const n=f.find(o=>o.slug===t);n&&b(o=>({...o,category_id:[n.id]}))}const r=s.get("collection");if(r){const n=h.find(o=>o.slug===r);n&&b(o=>({...o,collection_id:[n.id]}))}const i=s.get("search");i&&b(n=>({...n,name:i}))},[f,h]);const x=s=>{s>=1&&s<=a.totalPages&&$(s)},S=()=>{const s=[],t=a.totalPages,r=a.currentPage,i=2;for(let n=1;n<=t;n++)n===1||n===t||n>=r-i&&n<=r+i?s.push(n):(n===r-i-1||n===r+i+1)&&s.push("...");return s.filter((n,o,H)=>n!=="..."||H[o-1]!=="...")},j=(s,t)=>{b(r=>{if(s==="price")return{...r,price:r.price&&r.price.min===t.min&&r.price.max===t.max?null:t};const i=Array.isArray(r[s])?r[s]:[],n=i.includes(t)?i.filter(o=>o!==t):[...i,t];return{...r,[s]:n}})},y=s=>{z(t=>({...t,[s]:!t[s]}))},Z=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[q,re]=l.useState(""),[D,ie]=l.useState(""),[T,ne]=l.useState("");h==null||h.filter(s=>s.name.toLowerCase().includes(D.toLowerCase()));const p=f==null?void 0:f.filter(s=>s.name.toLowerCase().includes(q.toLowerCase()));P==null||P.filter(s=>s.name.toLowerCase().includes(T.toLowerCase()));const U=s=>{const[t,r]=s.split(":"),i=[{selector:t,desc:r==="desc"}];b(n=>({...n,sort:i}))},[F,g]=l.useState(!1),G=()=>e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:()=>g(!1)}),e.jsx("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 w-full sm:align-middle sm:max-w-lg sm:w-full h-[80vh]",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 border-b sticky top-0 z-10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold leading-6 text-gray-900",children:"Filtros"}),e.jsxs("button",{type:"button",className:"text-gray-400 hover:text-gray-500 focus:outline-none",onClick:()=>g(!1),children:[e.jsx("span",{className:"sr-only",children:"Cerrar"}),"✕"]})]})}),e.jsxs("div",{className:"bg-white px-4 pt-2 pb-4 sm:p-6 sm:pb-4 overflow-y-auto h-[calc(100%-60px)]",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>y("categoria"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-bold",children:"Categorias"}),e.jsx(N,{className:`h-5 w-5 transform transition-transform ${m.categoria?"":"-rotate-180"}`})]}),m.categoria&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"space-y-2",children:p==null?void 0:p.map(s=>{var r;const t=(r=c.category_id)==null?void 0:r.includes(s.id);return e.jsx("div",{className:`group py-2 rounded-md ${t?"bg-secondary":"bg-transparent"}`,children:e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>j("category_id",s.id),checked:t}),e.jsx("span",{children:s.name}),e.jsx("img",{src:`/storage/images/category/${s.image}`,onError:i=>i.target.src="assets/img/noimage/no_imagen_circular.png",alt:s.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"})]})},s.id)})})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>y("precio"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(N,{className:`h-5 w-5 transform transition-transform ${m.precio?"":"-rotate-180"}`})]}),m.precio&&e.jsx("div",{className:"space-y-3",children:u==null?void 0:u.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>j("price",s),checked:c.price&&c.price.min===s.min&&c.price.max===s.max}),e.jsx("span",{children:`${w()}${s.min} - ${w()}${s.max}`})]},`${s.min}-${s.max}`))})]})]}),e.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse sticky bottom-0 border-t",children:e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-3 bg-primary text-white text-base font-medium hover:bg-primary-dark focus:outline-none sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>g(!1),children:"Aplicar filtros"})})]})})]});return e.jsxs("section",{className:"p-[5%] mx-auto w-full",children:[F&&e.jsx(G,{}),e.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"hidden lg:block w-full sm:w-1/5 bg-white p-4 rounded-lg h-max",children:[e.jsx("div",{className:"sm:hidden flex justify-between items-center mb-4",children:e.jsx("button",{onClick:()=>g(!1),className:"customtext-primary hover:customtext-accent",children:"✕"})}),e.jsx("p",{className:"text-xl font-bold pb-4 mb-4 border-b",children:(d==null?void 0:d.title)||"Filtros"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>y("categoria"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-bold",children:"Categorias"}),e.jsx(N,{className:`h-5 w-5 transform transition-transform ${m.categoria?"":"-rotate-180"}`})]}),m.categoria&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"space-y-2",children:p==null?void 0:p.map(s=>{var r;const t=(r=c.category_id)==null?void 0:r.includes(s.id);return e.jsx("div",{className:`group py-2 rounded-md ${t?"bg-secondary":"bg-transparent"}`,children:e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>j("category_id",s.id),checked:t}),e.jsx("span",{children:s.name}),e.jsx("img",{src:`/storage/images/category/${s.image}`,onError:i=>i.target.src="/assets/img/noimage/no_imagen_circular.png",alt:s.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"})]})},s.id)})})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>y("precio"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(N,{className:`h-5 w-5 transform transition-transform ${m.precio?"":"-rotate-180"}`})]}),m.precio&&e.jsx("div",{className:"space-y-3",children:u==null?void 0:u.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>j("price",s),checked:c.price&&c.price.min===s.min&&c.price.max===s.max}),e.jsx("span",{children:`${w()}${s.min} - ${w()}${s.max}`})]},`${s.min}-${s.max}`))})]})]}),e.jsxs("div",{className:"w-full sm:w-4/5 py-4",children:[e.jsxs("div",{className:"flex justify-between items-end mb-4 w-full",children:[e.jsxs("div",{className:"flex gap-4  items-start lg:items-center flex-col w-8/12 lg:w-auto lg:flex-row",children:[e.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),e.jsx(X,{options:Z,placeholder:"Recomendados",onChange:U,labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),e.jsx("div",{className:"lg:hidden flex items-end h-full mb-4",children:e.jsx("button",{onClick:()=>g(!F),className:" h-12 w-12 gap-2 bg-primary text-white flex items-center justify-center  rounded-full lg:hidden",children:e.jsx(se,{size:20})})}),e.jsx("div",{className:"customtext-primary font-semibold hidden lg:block",children:e.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[e.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>x(a.currentPage-1),disabled:a.currentPage===1,children:e.jsx(M,{})}),S().map((s,t)=>e.jsx(L.Fragment,{children:s==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                              ${s===a.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>x(s),children:s})},t)),e.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===a.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>x(a.currentPage+1),disabled:a.currentPage===a.totalPages,children:e.jsx(R,{})})]})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[a.from," - ",a.to," de ",a.totalItems," Resultados"]})})]})})]}),K?e.jsx(Q,{}):e.jsx("div",{className:"flex items-center flex-wrap gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray(C)&&C.length>0?C.map(s=>(d==null?void 0:d.card)==="CardProductBananaLab"?e.jsx(ee,{product:s,widthClass:"lg:w-1/3",cart:v,setCart:k},s.id):e.jsx(Y,{product:s,widthClass:"lg:w-1/3",cart:v,setCart:k},s.id)):e.jsx(W,{})}),e.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[e.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>x(a.currentPage-1),disabled:a.currentPage===1,children:e.jsx(M,{})}),S().map((s,t)=>e.jsx(L.Fragment,{children:s==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                          ${s===a.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>x(s),children:s})},t)),e.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===a.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>x(a.currentPage+1),disabled:a.currentPage===a.totalPages,children:e.jsx(R,{})})]})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[a.from," - ",a.to," de ",a.totalItems," Resultados"]})})]})]})]})]})};export{He as default};
