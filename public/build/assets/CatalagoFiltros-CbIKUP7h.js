import{j as e}from"./AboutHeader-COUW3Uy_.js";import{r as n}from"./index-CqkZ-sT_.js";import{C as K}from"./CardHoverBtn-D-Y9dpNf.js";import{I as O}from"./ItemsRest-COC0wVJZ.js";import{L as V}from"./Loading-CS0Y7TJ8.js";import{N as Z}from"./NoResult-CKKmsI7-.js";import{S as D}from"./SelectForm-B3_ZzKEz.js";import{F as H}from"./filter-CawzT8aa.js";import{C as h}from"./chevron-down-CxOx8ByU.js";import{S as y}from"./search-DhoFIDMi.js";import"./ProductCard-DppMoL6U.js";import"./main-CkMzf7wF.js";import"./___vite-browser-external_commonjs-proxy-DA7w84js.js";import"./BasicEditing-CqE15M_Q.js";import"./check-CvqheCNB.js";import"./createLucideIcon-D0vxYqnu.js";const U=new O,ie=({items:w,data:u,filteredData:N,cart:v,setCart:C})=>{const{categories:f,brands:_,priceRanges:S}=N,[i,P]=n.useState({marca:!0,precio:!0,categoria:!0,colores:!1}),[l,d]=n.useState({category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[o,k]=n.useState([]),[F,g]=n.useState(!1),[q,L]=n.useState({currentPage:1,totalPages:1}),A=s=>{const a=[];if(s.category_id.length>0){const t=s.category_id.map(r=>["category_id","=",r]);a.push(["or",...t])}if(s.subcategory_id.length>0){const t=s.subcategory_id.map(r=>["subcategory_id","=",r]);a.push(["and",...t])}if(s.brand_id.length>0){const t=s.brand_id.map(r=>["brand_id","=",r]);a.push(["or",...t])}return s.price&&a.push(["and",[["final_price",">=",s.price.min],"and",["final_price","<=",s.price.max]]]),s.name&&a.push(["name","contains",s.name]),a},B=async(s=1)=>{g(!0);try{const t={filter:A(l),sort:l.sort,take:20},r=await U.paginate(t);k(r.data),L({currentPage:r.currentPage,totalPages:r.lastPage})}catch(a){console.error("Error fetching products:",a)}finally{g(!1)}};n.useEffect(()=>{B()},[l]),n.useEffect(()=>{const s=new URLSearchParams(window.location.search),a=s.get("category");if(a){const r=f.find(c=>c.slug===a);r&&d(c=>({...c,category_id:[r.id]}))}const t=s.get("search");t&&d(r=>({...r,name:t}))},[w]);const m=(s,a)=>{d(t=>{if(s==="price")return{...t,price:t.price&&t.price.min===a.min&&t.price.max===a.max?null:a};const r=Array.isArray(t[s])?t[s]:[],c=r.includes(a)?r.filter(x=>x!==a):[...r,a];return{...t,[s]:c}})},p=s=>{P(a=>({...a,[s]:!a[s]}))},M=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[b,$]=n.useState(""),[j,R]=n.useState(""),E=f.filter(s=>s.name.toLowerCase().includes(b.toLowerCase())),I=_.filter(s=>s.name.toLowerCase().includes(j.toLowerCase()));return e.jsx("section",{className:"py-12 bg-[#F7F9FB]",children:e.jsxs("div",{className:"mx-auto px-primary 2xl:px-0 2xl:max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between items-center mb-8 pb-4 border-b-2",children:[e.jsx("h2",{className:"text-[32px] md:text-4xl font-bold md:w-6/12",children:u==null?void 0:u.title}),e.jsxs("div",{className:"flex items-center gap-4 md:w-5/12",children:[e.jsxs("span",{className:"block w-6/12",children:["Productos seleccionados:"," ",e.jsx("strong",{children:o==null?void 0:o.length})]}),e.jsx("div",{className:"w-6/12",children:e.jsx(D,{options:M,placeholder:"Ordenar por",onChange:s=>{const[a,t]=s.split(":"),r=[{selector:a,desc:t==="desc"}];d(c=>({...c,sort:r}))},labelKey:"label",valueKey:"value"})})]})]}),e.jsxs("div",{className:"relative flex gap-4",children:[e.jsxs("div",{className:"hidden md:block md:w-3/12 bg-white p-4 rounded-lg h-max",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsx(H,{className:"h-5 w-5"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>p("marca"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Marca"}),e.jsx(h,{className:`h-5 w-5 transform transition-transform ${i.marca?"":"-rotate-180"}`})]}),i.marca&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:j,onChange:s=>R(s.target.value)})]}),e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:I.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>m("brand_id",s.id)}),e.jsx("span",{children:s.name})]},s.id))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>p("precio"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(h,{className:`h-5 w-5 transform transition-transform ${i.precio?"":"-rotate-180"}`})]}),i.precio&&e.jsx("div",{className:"space-y-3",children:S.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>m("price",s),checked:l.price&&l.price.min===s.min&&l.price.max===s.max}),e.jsx("span",{children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>p("categoria"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Categoría"}),e.jsx(h,{className:`h-5 w-5 transform transition-transform ${i.categoria?"":"-rotate-180"}`})]}),i.categoria&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:b,onChange:s=>$(s.target.value)})]}),e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:E.map(s=>{var a,t,r;return e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>m("category_id",s.id),checked:(a=l.category_id)==null?void 0:a.includes(s.id)}),e.jsx("span",{children:s.name})]}),((t=l.category_id)==null?void 0:t.includes(s.id))&&((r=s.subcategories)==null?void 0:r.length)>0&&e.jsx("ul",{className:"ml-6 mt-2 space-y-2",children:s.subcategories.map(c=>{var x;return e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>m("subcategory_id",c.id),checked:(x=l.subcategory_id)==null?void 0:x.includes(c.id)}),e.jsx("span",{children:c.name})]},c.id)})})]},s.id)})})]})]}),e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl hover:brightness-90 transition-colors text-sm font-bold",children:"Aplicar Filtro"})]}),e.jsx("div",{className:"w-full md:w-9/12 py-4",children:F?e.jsx(V,{}):e.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:Array.isArray(o)&&o.length>0?o.map(s=>e.jsx("div",{className:" lg:h-[460px] lg:max-h-[460px]  xl:h-[400px] xl:max-h-[400px] 2xl:h-[430px] 2xl:max-h-[430px]  w-1/2 lg:w-1/3 xl:w-1/4",children:e.jsx(K,{product:s,widthClass:"w-full sm:w-full lg:w-full",cart:v,setCart:C})},s.id)):e.jsx(Z,{})})})]})]})})};export{ie as default};
