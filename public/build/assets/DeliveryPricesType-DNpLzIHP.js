import{j as r}from"./AboutSimple-Cf8x2fCZ.js";import{r as i}from"./index-BH53Isel.js";import{c as B}from"./ReactAppend-DTVVXReZ.js";import{s as h}from"./server.browser-Bf4gQIc7.js";import{D as G}from"./DeliveryPricesRest-CeoDkAQQ.js";import{C as _}from"./CreateReactScript-D1akKh24.js";import{S as I}from"./ProductCard-erObE6pO.js";import{B as q}from"./Base-Bx9xWe1P.js";import{D as w}from"./DxButton-CsjWvhyj.js";import{M}from"./Modal-CIqmjseY.js";import{T as P}from"./Table-CP679pea.js";import{I as j}from"./InputFormGroup-D5I6zpZc.js";import{S as U}from"./SelectFormGroup-YqB1XVb8.js";import{S as A}from"./SwitchFormGroup-DUGhyqoj.js";import{T as H}from"./TextareaFormGroup-CdwdsTk2.js";import{N as C}from"./Number2Currency-e57Tgsuk.js";import"./index-yBjzXJbu.js";import"./index-fNjTmf9T.js";import"./ModalImportItem-CAaM7sud.js";import"./main-BvVILmTO.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./index.esm-CveLAcri.js";import"./Global-CklCDfn9.js";/* empty css               *//* empty css              */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";import"./tippy-react.esm-BWiGTO87.js";import"./index-rimy3MAc.js";import"./Logout-LH3dzJpV.js";import"./MenuItemContainer-BwGvRAHs.js";const a=new G,z=({ubigeo:l=[]})=>{const s=i.useRef(),u=i.useRef(),m=i.useRef(),c=i.useRef(),f=i.useRef(),d=i.useRef(),p=i.useRef(),x=i.useRef(),[y,g]=i.useState(!1),[E,S]=i.useState(!1),[o,v]=i.useState(!1),b=e=>{e!=null&&e.id?g(!0):g(!1),m.current.value=(e==null?void 0:e.id)??"",$(c.current).val((e==null?void 0:e.ubigeo)??null).trigger("change"),S((e==null?void 0:e.price)===null),p.current&&(p.current.checked=(e==null?void 0:e.is_free)??!1,v((e==null?void 0:e.is_free)??!1)),f.current.value=(e==null?void 0:e.price)??0,x.current.value=(e==null?void 0:e.express_price)??0,d.current.value=(e==null?void 0:e.description)??"",$(u.current).modal("show")},D=async e=>{e.preventDefault();const t=l.find(F=>F.reniec==c.current.value),n={id:m.current.value||void 0,name:`${t.distrito}, ${t.departamento}`.toTitleCase(),price:E||o?null:f.current.value,is_free:p.current.checked,express_price:x.current.value,description:d.current.value,ubigeo:c.current.value};await a.save(n)&&($(s.current).dxDataGrid("instance").refresh(),$(u.current).modal("hide"))},N=async e=>{const{isConfirmed:t}=await I.fire({title:"Eliminar registro",text:"¿Estas seguro de eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!t||!await a.delete(e)||$(s.current).dxDataGrid("instance").refresh()},R=e=>$(h.renderToString(r.jsxs("span",{children:[r.jsx("span",{className:"d-block w-100 text-truncate",children:e.text.replace(e.id,"")}),r.jsxs("small",{className:"d-block",children:["Ubigeo: ",e.id]})]}))),T=async e=>{const t=e.target.files[0];if(!t)return;e.target.value=null;const n=new FormData;n.append("excel",t),await a.upload(n)&&$(s.current).dxDataGrid("instance").refresh()};return r.jsxs(r.Fragment,{children:[r.jsx("input",{id:"file-input",type:"file",accept:".xlsx, .xls",style:{display:"none"},onChange:T}),r.jsx(P,{gridRef:s,title:"Costos de envío",rest:a,exportable:!0,exportableName:"delivery.prices",toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"upload",hint:"Cargar archivo Excel",onClick:()=>document.getElementById("file-input").click()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(s.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo registro",hint:"Nuevo registro",onClick:()=>b()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"ubigeo",caption:"Ubigeo (RENIEC)",width:"150px"},{dataField:"name",caption:"Envío a",width:"200px",allowExporting:!1},{dataField:"description",caption:"Descripción",cellTemplate:(e,{data:t})=>{e.html(t.description||'<i class="text-muted">- Sin descripción -</i>')}},{dataField:"price",caption:"Precio",dataType:"number",width:"150px",cellTemplate:(e,{data:t})=>{t.is_free?e.html(h.renderToString(r.jsxs("div",{className:"row",children:[" ",r.jsx("span",{className:"text-muted italic",children:"Delivery Gratis"}),r.jsxs("span",{className:"text-muted",children:["Express:"," ",r.jsxs("span",{className:"font-monospace text-reset",children:["S/."," ",C(t.express_price)]})]})]}))):t.price>0?e.html(h.renderToString(r.jsxs("span",{children:["S/. ",C(t.price)]}))):e.text("Gratis")}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:t})=>{e.css("text-overflow","unset"),e.append(w({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>b(t)})),e.append(w({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>N(t.id)}))},allowFiltering:!1,allowExporting:!1}]}),r.jsxs(M,{modalRef:u,title:y?"Editar Costo de envío":"Agregar Costo de envío",onSubmit:D,size:"sm",children:[r.jsx("input",{ref:m,type:"hidden"}),r.jsxs("div",{id:"form-container",className:"row",children:[r.jsx(U,{eRef:c,label:"Distrito/Ubigeo",templateResult:R,templateSelection:R,dropdownParent:"#form-container",required:!0,children:l.map((e,t)=>r.jsxs("option",{value:e.reniec,children:[e.reniec," ",e.distrito," ",e.provincia," ",e.departamento]},t))}),r.jsx(A,{eRef:p,label:"¿Tiene delivery gratis?",col:"col-12",onChange:e=>v(e.target.checked),checked:o,refreshable:[o]}),r.jsx("div",{className:"col-12",hidden:o,children:r.jsx(j,{eRef:f,label:"Costo de envío",col:"col-12",type:"number",step:.01,required:!0})}),r.jsx("div",{className:"col-12",hidden:!o,children:r.jsx(j,{eRef:x,label:"Costo de envío Express",col:"col-12",type:"number",step:.01,required:!0})}),r.jsx(H,{eRef:d,label:"Descripción",rows:2})]})]})]})};_((l,s)=>{B.createRoot(l).render(r.jsx(q,{...s,title:"Costos de envio",children:r.jsx(z,{...s})}))});
