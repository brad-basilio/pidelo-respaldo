var pe=Object.defineProperty;var fe=(t,n,r)=>n in t?pe(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r;var M=(t,n,r)=>fe(t,typeof n!="symbol"?n+"":n,r);import{j as e}from"./AboutHeader-ClKiNAEV.js";import{r as m}from"./index-DFv2mRv-.js";import{c as xe}from"./ReactAppend-D9rqaU78.js";import{C as ge}from"./CreateReactScript-CtLyd6nM.js";import{i as T}from"./tippy-react.esm-CGYKl-Jd.js";import{m as B}from"./main-rZoj-gSW.js";import{B as te}from"./ModalImportItem-DaJ_kNWW.js";import{S as re}from"./SwitchFormGroup-Da1zo_US.js";import{G as oe}from"./Global-BM4Id4Pw.js";import{S as ae}from"./SortByAfterField-BaS5rBg8.js";import{I as ce}from"./InputFormGroup-C-k79te8.js";import{T as me}from"./TextareaFormGroup-CbILxKD5.js";import{M as se}from"./Modal-tOR4k_s7.js";import{S as X}from"./SelectFormGroup-D8GGDghx.js";import{S as be}from"./SetSelectValue-UxyCmHse.js";import{a as je,M as Q}from"./MenuItemContainer-BV6FEyQ-.js";import{G as ve}from"./GalleryRest-CfRUq7ye.js";import"./index-Sd7so-oN.js";import"./index.esm-M1-TJtwJ.js";import"./___vite-browser-external_commonjs-proxy-BQdpDcDf.js";/* empty css               *//* empty css              */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";class W extends te{constructor(){super(...arguments);M(this,"path","admin/system");M(this,"savePage",async(r={})=>{try{const{status:a,result:i}=await B.Fetch(`/api/${this.path}/page`,{method:"POST",body:JSON.stringify(r)});if(!a)throw new Error((i==null?void 0:i.message)||"Ocurrio un error inesperado");return i.data??[]}catch(a){return B.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:a.message,type:"danger"}),null}});M(this,"updateOrder",async r=>{try{const{status:a,result:i}=await B.Fetch(`/api/${this.path}/order`,{method:"PATCH",body:JSON.stringify(r)});if(!a)throw new Error((i==null?void 0:i.message)??"Ocurrio un error inesperado");return!0}catch(a){B.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:a.message,type:"danger"})}});M(this,"deletePage",async r=>{try{const{status:a,result:i}=await B.Fetch(`/api/${this.path}/page/${r}`,{method:"DELETE"});if(!a)throw new Error((i==null?void 0:i.message)||"Ocurrio un error inesperado");return i.data??!0}catch(a){return B.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:a.message,type:"danger"}),!1}});M(this,"exportBK",async()=>{try{const{status:r,result:a}=await B.Fetch(`/api/${this.path}/backup`);if(!r)throw new Error((a==null?void 0:a.message)||"Ocurrio un error inesperado");return a}catch(r){return B.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:r.message,type:"danger"}),null}});M(this,"importBK",async r=>{try{const a=await fetch(`/api/${this.path}/backup`,{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(B.Cookies.get("XSRF-TOKEN"))},body:r}),i=JSON.parseable(await a.text());if(!a.ok)throw new Error((i==null?void 0:i.message)||"Ocurrio un error inesperado");return i??!0}catch(a){return B.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:a.message,type:"danger"}),null}})}}const Y=(t="")=>{t=t.replace(/[^a-zA-Z0-9_{}]/g,"");const n=/{([^}]+)}/g,r=[];let a;for(;(a=n.exec(t))!==null;)r.push(a[1]);return r},Ne=(t,n)=>{const r=new RegExp(`[${n}]+$`,"g");return t.replace(r,"")},J=new W,we=t=>{const{id:n,name:r,path:a,extends_base:i=!1,menuable:x=!1,setPages:u,onSEOClicked:j,onParamsClicked:g}=t,[o,l]=m.useState(!1),[d,h]=m.useState(!1),[N,S]=m.useState(!1),[y,p]=m.useState(!1),f=async C=>{if(r===C.target.value)return l(!1);J.savePage({id:n,name:C.target.value})&&(l(!1),u(v=>v.map(b=>b.id===n?{...b,name:C.target.value}:b)))},R=async C=>{if(a===C.target.value)return h(!1);const c=C.target.value;let v=structuredClone(c);const b=t.using??{};for(const P of Y(c))v=v.replace(`{${P}}`,"").replace(`{${P}?}`,""),b[P]=b[P]??{model:null};const k=Ne(v,"/");J.savePage({id:n,path:c,pseudo_path:k,using:Object.keys(b).length>0?b:void 0})&&(h(!1),u(P=>P.map(H=>H.id===n?{...H,path:C.target.value}:H)))},O=async C=>{S(!0);const c=C.target.checked,v=J.savePage({id:n,extends_base:c});S(!1),v&&u(b=>b.map(k=>k.id===n?{...k,extends_base:c}:k))},D=async C=>{p(!0);const c=C.target.checked,v=J.savePage({id:n,menuable:c});p(!1),v&&u(b=>b.map(k=>k.id===n?{...k,menuable:c}:k))},G=async C=>{await J.deletePage(C.id)&&(u(v=>v.filter(b=>b.id!=C.id)),$('[data-bs-toggle="tab"]').removeClass("active"),$(".tab-pane").removeClass("active"),$("#base-template-link").addClass("active"),$("#base-template").addClass("active"))},V=Y(a);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"dropdown float-end",children:[e.jsx("a",{href:"#",className:"dropdown-toggle arrow-none card-drop","data-bs-toggle":"dropdown","aria-expanded":"false",children:e.jsx("i",{className:"mdi mdi-dots-vertical"})}),e.jsxs("div",{className:"dropdown-menu dropdown-menu-end",children:[e.jsxs("button",{className:"dropdown-item",onClick:()=>j(t),children:[e.jsx("i",{className:"mdi mdi-cloud-search-outline me-1"}),"Editar SEO"]}),V.length>0&&e.jsxs("button",{className:"dropdown-item",onClick:()=>g(t),children:[e.jsx("i",{className:"mdi mdi-code-braces me-1"}),"Parámetros"]}),e.jsx("div",{className:"dropdown-divider"}),e.jsxs("button",{className:"dropdown-item",onClick:()=>G(t),children:[e.jsx("i",{className:"mdi mdi-trash-can-outline me-1"}),"Eliminar página"]})]})]}),e.jsxs("div",{children:[o?e.jsx("input",{className:"form-control form-control-sm mb-1",defaultValue:r,onBlur:f,autoFocus:!0}):e.jsx(T,{content:"Editar nombre",placement:"left",children:e.jsx("h4",{className:"header-title mb-1 d-block",onClick:()=>l(!0),style:{minWidth:"200px",cursor:"pointer"},children:r||"Sin nombre"})}),d?e.jsx("input",{className:"form-control form-control-sm mb-1",defaultValue:a,style:{minHeight:27,fieldSizing:"content"},onBlur:R,autoFocus:!0}):e.jsx(T,{content:"Editar ruta",placement:"left",children:e.jsx("small",{className:"text-muted d-block mb-1",onClick:()=>h(!0),style:{minWidth:"200px",cursor:"pointer"},children:a||"Sin ruta"})})]}),e.jsxs("div",{className:"row",children:[e.jsx(re,{label:"Extiende de base",col:"col-lg-6 col-md-12 col-sm-6",checked:i,onChange:O,disabled:N}),e.jsx(re,{label:"Mostrar en menu",col:"col-lg-6 col-md-12 col-sm-6",checked:x,onChange:D,disabled:y})]})]})},ye=new W,Ce=({dataLoaded:t,setDataLoaded:n,modalRef:r})=>{const a=m.useRef(null),i=m.useRef(null),x=m.useRef(null),u=async j=>{j.preventDefault(),await ye.savePage({id:t.id,description:i.current.value,keywords:$(x.current).val()})&&(n(null),$(r.current).modal("hide"))};return m.useEffect(()=>{a.current.value=`${t==null?void 0:t.name} | ${oe.APP_NAME}`,i.current.value=(t==null?void 0:t.description)??"",be(x.current,(t==null?void 0:t.keywords)??[])},[t]),e.jsx(se,{modalRef:r,title:`Editar SEO - ${t==null?void 0:t.name}`,size:"sm",onSubmit:u,children:e.jsxs("div",{id:"seo-container",children:[e.jsx(ce,{eRef:a,label:"Título",disabled:!0}),e.jsx(me,{eRef:i,label:"Descripción",rows:2}),e.jsx(X,{eRef:x,label:"Palabras clave",tags:!0,multiple:!0,dropdownParent:"#seo-container"})]})})},ie=({className:t,system:n,component:r,onComponentClicked:a,onDeleteClicked:i,onEditDataClicked:x})=>{var g;const u=(r==null?void 0:r.options)??[],j=u.find(o=>o.id==n.value);return e.jsxs("div",{className:`dropdown ${t}`,"data-id":n.id,children:[e.jsxs("div",{className:"btn btn-light dropdown-toggle text-truncate w-100 text-start",type:"button",id:`dd-${n.id}`,"data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true",children:[e.jsx("i",{className:"mdi mdi-chevron-down ms-1 float-end"}),e.jsxs("span",{className:"handle-sortable",style:{cursor:"move"},children:[e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("i",{className:"fa fa-ellipsis-v"})]}),e.jsx("span",{className:"ms-1",children:n.name})]}),e.jsxs("div",{className:"dropdown-menu","aria-labelledby":`dd-${n.id}`,"data-popper-placement":"bottom-start",children:[u.length>1&&e.jsxs(e.Fragment,{children:[u.filter(o=>o.id!=n.value).map(o=>e.jsxs("button",{className:"dropdown-item",onClick:()=>a({...n,name:`${r.name} - ${o.name}`,value:o.id}),children:[r.name," - ",o.name]})),e.jsx("div",{className:"dropdown-divider"})]}),(((g=j==null?void 0:j.using)==null?void 0:g.filters)||(j==null?void 0:j.data))&&e.jsxs("button",{className:"dropdown-item",onClick:()=>x(n,j),children:[e.jsx("i",{className:"mdi mdi-pencil me-1"}),"Configurar datos"]}),e.jsxs("button",{className:"dropdown-item",onClick:()=>i(n),children:[e.jsx("i",{className:"mdi mdi-trash-can-outline me-1"}),"Eliminar"]})]})]})},$e=({col:t,label:n,eRef:r,placeholder:a,required:i=!1,rows:x=3,value:u,onChange:j=()=>{}})=>{const[g,o]=m.useState(u),l=m.useRef(),d=m.useRef(null),h=r||l;return m.useEffect(()=>(d.current&&(d.current.toTextArea(),d.current=null),d.current=CodeMirror.fromTextArea(h.current,{mode:"htmlmixed",theme:"sode",indentUnit:2,tabSize:2}),d.current.setValue(u),setTimeout(()=>{d.current.refresh()},125),d.current.on("change",N=>{const S=N.getValue();o(S),j({target:{value:S}})}),()=>{d.current&&(d.current.toTextArea(),d.current=null)}),[h]),m.useEffect(()=>{g!==u&&(o(u),d.current&&(d.current.setValue(u),setTimeout(()=>{d.current.refresh()},125)))},[u]),e.jsxs("div",{className:`form-group ${t} mb-2`,children:[e.jsxs("label",{htmlFor:"",className:"mb-1",children:[n," ",i&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsx("textarea",{ref:h,className:"form-control",placeholder:a,required:i,rows:x,defaultValue:u,onChange:N=>o(N.target.value)})]})},Re=new W,ke=({dataLoaded:t,setDataLoaded:n,setSystems:r,modalRef:a})=>{var o,l,d,h,N,S,y,p,f,R,O,D,G,V,C;const[i,x]=m.useState((t==null?void 0:t.data)||{}),u={};u.model=m.useRef(null),u.filters=m.useRef(null);const j=async c=>{c.preventDefault();const v=await Re.save({id:t.id,data:i,filters:$(u.filters.current).val()});v&&(n(null),$(a.current).modal("hide"),r(b=>b.map(k=>k.id==t.id?v.data:k)))};m.useEffect(()=>{var v,b,k;const c={};(v=t==null?void 0:t.component)==null||v.data.forEach(U=>{var P;c[U]=((P=t==null?void 0:t.data)==null?void 0:P[U])??""}),x(c),u.model.current.value=((k=(b=t==null?void 0:t.component)==null?void 0:b.using)==null?void 0:k.model)??"",$(u.filters.current).val((t==null?void 0:t.filters)??[]).trigger("change")},[t]);const g=(c,v)=>{x({...i,[c]:v})};return console.log(i),e.jsxs(se,{modalRef:a,title:t==null?void 0:t.name,onSubmit:j,size:(l=(o=t==null?void 0:t.component)==null?void 0:o.data)!=null&&l.some(c=>c.startsWith("code:"))?"lg":"md",children:[e.jsxs("ul",{className:"nav nav-tabs nav-bordered",children:[e.jsx("li",{className:"nav-item",hidden:!((h=(d=t==null?void 0:t.component)==null?void 0:d.data)!=null&&h.length),children:e.jsx("a",{href:"#tab-info","data-bs-toggle":"tab","aria-expanded":"true",className:"nav-link active",children:"Información"})}),e.jsx("li",{className:"nav-item",hidden:!((S=(N=t==null?void 0:t.component)==null?void 0:N.using)!=null&&S.filters),children:e.jsx("a",{href:"#tab-db","data-bs-toggle":"tab","aria-expanded":"true",className:"nav-link",children:"Base de datos"})})]}),e.jsxs("div",{className:"tab-content",id:"data-modal-container",children:[e.jsx("div",{className:"tab-pane active",id:"tab-info",hidden:!((p=(y=t==null?void 0:t.component)==null?void 0:y.data)!=null&&p.length),children:(R=(f=t==null?void 0:t.component)==null?void 0:f.data)==null?void 0:R.map((c,v)=>c.startsWith("code:")?e.jsx($e,{label:c.replace("code:",""),value:i[c]??"",rows:1,onChange:b=>x({...i,[c]:b.target.value})},v):e.jsx(e.Fragment,{children:c.startsWith("bool:")?e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:c.replace("bool:","")}),e.jsxs("div",{children:[e.jsxs("div",{className:"form-check form-check-inline",children:[e.jsx("input",{type:"radio",className:"form-check-input",id:`${c}-true`,name:c,value:"true",checked:i[c]===!0,onChange:b=>g(c,b.target.value==="true")}),e.jsx("label",{className:"form-check-label",htmlFor:`${c}-true`,children:"Sí"})]}),e.jsxs("div",{className:"form-check form-check-inline",children:[e.jsx("input",{type:"radio",className:"form-check-input",id:`${c}-false`,name:c,value:"false",checked:i[c]===!1,onChange:b=>g(c,b.target.value==="true")}),e.jsx("label",{className:"form-check-label",htmlFor:`${c}-false`,children:"No"})]})]})]}):e.jsx(me,{label:c,value:i[c]??"",rows:1,onChange:b=>x({...i,[c]:b.target.value})},v)}))}),e.jsxs("div",{className:"tab-pane show",id:"tab-db",children:[e.jsx(ce,{eRef:u.model,label:"Modelo",disabled:!0}),e.jsx(X,{eRef:u.filters,label:"Filtros",multiple:!0,dropdownParent:"#tab-db",hidden:!((D=(O=t==null?void 0:t.component)==null?void 0:O.using)!=null&&D.filters),children:(C=(V=(G=t==null?void 0:t.component)==null?void 0:G.using)==null?void 0:V.filters)==null?void 0:C.map((c,v)=>e.jsx("option",{value:c,children:c},v))})]})]})]})},le=new W,Se=({components:t,onClick:n})=>e.jsx("div",{className:"left-side-menu top-0 pt-2",children:e.jsxs("div",{"data-simplebar":!0,className:"h-100",children:[e.jsx("div",{id:"sidebar-menu",className:"show",children:e.jsxs("ul",{id:"side-menu",children:[e.jsx("li",{className:"menu-title",children:"Lista de componentes"}),t.filter(r=>r.options.length>0).map((r,a)=>e.jsx(je,{title:r.name,children:r.options.map((i,x)=>e.jsx(Q,{name:i.name,icon:i.image,onClick:()=>{const u=$(".tab-pane:visible .components-container > div").last().data("id");n({name:`${r.name} - ${i.name}`,component:r.id,value:i.id,after_component:u})},children:i.name},x))},a)),e.jsx("li",{className:"menu-title",children:"Sistema de respaldo"}),e.jsx(Q,{icon:"mdi mdi-cogs",rightBarToggle:!0,children:"Configuraciones"}),e.jsx(Q,{icon:"mdi mdi-cloud-download",onClick:async()=>{const r=await le.exportBK(),a=new Blob([JSON.stringify(r)],{type:"application/json"}),i=URL.createObjectURL(a),x=document.createElement("a");x.href=i,x.download="backup.json",document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(i)},children:"Exportar Backup"}),e.jsx("input",{type:"file",id:"file-input",accept:"application/json",style:{display:"none"},onChange:async r=>{const a=r.target.files[0];if(r.target.value=null,a){const i=new FormData;if(i.append("backup",a),!await le.importBK(i))return;location.reload()}}}),e.jsx(Q,{icon:"mdi mdi-backup-restore",onClick:()=>{document.getElementById("file-input").click()},children:"Importar Backup"})]})}),e.jsx("div",{className:"clearfix"})]})}),Ee=({page:t,param:n,models:r,setUsing:a,setPages:i})=>{var N,S,y;const x=m.useRef(),u=m.useRef(),j=m.useRef(),g=t==null?void 0:t.using,[o,l]=m.useState(null),d=p=>{const f=x.current.value,R=r.find(O=>O.name==f)??null;l(R)};m.useEffect(()=>{var p;$(x.current).val((p=g==null?void 0:g[n])==null?void 0:p.model).trigger("change")},[n]),m.useEffect(()=>{var p,f;a(R=>({...R,[n]:{...R[n],model:(o==null?void 0:o.name)??null}})),$(u.current).val(((p=g==null?void 0:g[n])==null?void 0:p.field)??null).trigger("change"),$(j.current).val(((f=g==null?void 0:g[n])==null?void 0:f.relations)??[]).trigger("change")},[o]);const h=`${n}-container`;return e.jsxs("div",{id:h,className:"row",children:[e.jsxs("label",{className:"form-label",children:["Parámetro ",e.jsx("code",{children:n})]}),e.jsx(X,{eRef:x,label:"Modelo",col:"col-md-6",dropdownParent:`#${h}`,onChange:d,children:r.map((p,f)=>e.jsx("option",{value:p.name,children:p.name},f))}),e.jsx(X,{eRef:u,label:"Campo",col:"col-md-6",dropdownParent:`#${h}`,onChange:p=>{a(f=>({...f,[n]:{...f[n],field:p.target.value}}))},children:(N=o==null?void 0:o.fields)==null?void 0:N.map((p,f)=>e.jsx("option",{children:p},f))}),e.jsx("div",{hidden:(((S=o==null?void 0:o.relations)==null?void 0:S.length)??0)==0,children:e.jsx(X,{eRef:j,label:"Relaciones",multiple:!0,dropdownParent:`#${h}`,onChange:p=>{const f=$(p.target).val();a(R=>({...R,[n]:{...R[n],relations:f}}))},children:(y=o==null?void 0:o.relations)==null?void 0:y.map((p,f)=>e.jsx("option",{children:p},f))})})]})},Pe=new W,Fe=({dataLoaded:t,setDataLoaded:n,setPages:r,modalRef:a,models:i})=>{const x=Y((t==null?void 0:t.path)??""),[u,j]=m.useState({}),g=async o=>{o.preventDefault();const l=await Pe.savePage({id:t.id,using:u});l&&(n(null),r(l),$(a.current).modal("hide"))};return m.useEffect(()=>{j((t==null?void 0:t.using)??{})},[t]),e.jsx(se,{modalRef:a,title:`Editar parámetros de URL - ${t==null?void 0:t.name}`,onSubmit:g,onClose:()=>n(null),children:x.map((o,l)=>e.jsx(Ee,{page:t,param:o,models:i,using:u,setUsing:j,setPages:r},l))})};class Be extends te{constructor(){super(...arguments);M(this,"path","admin/colors")}}class Oe extends te{constructor(){super(...arguments);M(this,"path","admin/settings")}}const De=new ve,Ie=new Be,Me=new Oe,_e=({colors:t,setColors:n,settings:r,setSettings:a})=>{const[i,x]=m.useState([{uuid:crypto.randomUUID(),col:"col-3",name:"Icon (1:1)",src:"icon.png",width:"100%",aspectRatio:1},{uuid:crypto.randomUUID(),col:"col-5",name:"Logo (13:4)",src:"logo.png",width:"100%",aspectRatio:3.25},{uuid:crypto.randomUUID(),col:"col-4",name:"Logo footer (1:1)",src:"logo-footer.png",width:"100%",aspectRatio:1}]),u=async l=>{var y;const d=((y=l.target.files)==null?void 0:y[0])??null;if(!d)return;l.target.value=null;const h=l.target.name,N=new FormData;N.append("image",d),N.append("name",h),await De.save(N)&&x(p=>p.map(f=>(f.src==h&&(f.uuid=crypto.randomUUID()),f)))},j=async l=>{const d=l.target.getAttribute("data-color-id"),h=l.target.name,N=l.target.value;if(t.find(p=>p.id==d)[h]===N)return;const y=await Ie.save({id:d,[h]:N});y&&n(p=>p.map(f=>f.id==d?y.data:f))},g=async l=>{var p;const d=l.target.getAttribute("data-id"),h=l.target.name,N=l.target.value;if((((p=r.find(f=>f.name==h))==null?void 0:p.description)??"")===N)return;const y=await Me.save({name:h,value:N});y&&a(f=>f.map(R=>R.id==d?y.data:R))},o=l=>{const d=r.find(h=>h.name==l);return d?d.value:""};return e.jsx("div",{className:"right-bar",children:e.jsxs("div",{"data-simplebar":!0,className:"h-100",children:[e.jsxs("div",{className:"rightbar-title",children:[e.jsx("a",{href:"#",className:"right-bar-toggle float-end",children:e.jsx("i",{className:"mdi mdi-close"})}),e.jsx("h4",{className:"font-16 m-0 text-white",children:"Configuraciones"})]}),e.jsxs("div",{className:"p-2",children:[e.jsx("h5",{children:"Imágenes principales"}),e.jsx("div",{className:"row",children:i.map((l,d)=>{const h="file-"+l.uuid;return e.jsxs("div",{className:l.col,children:[e.jsx("input",{id:h,name:l.src,type:"file",accept:"image/png",hidden:!0,onChange:u}),e.jsx("label",{htmlFor:h,className:"form-label d-block mb-1",style:{cursor:"pointer"},children:l.name}),e.jsx("label",{htmlFor:h,style:{cursor:"pointer"},className:"w-100",children:e.jsx("img",{className:"border",src:`/assets/resources/${l.src}?v=${l.uuid}`,alt:"",style:{height:l.height,width:l.width,objectFit:"contain",objectPosition:"center",backgroundColor:"#f5f5f5",borderRadius:"4px",aspectRatio:l.aspectRatio}})})]},d)})}),e.jsx("hr",{className:"my-2"}),e.jsx("h5",{children:"Fuentes del sistema"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"",className:"form-label mb-1",children:"Titulos"}),e.jsx(T,{content:"Nombre de la fuente",children:e.jsx("input",{type:"text",className:"form-control form-control-sm mb-1",name:"title-font-name",defaultValue:o("title-font-name"),onBlur:g})}),e.jsx(T,{content:"Enlace de la fuente",children:e.jsx("textarea",{className:"form-control form-control-sm",rows:1,name:"title-font-url",defaultValue:o("title-font-url"),onBlur:g,style:{minHeight:27,fieldSizing:"content"}})})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"",className:"form-label mb-1",children:"Parrafos"}),e.jsx(T,{content:"Nombre de la fuente",children:e.jsx("input",{type:"text",className:"form-control form-control-sm mb-1",name:"paragraph-font-name",defaultValue:o("paragraph-font-name"),onBlur:g})}),e.jsx(T,{content:"Enlace de la fuente",children:e.jsx("textarea",{className:"form-control form-control-sm",rows:1,name:"paragraph-font-url",defaultValue:o("paragraph-font-url"),onBlur:g,style:{minHeight:27,fieldSizing:"content"}})})]}),e.jsx("hr",{className:"my-2"}),e.jsx("h5",{children:"Colores del sistema"}),e.jsx("div",{className:"d-flex flex-column gap-1",children:t.map((l,d)=>e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("span",{className:"input-group-text px-1",children:e.jsx("input",{type:"color",name:"description","data-color-id":l.id,className:"p-0",style:{width:"20px",height:"20px",border:"1px solid #ced4da",borderRadius:"4px",cursor:"pointer"},defaultValue:l.description,onBlur:j})}),e.jsx("input",{type:"text",name:"name","data-color-id":l.id,className:"form-control form-control-sm",placeholder:"Color",defaultValue:l.name,onBlur:j,disabled:l.name=="primary",style:{cursor:l.name=="primary"?"not-allowed":"text"}})]},d))})]})]})})},q=new W,Ae=({systems:t=[],pages:n=[],colors:r=[],components:a,models:i,settings:x=[]})=>{const u=m.useRef(null),j=m.useRef(null),g=m.useRef(null),[o,l]=m.useState(t),[d,h]=m.useState(n),[N,S]=m.useState(r),[y,p]=m.useState(x),[f,R]=m.useState(!1),[O,D]=m.useState(null),[G,V]=m.useState(null),[C,c]=m.useState(!1),[v,b]=m.useState(null),k=async()=>{R(!0);const s=await q.savePage();s&&(R(!1),h(s))},U=async s=>{const E=$(".tab-pane:visible").data("id")??null;s.page_id=E;const F=await q.save(s);if(!F)return;const _=F.data;l(A=>A.some(I=>I.id===_.id)?A.map(I=>I.id===_.id?_:I):[...A,_])},P=async s=>{await q.delete(s.id)&&l(E=>E.filter(F=>F.id!=s.id))};m.useEffect(()=>{document.title=`Sistema | ${oe.APP_NAME}`,B.Fetch("/api/admin/has-remote-changes").then(({status:s,result:w})=>{s&&(c(w.data.has_changes),b(w.data.last_commit))})},[null]),m.useEffect(()=>{const s=$("iframe:visible");s&&($(s).removeAttr("src"),$(s).attr("src",s.data("path")))},[o,N,y]);const H=s=>{const w=$(s.target).data("page-id"),E=$(s.target).data("page-path"),F=$(s.target).val();$(`#iframe-${w}`).removeAttr("src"),$(`#iframe-${w}`).attr("src",`${E}/${F}`)},ue=async s=>{D(s),$(u.current).modal("show")},de=async s=>{D(s),$(j.current).modal("show")},ne=async(s,w)=>{V({...s,component:w}),$(g.current).modal("show")};return m.useEffect(()=>{[...$(".components-container")].forEach(w=>{$(w).sortable({connectWith:".components-container",handle:".handle-sortable",forcePlaceholderSize:!0,update:async function(E,F){const _=[...$(w).children()],A={};if(_.forEach(Z=>{const I=$(Z).data("id"),z=$(Z).prev().data("id")??null,K=o.find(L=>L.id==I);(K==null?void 0:K.after_component)!==z&&(A[I]=z)}),Object.keys(A).length>0){if(!await q.updateOrder(A))return;l(I=>{const z=[...I];return Object.entries(A).forEach(([K,L])=>{const ee=z.findIndex(he=>he.id==K);ee!==-1&&(z[ee]={...z[ee],after_component:L})}),z})}}}).disableSelection()})},[d,o]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"wrapper position-relative",children:[e.jsx(Se,{components:a,onClick:U}),e.jsx("div",{className:"content-page mt-2 pb-3",style:{height:"max-content"},children:e.jsx("div",{className:"content mt-2",children:e.jsxs("div",{className:"container-fluid",children:[e.jsx("button",{className:"button-menu-mobile d-lg-none d-md-block position-absolute ",style:{zIndex:1,border:"none",borderRadius:"0 50% 50% 0",backgroundColor:"#fff",color:"#343a40",top:"50%",left:"0",transform:"translateY(-50%)",padding:"24px 0px 20px 6px ",fontWeight:"bold"},children:"〉"}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card mb-0",children:e.jsxs("div",{className:"card-body",style:{height:"calc(100vh - 48px)"},children:[e.jsxs("ul",{className:"nav nav-tabs nav-bordered flex-nowrap",style:{overflowX:"auto",overflowY:"hidden"},children:[e.jsx("li",{className:"nav-item",children:e.jsx("a",{id:"base-template-link",href:"#base-template","data-bs-toggle":"tab","aria-expanded":"false",className:"nav-link active h-100",children:"Base"})}),d.map((s,w)=>e.jsx("li",{className:"nav-item",children:e.jsxs("a",{href:`#page-${s.id}`,"data-bs-toggle":"tab","aria-expanded":"false",className:"nav-link h-100",style:{whiteSpace:"nowrap"},children:[s.name,e.jsx("small",{className:"d-block text-muted",style:{fontWeight:"normal"},children:s.path})]})},w)),e.jsx("li",{className:"nav-item d-flex justify-content-center align-items-center px-2",children:e.jsx(T,{content:"Agregar página",children:e.jsx("button",{className:"nav-link btn btn-xs btn-white rounded-pill",onClick:k,disabled:f,children:f?e.jsx("i",{className:"mdi mdi-loading mdi-spin"}):e.jsx("i",{className:"mdi mdi-plus"})})})})]}),e.jsxs("div",{className:"tab-content",children:[e.jsx("div",{className:"tab-pane active",id:"base-template",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"d-flex flex-column gap-2 components-container","data-page-id":null,children:ae(o).filter(s=>s.page_id==null).map(s=>{const w=a.find(E=>E.id==s.component);if(w==null||w.options,s.component=="content")return e.jsxs("button",{"data-id":s.id,className:"btn btn-light text-truncate w-100 text-start",type:"button",children:[e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("span",{className:"ms-1",children:s.name})]},s.id);{const E=a.find(F=>F.id==s.component);return e.jsx(ie,{className:"",system:s,component:E,onComponentClicked:U,onDeleteClicked:P,onEditDataClicked:ne},s.id)}})})}),e.jsx("div",{className:"col-md-8",children:e.jsx("iframe",{src:"/base-template","data-path":"/base-template",className:"w-100 h-100 border",style:{minHeight:"calc(100vh - 185px)",borderRadius:"4px"}})})]})}),d.map((s,w)=>e.jsx("div",{className:"tab-pane",id:`page-${s.id}`,"data-id":s.id,children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx(we,{...s,models:i,setPages:h,onSEOClicked:ue,onParamsClicked:de}),e.jsx("hr",{className:"my-2"}),e.jsx("div",{className:"d-flex flex-column gap-2 components-container","data-page-id":s.id,children:ae(o).filter(E=>E.page_id==s.id).map(E=>{const F=a.find(_=>_.id==E.component);return e.jsx(ie,{className:"",system:E,component:F,onComponentClicked:U,onDeleteClicked:P,onEditDataClicked:ne},E.id)})})]}),e.jsxs("div",{className:"col-md-8",children:[e.jsxs("div",{className:"input-group mb-2",children:[e.jsxs("span",{className:"input-group-text",children:[(s==null?void 0:s.pseudo_path)||s.path,Y(s==null?void 0:s.path).length>0&&"/"]}),Y(s==null?void 0:s.path).length>0&&e.jsx("input",{type:"text",className:"form-control",placeholder:"Parametros","data-page-path":s.pseudo_path,"data-page-id":s.id,onChange:H})]}),e.jsx("iframe",{id:`iframe-${s.id}`,src:(s==null?void 0:s.pseudo_path)||s.path,"data-path":(s==null?void 0:s.pseudo_path)||s.path,className:"w-100 h-100 border",style:{minHeight:"calc(100vh - 185px)",borderRadius:"4px"}})]})]})},w))]})]})})})})]})})}),C&&e.jsx(T,{content:v,children:e.jsx("button",{className:"btn btn-dark p-0 position-absolute rounded-pill",style:{right:"20px",bottom:"20px",height:"40px",width:"40px"},children:e.jsx("i",{className:"mdi mdi-github mdi-24px"})})})]}),e.jsx(_e,{colors:N,setColors:S,settings:y,setSettings:p}),e.jsx(Ce,{dataLoaded:O,setDataLoaded:D,modalRef:u}),e.jsx(Fe,{dataLoaded:O,setDataLoaded:D,setPages:h,modalRef:j,models:i}),e.jsx(ke,{dataLoaded:G,setDataLoaded:V,setSystems:l,modalRef:g})]})};ge((t,n)=>{xe(t).render(e.jsx(Ae,{...n}))});
