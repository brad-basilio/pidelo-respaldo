var ne=Object.defineProperty;var oe=(l,o,a)=>o in l?ne(l,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[o]=a;var O=(l,o,a)=>(oe(l,typeof o!="symbol"?o+"":o,a),a);import{j as r}from"./AboutHeader-CpM0iYLI.js";import{r as n}from"./index-B80Lgev0.js";import{c as ie}from"./ReactAppend-CBRQCQGz.js";import{B as le}from"./Base-C8-emTZa.js";import{C as ce}from"./CreateReactScript-wgaspG1d.js";import{T as ue,R as P,D as K}from"./ReactAppend-BED5KUHB.js";import{M as ae}from"./Modal-Dbgjpj-3.js";import{I as u}from"./InputFormGroup-aFB8_JHY.js";import{T as me}from"./TextareaFormGroup-BFYMlwZm.js";import{S as U}from"./SwitchFormGroup-DbO3fJgb.js";import{I as pe}from"./ImageFormGroup-T-L_V8AU.js";import{S as I}from"./SelectFormGroup-qFWtdfMk.js";import{S as fe}from"./sweetalert2.all-Dh0rZL5X.js";import{B as de}from"./BasicEditing-Co4zseXw.js";import{Q as be}from"./QuillFormGroup-D7flic0d.js";import{r as W}from"./DxBox-CdMuSyGE.js";import{B as xe}from"./BasicEditing-DhCb8-e3.js";import"./index-DO3Aws4m.js";import"./Global-mC9lKANG.js";import"./tippy-react.esm-CHhA99mn.js";/* empty css              */import"./main-B2CtU6ez.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./MenuItem-B0W8YWic.js";import"./index.esm-Cu-mVv1q.js";/* empty css               */import"./ArrayDetails2Object-DR0Igcn7.js";import"./em-C9j-sJ25.js";import"./HtmlContent-BZJNaxQq.js";class he extends de{constructor(){super(...arguments);O(this,"path","admin/courses");O(this,"hasFiles",!0)}}const f=new he,ge=({icons:l,categories:o,details:a})=>{const p=n.useRef(),j=n.useRef(),v=n.useRef(),R=n.useRef(),y=n.useRef(),N=n.useRef(),C=n.useRef(),w=n.useRef(),S=n.useRef(),F=n.useRef(),T=n.useRef(),D=n.useRef(),k=n.useRef(),q=n.useRef(),B=n.useRef(),d=n.useRef(),[X,J]=n.useState(!1),[_,b]=n.useState([""]),[M,x]=n.useState([""]),[V,h]=n.useState([""]),[Q,g]=n.useState([{icon:"",text:""}]),z=e=>{e!=null&&e.id?J(!0):J(!1),v.current.value=(e==null?void 0:e.id)??"",$(R.current).val((e==null?void 0:e.category_id)??null).trigger("change"),y.current.value=(e==null?void 0:e.name)??"",N.current.value=(e==null?void 0:e.summary)??"",C.editor.root.innerHTML=(e==null?void 0:e.description)??"",w.current.value=(e==null?void 0:e.sessions)??0,S.current.value=(e==null?void 0:e.type)??"Presencial",F.current.value=(e==null?void 0:e.certificate)??"",T.current.value=(e==null?void 0:e.session_duration)??"",D.current.value=(e==null?void 0:e.long_duration)??"",k.current.value=(e==null?void 0:e.price)??"",q.current.value=(e==null?void 0:e.discount)??"",B.current.value=(e==null?void 0:e.students)??"",d.image.src=`/api/courses/media/${e==null?void 0:e.image}`,d.current.value=null,b(e!=null&&e.audience?JSON.parse(e.audience):[""]),x(e!=null&&e.requirements?JSON.parse(e.requirements):[""]),h(e!=null&&e.objectives?JSON.parse(e.objectives):[""]),g(e!=null&&e.content?JSON.parse(e.content):[{icon:"",text:""}]),$(j.current).modal("show")},Y=async e=>{e.preventDefault();const t={id:v.current.value||void 0,category_id:R.current.value,name:y.current.value,summary:N.current.value,description:C.current.value,sessions:w.current.value,type:S.current.value,certificate:F.current.value,session_duration:T.current.value,long_duration:D.current.value,price:k.current.value,discount:q.current.value,students:B.current.value,audience:JSON.stringify(_.filter(Boolean)),requirements:JSON.stringify(M.filter(Boolean)),objectives:JSON.stringify(V.filter(Boolean)),content:JSON.stringify(Q.filter(c=>c.icon||c.text))},s=new FormData;for(const c in t)s.append(c,t[c]);const i=d.current.files[0];i&&s.append("image",i),await f.save(s)&&($(p.current).dxDataGrid("instance").refresh(),$(j.current).modal("hide"))},Z=async({id:e,value:t})=>{await f.boolean({id:e,field:"visible",value:t})&&$(p.current).dxDataGrid("instance").refresh()},ee=async({id:e,value:t})=>{await f.boolean({id:e,field:"featured",value:t})&&$(p.current).dxDataGrid("instance").refresh()},re=async e=>{const{isConfirmed:t}=await fe.fire({title:"Eliminar curso",text:"¿Estás seguro de eliminar este curso?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!t||!await f.delete(e)||$(p.current).dxDataGrid("instance").refresh()},A=(e,t,s)=>{s(i=>i.map((m,c)=>c===e?t:m))},E=e=>{e(t=>[...t,""])},G=(e,t)=>{t(s=>s.filter((i,m)=>m!==e))},H=(e,t,s)=>{g(i=>i.map((m,c)=>c===e?{...m,[t]:s}:m))},te=()=>{g(e=>[...e,{icon:"",text:""}])},se=e=>{g(t=>t.filter((s,i)=>i!==e))},L=e=>$(W(r.jsx("span",{children:r.jsx("i",{className:`${e.id} me-1`})})));return r.jsxs(r.Fragment,{children:[r.jsx(ue,{gridRef:p,title:r.jsx(xe,{correlative:"courses",details:a}),rest:f,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(p.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo curso",hint:"Nuevo curso",onClick:()=>z()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"category.name",caption:"Categoría"},{dataField:"name",caption:"Nombre",cellTemplate:(e,{data:t})=>{e.html(W(r.jsx(r.Fragment,{children:t.name})))}},{dataField:"price",caption:"Precio",dataType:"number",width:"100px",cellTemplate:(e,{data:t})=>{e.text(`S/.${Number(t.price).toFixed(2)}`)}},{dataField:"image",caption:"Imagen",width:"90px",allowFiltering:!1,cellTemplate:(e,{data:t})=>{P(e,r.jsx("img",{src:`/api/courses/media/${t.image}`,style:{width:"80px",height:"48px",objectFit:"cover",objectPosition:"center",borderRadius:"4px"},onError:s=>s.target.src="/api/cover/thumbnail/null"}))}},{dataField:"featured",caption:"Destacado",dataType:"boolean",width:"120px",cellTemplate:(e,{data:t})=>{P(e,r.jsx(U,{checked:t.featured,onChange:s=>ee({id:t.id,value:s.target.checked})}))}},{dataField:"visible",caption:"Visible",dataType:"boolean",width:"120px",cellTemplate:(e,{data:t})=>{P(e,r.jsx(U,{checked:t.visible,onChange:s=>Z({id:t.id,value:s.target.checked})}))}},{caption:"Acciones",cellTemplate:(e,{data:t})=>{e.css("text-overflow","unset"),e.append(K({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>z(t)})),e.append(K({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>re(t.id)}))},allowFiltering:!1,allowExporting:!1}]}),r.jsxs(ae,{modalRef:j,title:X?"Editar curso":"Agregar curso",onSubmit:Y,size:"lg",children:[r.jsxs("div",{className:"row",id:"principal-container",children:[r.jsx("input",{ref:v,type:"hidden"}),r.jsx(pe,{eRef:d,label:"Imagen",col:"col-md-6",aspect:1}),r.jsxs("div",{className:"col-md-6",children:[r.jsx(I,{eRef:R,label:"Categoría",required:!0,dropdownParent:"#principal-container",children:o.map((e,t)=>r.jsx("option",{value:e.id,children:e.name},t))}),r.jsx(u,{eRef:y,label:"Nombre del curso",required:!0}),r.jsx(me,{eRef:N,label:"Resumen",rows:3,required:!0}),r.jsxs("div",{className:"row",children:[r.jsx(u,{eRef:k,label:"Precio",type:"number",col:"col-sm-6",step:"0.01",required:!0}),r.jsx(u,{eRef:q,label:"Descuento",type:"number",col:"col-sm-6",step:"0.01"}),r.jsx(u,{eRef:w,label:"Sesiones",type:"number",placeholder:"12",col:"col-md-3",required:!0}),r.jsxs(I,{eRef:S,label:"Tipo",col:"col-md-5",dropdownParent:"#principal-container",children:[r.jsx("option",{children:"Presencial"}),r.jsx("option",{children:"Semipresencial"}),r.jsx("option",{children:"Virtual"})]}),r.jsx(u,{eRef:T,label:"Duración (horas)",type:"number",placeholder:"2",col:"col-md-4",required:!0})]})]})]}),r.jsxs("div",{className:"row",id:"courses-container",children:[r.jsx(u,{eRef:F,label:"Tipo certificado",col:"col-md-6",placeholder:"Físico y Virtual PDF",required:!0}),r.jsx(u,{eRef:B,label:"Estudiantes",type:"number",col:"col-md-2",required:!0}),r.jsx(u,{eRef:D,label:"Duración total (días)",placeholder:"30",col:"col-md-4"}),r.jsx(be,{eRef:C,label:"Descripción"}),r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"¿A quién va dirigido?"}),_.map((e,t)=>r.jsxs("div",{className:"input-group mb-2",children:[r.jsx("input",{type:"text",className:"form-control",value:e,onChange:s=>A(t,s.target.value,b)}),r.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>G(t,b),children:r.jsx("i",{className:"fa fa-trash"})})]},t)),r.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>E(b),children:"Agregar Audiencia"})]}),r.jsxs("div",{className:"col-md-6 mb-3",children:[r.jsx("label",{className:"form-label",children:"¿Cuáles son los requisitos?"}),M.map((e,t)=>r.jsxs("div",{className:"input-group mb-2",children:[r.jsx("input",{type:"text",className:"form-control",value:e,onChange:s=>A(t,s.target.value,x)}),r.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>G(t,x),children:r.jsx("i",{className:"fa fa-trash"})})]},t)),r.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>E(x),children:"Agregar Requisito"})]}),r.jsxs("div",{className:"col-md-12 mb-3",children:[r.jsx("label",{className:"form-label",children:"¿Qué aprenderas?"}),V.map((e,t)=>r.jsxs("div",{className:"input-group mb-2",children:[r.jsx("input",{type:"text",className:"form-control",value:e,onChange:s=>A(t,s.target.value,h)}),r.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>G(t,h),children:r.jsx("i",{className:"fa fa-trash"})})]},t)),r.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>E(h),children:"Agregar Objetivo"})]}),r.jsxs("div",{className:"col-12 mb-3",children:[r.jsx("label",{className:"form-label",children:"Contenido"}),Q.map((e,t)=>r.jsxs("div",{className:"input-group mb-2",style:{width:"100%"},children:[r.jsx(I,{className:"input-group-text",dropdownParent:"#courses-container",onChange:s=>H(t,"icon",s.target.value),templateResult:L,templateSelection:L,noMargin:!0,children:l.map((s,i)=>r.jsx("option",{value:s.id,children:s.value},i))}),r.jsx("input",{type:"text",className:"form-control",placeholder:"Texto",value:e.text,onChange:s=>H(t,"text",s.target.value)}),r.jsx("button",{type:"button",className:"btn btn-outline-danger input-group-text",onClick:()=>se(t),children:r.jsx("i",{className:"fa fa-trash"})})]},t)),r.jsx("button",{type:"button",className:"btn btn-outline-primary",onClick:te,children:"Agregar Contenido"})]})]})]})]})};ce((l,o)=>{ie(l).render(r.jsx(le,{...o,title:"Cursos",children:r.jsx(ge,{...o})}))});
