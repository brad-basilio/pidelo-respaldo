import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as y}from"./index-BH53Isel.js";import{N as p}from"./Number2Currency-e57Tgsuk.js";import{B as D,a as B,D as _}from"./DeliveryPricesRest-CYmfmjMz.js";import{M as z}from"./minus-jyhodMPN.js";import{P as I}from"./plus-Bot15Khs.js";import{T as R}from"./trash-2-DK1wnsDn.js";import{S as A}from"./react-select.esm-DL5f6Fad.js";import{u as G}from"./ubigeo-Q-ocg024.js";import{m as f}from"./main-BvVILmTO.js";import{I as w}from"./InputForm-BF3tk65A.js";import"./index-yBjzXJbu.js";import"./createLucideIcon-Cy5Ya80P.js";import"./hoist-non-react-statics.cjs-kbdZbs82.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";const L=({setCart:t,...a})=>{const l=()=>{t(c=>c.filter(n=>n.id!==a.id))},i=()=>{t(c=>c.map(n=>n.id===a.id?{...n,quantity:(n.quantity||1)+1}:n))},r=()=>{t(c=>c.map(n=>{if(n.id===a.id){const o=(n.quantity||1)-1;return o<=0?(l(a.id),null):{...n,quantity:o}}return n}).filter(Boolean))};return console.log(a),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:`/storage/images/item/${a.image}`,alt:a.name,className:"w-20 h-20 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-lg mb-2",children:a.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Marca: ",e.jsx("span",{className:"customtext-neutral-dark",children:a.brand.name})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Disponibilidad: ",e.jsxs("span",{className:"customtext-neutral-dark",children:[a.stock>=a.quantity?"En stock":"Agotado"," "]})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["SKU: ",e.jsx("span",{className:"customtext-neutral-dark",children:a.sku})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"w-36 text-right",children:[e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["S/ ",Number(a.price*a.quantity).toFixed(2)]}),e.jsxs("div",{className:"font-bold text-lg mt-2",children:["S/ ",Number(a.final_price*a.quantity).toFixed(2)]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[e.jsx("button",{type:"button",onClick:r,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Decrease quantity",children:e.jsx(z,{size:16})}),e.jsx("div",{className:"w-12 h-8 flex justify-center items-center bg-white",children:e.jsx("span",{className:"font-semibold text-sm",children:a.quantity||1})}),e.jsx("button",{type:"button",onClick:i,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Increase quantity",children:e.jsx(I,{size:16})})]}),e.jsx("button",{onClick:l,className:"p-2 text-gray-400 hover:text-red-500 transition-colors duration-200 rounded-full hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-200","aria-label":"Remove item",children:e.jsx(R,{size:18})})]})]})})]})},a.id)};function U({cart:t,setCart:a,onContinue:l,subTotal:i,envio:r,igv:c,totalFinal:n}){return console.log(t),e.jsxs("div",{className:"grid lg:grid-cols-5 gap-8",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx("div",{className:"space-y-6",children:t.map((o,x)=>e.jsx(L,{...o,setCart:a},x))})}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6",children:"Resumen de compra"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",p(i)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",p(c)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"EnvÃ­o"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",p(r)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",p(n)]})]})}),e.jsxs("div",{className:"space-y-2 pt-4",children:[e.jsx(D,{onClick:l,children:"  Continuar"}),e.jsx(B,{href:"/",children:" Cancelar"})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas losÂ ",e.jsx("a",{className:"customtext-primary font-bold",children:"TÃ©rminos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestraÂ ",e.jsx("a",{className:"customtext-primary font-bold",children:"PolÃ­tica de Privacidad"}),"."]})})]})]})]})}function K(){let t="";for(let a=0;a<12;a++){const l=Math.floor(Math.random()*10);t+=l}return t}const V=t=>new Promise((a,l)=>{try{console.log(t);const i=K(t.email);console.log(i),window.Culqi.publicKey="pk_test_f4d42a7b5073e8df",window.Culqi.settings({title:"Sala Fabulosa",email:t.email,currency:"PEN",amount:t.amount*100,order:`${i}`}),console.log(window.Culqi.settings),window.Culqi.options({lang:"es",installments:!1,paymentMethods:{tarjeta:!0,yape:!0,bancaMovil:!0,agente:!0,billetera:!0,cuotealo:!0},style:{logo:"/assets/resources/logo.png",bannerColor:"#311609",buttonBackground:"#311609"}}),window.Culqi.open(),window.culqi=async function(){try{if(!window.Culqi.token){l("No se obtuvo un token de Culqi");return}const r=window.Culqi.token.id;console.log("âœ… Token generado:",r),t={...t,token:r,orderNumber:i},console.log("_request actualizado",t);const{status:c,result:n}=await f.Fetch("./api/pago",{method:"POST",body:JSON.stringify(t)});c||console.log((n==null?void 0:n.message)||"Error en el pago"),window.Culqi.close(),f.Notify.add({icon:"/assets/img/icon.svg",title:"Pago Exitoso",body:"El pago se procesÃ³ correctamente.",type:"success"}),a(n)}catch(r){f.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Pago",body:r.message,type:"danger"}),l(r.message||"Error en el pago")}},document.addEventListener("culqi.error",function(r){var c,n;f.Notify.add({icon:"/assets/img/icon.svg",title:"Error en Culqi",body:((c=r.detail)==null?void 0:c.message)||"Error desconocido",type:"danger"}),l(((n=r.detail)==null?void 0:n.message)||"Error desconocido")})}catch(i){f.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:i.message,type:"danger"}),l("Error en la integraciÃ³n con Culqi")}}),J=({title:t,description:a,selected:l,onSelect:i,disabled:r})=>e.jsxs("div",{className:`flex w-full items-center gap-3 p-4 border rounded-xl cursor-pointer transition-all duration-300 customtext-neutral-dark 
                }`,onClick:i,children:[e.jsx("div",{className:`w-5 h-5 border-2 rounded-full flex items-center justify-center ${l?"border-primary":""}`,children:l&&e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full"})}),e.jsx("div",{className:"customtext-neutral-light",children:e.jsx("h4",{className:"text-sm ",children:t})})]});function Q({cart:t,setSale:a,setCode:l,setDelivery:i,setCart:r,onContinue:c,noContinue:n,subTotal:o,igv:x,totalFinal:v,user:m,setEnvio:C,envio:q}){var T;const[h,b]=y.useState({name:(m==null?void 0:m.name)||"",lastname:(m==null?void 0:m.lastname)||"",email:(m==null?void 0:m.email)||"",department:"",province:"",district:"",address:"",number:"",comment:"",reference:"",ubigeo:null}),[E,F]=y.useState(!1),[g,S]=y.useState([]),[N,P]=y.useState(null),$=G.map(s=>({value:s.reniec,label:`${s.distrito}, ${s.provincia}, ${s.departamento}`,data:s})),O=async s=>{if(!s)return;const{data:d}=s;b(u=>({...u,department:d.departamento,province:d.provincia,district:d.distrito,ubigeo:d.reniec})),F(!0);try{const u=await _.getShippingCost({ubigeo:d.reniec}),j=[];u.data.is_free?(j.push({type:"free",price:0,description:u.data.standard.description,deliveryType:u.data.standard.type}),u.data.express.price>0&&j.push({type:"express",price:u.data.express.price,description:u.data.express.description,deliveryType:u.data.express.type})):j.push({type:"standard",price:u.data.standard.price,description:u.data.standard.description,deliveryType:u.data.standard.type}),S(j),P(j[0].type),C(j[0].price)}catch{f.Notify.add({icon:"/assets/img/icon.svg",title:"Sin cobertura",body:"No realizamos envÃ­os a esta ubicaciÃ³n",type:"danger"}),S([]),P(null),C(0)}F(!1)},M=async s=>{if(s.preventDefault(),!m){f.Notify.add({icon:"/assets/img/icon.svg",title:"Acceso requerido",body:"Debe iniciar sesiÃ³n para continuar",type:"danger"});return}if(["name","lastname","email","ubigeo","address","reference"].filter(j=>!h[j]).length>0){f.Notify.add({icon:"/assets/img/icon.svg",title:"Campos incompletos",body:"Complete todos los campos obligatorios",type:"danger"});return}if(!N){f.Notify.add({icon:"/assets/img/icon.svg",title:"Seleccione envÃ­o",body:"Debe elegir un mÃ©todo de envÃ­o",type:"danger"});return}try{const j={user_id:m.id,...h,fullname:`${h.name} ${h.lastname}`,country:"PerÃº",amount:v,delivery:q,cart:t},k=await V(j);k.data.status?(a(k.data.sale),i(k.data.delivery),l(k.data.code),r([]),c()):f.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el pago",body:k.data.message||"Pago rechazado",type:"danger"})}catch{f.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:"OcurriÃ³ un error al procesar el pedido",type:"danger"})}};return e.jsxs("div",{className:"grid lg:grid-cols-5 gap-8",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("form",{className:"space-y-6",onSubmit:s=>s.preventDefault(),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(w,{label:"Nombres",value:h.name,onChange:s=>b(d=>({...d,name:s.target.value})),required:!0}),e.jsx(w,{label:"Apellidos",value:h.lastname,onChange:s=>b(d=>({...d,lastname:s.target.value})),required:!0})]}),e.jsx(w,{label:"Correo electrÃ³nico",type:"email",value:h.email,onChange:s=>b(d=>({...d,email:s.target.value})),required:!0}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"UbicaciÃ³n de entrega"}),e.jsx(A,{options:$,onChange:O,placeholder:"Buscar distrito, provincia o departamento...",isSearchable:!0,isLoading:E,noOptionsMessage:()=>"No se encontraron ubicaciones",formatOptionLabel:({data:s})=>e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:s.distrito}),e.jsxs("div",{className:"text-gray-500",children:[s.provincia,", ",s.departamento]})]}),styles:{control:s=>({...s,border:"1px solid #e2e8f0",borderRadius:"0.375rem",padding:"2px"})}})]}),e.jsx(w,{label:"DirecciÃ³n",value:h.address,onChange:s=>b(d=>({...d,address:s.target.value})),required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(w,{label:"NÃºmero",value:h.number,onChange:s=>b(d=>({...d,number:s.target.value}))}),e.jsx(w,{label:"Referencia",value:h.reference,onChange:s=>b(d=>({...d,reference:s.target.value})),required:!0})]}),g.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"MÃ©todo de envÃ­o"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:g.map(s=>e.jsx(J,{title:s.type==="free"?"EnvÃ­o Gratis":s.type==="express"?"EnvÃ­o Express":"EnvÃ­o EstÃ¡ndar",price:s.price,description:s.description,selected:N===s.type,onSelect:()=>{P(s.type),C(s.price)}},s.type))}),N&&e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-800",children:(T=g.find(s=>s.type===N))==null?void 0:T.description}),N==="express"&&e.jsx("p",{className:"text-xs mt-2 text-blue-700",children:"Disponible para pedidos antes de las 1pm"})]})]})]})}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6",children:"Resumen"}),e.jsx("div",{className:"space-y-4 border-b-2 pb-6",children:t.map(s=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:`/storage/images/item/${s.image}`,alt:s.name,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Cantidad: ",s.quantity]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["S/ ",p(s.price)]})]})]},s.id))}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:["S/ ",p(o)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"IGV (18%):"}),e.jsxs("span",{children:["S/ ",p(x)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"EnvÃ­o:"}),e.jsxs("span",{children:["S/ ",p(q)]})]}),e.jsx("div",{className:"pt-4 border-t-2",children:e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["S/ ",p(v)]})]})}),e.jsx(D,{onClick:M,className:"w-full mt-6",children:"Pagar con Culqi"}),e.jsxs("p",{className:"text-xs text-gray-600 mt-4 text-center",children:["Al completar tu compra aceptas nuestros"," ",e.jsx("a",{href:"/terminos",className:"text-blue-600 hover:underline",children:"TÃ©rminos y Condiciones"})]})]})]})]})}function Y({cart:t,code:a,delivery:l}){const r=(t.reduce((o,x)=>{const v=x.final_price;return o+v*x.quantity},0)/1.18).toFixed(2),c=(r*.18).toFixed(2),n=parseFloat(r)+parseFloat(c)+parseFloat(l);return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-[20px] customtext-neutral-light",children:"Gracias por tu compra ðŸŽ‰"}),e.jsx("p",{className:"customtext-neutral-dark text-5xl font-semibold",children:"Tu orden ha sido recibida"}),e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:" customtext-neutral-light",children:"CÃ³digo de pedido"}),e.jsx("div",{className:"customtext-neutral-dark text-lg font-semibold",children:`#${a}`})]}),e.jsxs("div",{className:"space-y-4 max-w-lg bg-[#F7F9FB] mx-auto p-8 rounded-xl",children:[e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:t.map((o,x)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex   gap-4",children:[e.jsx("div",{className:"bg-white p-2 rounded-xl w-max",children:e.jsx("img",{src:`/storage/images/item/${o.image}`,alt:o.name,className:"w-20 h-20 object-cover rounded  "})}),e.jsxs("div",{className:" text-start",children:[e.jsx("h3",{className:"font-medium text-lg mb-2",children:o.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Marca: ",e.jsx("span",{className:"customtext-neutral-dark",children:o.brand.name})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad: ",e.jsxs("span",{className:"customtext-neutral-dark",children:[o.quantity," "]})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["SKU: ",e.jsx("span",{className:"customtext-neutral-dark",children:o.sku})]})]})]})},x))}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",p(r)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",p(c)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"EnvÃ­o"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",p(l)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",p(n)]})]})})]}),e.jsx("div",{className:"pt-3",children:e.jsx(D,{href:"/catalogo",children:"  Seguir Comprando"})})]})]})})})}function xe({cart:t,setCart:a,user:l}){const[i,r]=y.useState(1),n=(t.reduce((g,S)=>{const N=S.final_price;return g+N*S.quantity},0)/1.18).toFixed(2),o=(n*.18).toFixed(2),[x,v]=y.useState(0),m=parseFloat(n)+parseFloat(o)+parseFloat(x),[C,q]=y.useState([]),[h,b]=y.useState([]),[E,F]=y.useState([]);return y.useEffect(()=>{const g=document.createElement("script");return g.src="https://checkout.culqi.com/js/v4",g.async=!0,g.onload=()=>{console.log("âœ… Culqi cargado correctamente."),window.culqi=function(){window.Culqi.token?console.log("âœ… Token recibido:",window.Culqi.token.id):window.Culqi.order?console.log("âœ… Orden recibida:",window.Culqi.order):console.error("âŒ Error en Culqi:",window.Culqi.error)}},document.body.appendChild(g),()=>{document.body.removeChild(g)}},[]),e.jsx("div",{className:"min-h-screen bg-[#F7F9FB] py-12 px-primary 2xl:px-0 2xl:max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white   p-8 rounded-xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between max-w-3xl mx-auto",children:[e.jsx("div",{className:`text-sm ${i===1?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:"1. Carrito de compra"}),e.jsx("div",{className:`text-sm ${i===2?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:"2. Detalles de envÃ­o"}),e.jsx("div",{className:`text-sm ${i===3?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:"3. Orden confirmada"})]}),e.jsx("div",{className:"mt-4 h-1 max-w-3xl mx-auto bg-gray-200",children:e.jsx("div",{className:"h-1 bg-primary transition-all duration-500",style:{width:`${(i-1)/2*100}%`}})})]}),i===1&&e.jsx(U,{cart:t,setCart:a,onContinue:()=>r(2),subTotal:n,envio:x,igv:o,totalFinal:m}),i===2&&e.jsx(Q,{setCode:b,setDelivery:F,cart:t,setSale:q,setCart:a,onContinue:()=>r(3),noContinue:()=>r(1),subTotal:n,envio:x,setEnvio:v,igv:o,totalFinal:m,user:l}),i===3&&e.jsx(Y,{code:h,delivery:E,cart:C,subTotal:n,envio:x,igv:o,totalFinal:m})]})})}export{xe as default};
