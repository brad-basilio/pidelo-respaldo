import{j as e}from"./AboutHeader-COUW3Uy_.js";import{r as i}from"./index-CqkZ-sT_.js";import{C as R}from"./CardHoverBtn-CYD42p2B.js";import{I}from"./ItemsRest-DWisPxx6.js";import{c as L}from"./createLucideIcon-D0vxYqnu.js";import{C as u}from"./chevron-down-CxOx8ByU.js";import{S as j}from"./search-DhoFIDMi.js";import"./ProductCard-DppMoL6U.js";import"./main-CkMzf7wF.js";import"./___vite-browser-external_commonjs-proxy-DA7w84js.js";import"./BasicEditing-CqE15M_Q.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=L("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Z=new I,X=({items:y,data:h,filteredData:b,cart:N,setCart:w})=>{const{categories:g,brands:_,priceRanges:C}=b,[o,v]=i.useState({marca:!0,precio:!0,categoria:!0,colores:!1}),[n,d]=i.useState({category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[l,S]=i.useState([]),[P,f]=i.useState(!1),[q,F]=i.useState({currentPage:1,totalPages:1}),k=s=>{const a=[];if(s.category_id.length>0){const t=s.category_id.map(r=>["category_id","=",r]);a.push(["or",...t])}if(s.subcategory_id.length>0){const t=s.subcategory_id.map(r=>["subcategory_id","=",r]);a.push(["and",...t])}if(s.brand_id.length>0){const t=s.brand_id.map(r=>["brand_id","=",r]);a.push(["or",...t])}return s.price&&a.push(["and",[["final_price",">=",s.price.min],"and",["final_price","<=",s.price.max]]]),s.name&&a.push(["name","contains",s.name]),a},A=async(s=1)=>{f(!0);try{const t={filter:k(n),sort:n.sort},r=await Z.paginate(t);S(r.data),F({currentPage:r.currentPage,totalPages:r.lastPage})}catch(a){console.error("Error fetching products:",a)}finally{f(!1)}};i.useEffect(()=>{A()},[n]),i.useEffect(()=>{const s=new URLSearchParams(window.location.search),a=s.get("category");if(a){const r=g.find(c=>c.slug===a);r&&d(c=>({...c,category_id:[r.id]}))}const t=s.get("search");t&&d(r=>({...r,name:t}))},[y]);const m=(s,a)=>{d(t=>{if(s==="price")return{...t,price:t.price&&t.price.min===a.min&&t.price.max===a.max?null:a};const r=Array.isArray(t[s])?t[s]:[],c=r.includes(a)?r.filter(p=>p!==a):[...r,a];return{...t,[s]:c}})},x=s=>{v(a=>({...a,[s]:!a[s]}))},[$,B]=i.useState(""),[E,M]=i.useState("");return e.jsx("section",{className:"py-12 bg-[#F7F9FB]",children:e.jsxs("div",{className:"mx-auto px-primary",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 pb-4 border-b-2",children:[e.jsx("h2",{className:"text-4xl font-bold",children:h==null?void 0:h.title}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:["Productos seleccionados: ",e.jsx("strong",{children:l==null?void 0:l.length})]}),e.jsxs("select",{className:"border p-2 rounded",onChange:s=>{const[a,t]=s.target.value.split(":"),r=[{selector:a,desc:t==="desc"}];d(c=>({...c,sort:r}))},children:[e.jsx("option",{value:"created_at:desc",children:"Más reciente"}),e.jsx("option",{value:"created_at:asc",children:"Más antiguo"}),e.jsx("option",{value:"final_price:asc",children:"Precio: Menor a mayor"}),e.jsx("option",{value:"final_price:desc",children:"Precio: Mayor a menor"}),e.jsx("option",{value:"name:asc",children:"Nombre: A-Z"}),e.jsx("option",{value:"name:desc",children:"Nombre: Z-A"})]})]})]}),e.jsxs("div",{className:"relative flex gap-4",children:[e.jsxs("div",{className:"w-3/12 bg-white p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsx(V,{className:"h-5 w-5"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>x("marca"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Marca"}),e.jsx(u,{className:`h-5 w-5 transform transition-transform ${o.marca?"":"-rotate-180"}`})]}),o.marca&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-2 bg-gray-100 rounded-lg text-sm",value:$,onChange:s=>B(s.target.value)})]}),e.jsx("div",{className:"space-y-3",children:_.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>m("brand_id",s.id)}),e.jsx("span",{children:s.name})]},s.id))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>x("precio"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(u,{className:`h-5 w-5 transform transition-transform ${o.precio?"":"-rotate-180"}`})]}),o.precio&&e.jsx("div",{className:"space-y-3",children:C.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>m("price",s),checked:n.price&&n.price.min===s.min&&n.price.max===s.max}),e.jsx("span",{children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>x("categoria"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Categoría"}),e.jsx(u,{className:`h-5 w-5 transform transition-transform ${o.categoria?"":"-rotate-180"}`})]}),o.categoria&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-2 bg-gray-100 rounded-lg text-sm",value:E,onChange:s=>M(s.target.value)})]}),g.map(s=>{var a,t,r;return e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>m("category_id",s.id),checked:(a=n.category_id)==null?void 0:a.includes(s.id)}),e.jsx("span",{children:s.name})]}),((t=n.category_id)==null?void 0:t.includes(s.id))&&((r=s.subcategories)==null?void 0:r.length)>0&&e.jsx("ul",{className:"ml-6 mt-2 space-y-2",children:s.subcategories.map(c=>{var p;return e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>m("subcategory_id",c.id),checked:(p=n.subcategory_id)==null?void 0:p.includes(c.id)}),e.jsx("span",{children:c.name})]},c.id)})})]},s.id)})]})]}),e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-lg hover:brightness-90 transition-colors text-sm font-bold",children:"Aplicar Filtro"})]}),e.jsx("div",{className:"w-9/12 py-4",children:P?e.jsx("p",{children:"Cargando..."}):e.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:Array.isArray(l)&&l.length>0?l.map(s=>e.jsx(R,{product:s,widthClass:"lg:w-1/4",cart:N,setCart:w},s.id)):e.jsx("p",{children:"No hay productos que coincidan con los filtros seleccionados."})})})]})]})})};export{X as default};
