var Re=Object.defineProperty;var $e=(s,n,r)=>n in s?Re(s,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[n]=r;var D=(s,n,r)=>$e(s,typeof n!="symbol"?n+"":n,r);import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as c}from"./index-BH53Isel.js";import{c as Se}from"./ReactAppend-DTVVXReZ.js";import{C as Ee}from"./CreateReactScript-H8Uf0Xeb.js";import{i as T}from"./tippy-react.esm-BWiGTO87.js";import{m as _}from"./main-BSEyQEJW.js";import{B as xe}from"./ModalImportItem-BAoaR7zQ.js";import{S as ge}from"./SwitchFormGroup-DUGhyqoj.js";import{G as we}from"./Global-CklCDfn9.js";import{S as be}from"./SortByAfterField-BaS5rBg8.js";import{I as ye}from"./InputFormGroup-D5I6zpZc.js";import{T as Ce}from"./TextareaFormGroup-CdwdsTk2.js";import{M as de}from"./Modal-CIqmjseY.js";import{S as L}from"./SelectFormGroup-YqB1XVb8.js";import{S as Pe}from"./SetSelectValue-UxyCmHse.js";import{a as Fe,M as he}from"./MenuItemContainer-BkmzVQNY.js";import{G as Be}from"./GalleryRest-I9JAkJ4D.js";import"./index-yBjzXJbu.js";import"./index-fNjTmf9T.js";import"./index.esm-BE8-iLxT.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";/* empty css               *//* empty css              */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";import"./index-rimy3MAc.js";class ee extends xe{constructor(){super(...arguments);D(this,"path","admin/system");D(this,"savePage",async(r={})=>{try{const{status:i,result:l}=await _.Fetch(`/api/${this.path}/page`,{method:"POST",body:JSON.stringify(r)});if(!i)throw new Error((l==null?void 0:l.message)||"Ocurrio un error inesperado");return l.data??[]}catch(i){return _.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:i.message,type:"danger"}),null}});D(this,"updateOrder",async r=>{try{const{status:i,result:l}=await _.Fetch(`/api/${this.path}/order`,{method:"PATCH",body:JSON.stringify(r)});if(!i)throw new Error((l==null?void 0:l.message)??"Ocurrio un error inesperado");return!0}catch(i){_.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:i.message,type:"danger"})}});D(this,"deletePage",async r=>{try{const{status:i,result:l}=await _.Fetch(`/api/${this.path}/page/${r}`,{method:"DELETE"});if(!i)throw new Error((l==null?void 0:l.message)||"Ocurrio un error inesperado");return l.data??!0}catch(i){return _.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:i.message,type:"danger"}),!1}});D(this,"exportBK",async()=>{try{const{status:r,result:i}=await _.Fetch(`/api/${this.path}/backup`);if(!r)throw new Error((i==null?void 0:i.message)||"Ocurrio un error inesperado");return i}catch(r){return _.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:r.message,type:"danger"}),null}});D(this,"importBK",async r=>{try{const i=await fetch(`/api/${this.path}/backup`,{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(_.Cookies.get("XSRF-TOKEN"))},body:r}),l=JSON.parseable(await i.text());if(!i.ok)throw new Error((l==null?void 0:l.message)||"Ocurrio un error inesperado");return l??!0}catch(i){return _.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:i.message,type:"danger"}),null}});D(this,"hasRemoteChanges",async()=>await this.simpleGet(`/api/${this.path}/has-remote-changes`));D(this,"fetchRemoteChanges",async()=>await this.simpleGet(`/api/${this.path}/fetch-remote-changes`))}}const le=(s="")=>{s=s.replace(/[^a-zA-Z0-9_{}]/g,"");const n=/{([^}]+)}/g,r=[];let i;for(;(i=n.exec(s))!==null;)r.push(i[1]);return r},Me=(s,n)=>{const r=new RegExp(`[${n}]+$`,"g");return s.replace(r,"")},ie=new ee,Oe=s=>{const{id:n,name:r,path:i,extends_base:l=!1,menuable:x=!1,setPages:h,onSEOClicked:b,onParamsClicked:m}=s,[o,a]=c.useState(!1),[u,p]=c.useState(!1),[j,R]=c.useState(!1),[C,f]=c.useState(!1),g=async N=>{if(r===N.target.value)return a(!1);ie.savePage({id:n,name:N.target.value})&&(a(!1),h(P=>P.map(w=>w.id===n?{...w,name:N.target.value}:w)))},k=async N=>{if(i===N.target.value)return p(!1);const S=N.target.value;let P=structuredClone(S);const w=s.using??{};for(const M of le(S))P=P.replace(`{${M}}`,"").replace(`{${M}?}`,""),w[M]=w[M]??{model:null};const F=Me(P,"/");ie.savePage({id:n,path:S,pseudo_path:F,using:Object.keys(w).length>0?w:void 0})&&(p(!1),h(M=>M.map(O=>O.id===n?{...O,path:N.target.value}:O)))},A=async N=>{R(!0);const S=N.target.checked,P=ie.savePage({id:n,extends_base:S});R(!1),P&&h(w=>w.map(F=>F.id===n?{...F,extends_base:S}:F))},W=async N=>{f(!0);const S=N.target.checked,P=ie.savePage({id:n,menuable:S});f(!1),P&&h(w=>w.map(F=>F.id===n?{...F,menuable:S}:F))},V=async N=>{await ie.deletePage(N.id)&&(h(P=>P.filter(w=>w.id!=N.id)),$('[data-bs-toggle="tab"]').removeClass("active"),$(".tab-pane").removeClass("active"),$("#base-template-link").addClass("active"),$("#base-template").addClass("active"))},Y=le(i);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"dropdown float-end",children:[e.jsx("a",{href:"#",className:"dropdown-toggle arrow-none card-drop","data-bs-toggle":"dropdown","aria-expanded":"false",children:e.jsx("i",{className:"mdi mdi-dots-vertical"})}),e.jsxs("div",{className:"dropdown-menu dropdown-menu-end",children:[e.jsxs("button",{className:"dropdown-item",onClick:()=>b(s),children:[e.jsx("i",{className:"mdi mdi-cloud-search-outline me-1"}),"Editar SEO"]}),Y.length>0&&e.jsxs("button",{className:"dropdown-item",onClick:()=>m(s),children:[e.jsx("i",{className:"mdi mdi-code-braces me-1"}),"Parámetros"]}),e.jsx("div",{className:"dropdown-divider"}),e.jsxs("button",{className:"dropdown-item",onClick:()=>V(s),children:[e.jsx("i",{className:"mdi mdi-trash-can-outline me-1"}),"Eliminar página"]})]})]}),e.jsxs("div",{children:[o?e.jsx("input",{className:"form-control form-control-sm mb-1",defaultValue:r,onBlur:g,autoFocus:!0}):e.jsx(T,{content:"Editar nombre",placement:"left",children:e.jsx("h4",{className:"header-title mb-1 d-block",onClick:()=>a(!0),style:{minWidth:"200px",cursor:"pointer"},children:r||"Sin nombre"})}),u?e.jsx("input",{className:"form-control form-control-sm mb-1",defaultValue:i,style:{minHeight:27,fieldSizing:"content"},onBlur:k,autoFocus:!0}):e.jsx(T,{content:"Editar ruta",placement:"left",children:e.jsx("small",{className:"text-muted d-block mb-1",onClick:()=>p(!0),style:{minWidth:"200px",cursor:"pointer"},children:i||"Sin ruta"})})]}),e.jsxs("div",{className:"row",children:[e.jsx(ge,{label:"Extiende de base",col:"col-lg-6 col-md-12 col-sm-6",checked:l,onChange:A,disabled:j}),e.jsx(ge,{label:"Mostrar en menu",col:"col-lg-6 col-md-12 col-sm-6",checked:x,onChange:W,disabled:C})]})]})},Ie=new ee,De=({dataLoaded:s,setDataLoaded:n,modalRef:r})=>{const i=c.useRef(null),l=c.useRef(null),x=c.useRef(null),h=async b=>{b.preventDefault(),await Ie.savePage({id:s.id,description:l.current.value,keywords:$(x.current).val()})&&(n(null),$(r.current).modal("hide"))};return c.useEffect(()=>{i.current.value=`${s==null?void 0:s.name} | ${we.APP_NAME}`,l.current.value=(s==null?void 0:s.description)??"",Pe(x.current,(s==null?void 0:s.keywords)??[])},[s]),e.jsx(de,{modalRef:r,title:`Editar SEO - ${s==null?void 0:s.name}`,size:"sm",onSubmit:h,children:e.jsxs("div",{id:"seo-container",children:[e.jsx(ye,{eRef:i,label:"Título",disabled:!0}),e.jsx(Ce,{eRef:l,label:"Descripción",rows:2}),e.jsx(L,{eRef:x,label:"Palabras clave",tags:!0,multiple:!0,dropdownParent:"#seo-container"})]})})},je=({className:s,system:n,component:r,onComponentClicked:i,onDeleteClicked:l,onEditDataClicked:x})=>{var m;const h=(r==null?void 0:r.options)??[],b=h.find(o=>o.id==n.value);return e.jsxs("div",{className:`dropdown ${s}`,"data-id":n.id,children:[e.jsxs("div",{className:"btn btn-light dropdown-toggle text-truncate w-100 text-start",type:"button",id:`dd-${n.id}`,"data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true",children:[e.jsx("i",{className:"mdi mdi-chevron-down ms-1 float-end"}),e.jsxs("span",{className:"handle-sortable",style:{cursor:"move"},children:[e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("i",{className:"fa fa-ellipsis-v"})]}),e.jsx("span",{className:"ms-1",children:n.name})]}),e.jsxs("div",{className:"dropdown-menu","aria-labelledby":`dd-${n.id}`,"data-popper-placement":"bottom-start",children:[h.length>1&&e.jsxs(e.Fragment,{children:[h.filter(o=>o.id!=n.value).map(o=>e.jsxs("button",{className:"dropdown-item",onClick:()=>i({...n,name:`${r.name} - ${o.name}`,value:o.id}),children:[r.name," - ",o.name]})),e.jsx("div",{className:"dropdown-divider"})]}),(((m=b==null?void 0:b.using)==null?void 0:m.filters)||(b==null?void 0:b.data))&&e.jsxs("button",{className:"dropdown-item",onClick:()=>x(n,b),children:[e.jsx("i",{className:"mdi mdi-pencil me-1"}),"Configurar datos"]}),e.jsxs("button",{className:"dropdown-item",onClick:()=>l(n),children:[e.jsx("i",{className:"mdi mdi-trash-can-outline me-1"}),"Eliminar"]})]})]})},_e=({col:s,label:n,eRef:r,placeholder:i,required:l=!1,rows:x=3,value:h,onChange:b=()=>{}})=>{const[m,o]=c.useState(h),a=c.useRef(),u=c.useRef(null),p=r||a;return c.useEffect(()=>(u.current&&(u.current.toTextArea(),u.current=null),u.current=CodeMirror.fromTextArea(p.current,{mode:"htmlmixed",theme:"sode",indentUnit:2,tabSize:2}),u.current.setValue(h),setTimeout(()=>{u.current.refresh()},125),u.current.on("change",j=>{const R=j.getValue();o(R),b({target:{value:R}})}),()=>{u.current&&(u.current.toTextArea(),u.current=null)}),[p]),c.useEffect(()=>{m!==h&&(o(h),u.current&&(u.current.setValue(h),setTimeout(()=>{u.current.refresh()},125)))},[h]),e.jsxs("div",{className:`form-group ${s} mb-2`,children:[e.jsxs("label",{htmlFor:"",className:"mb-1",children:[n," ",l&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsx("textarea",{ref:p,className:"form-control",placeholder:i,required:l,rows:x,defaultValue:h,onChange:j=>o(j.target.value)})]})},ve=new ee,Te=({dataLoaded:s,setDataLoaded:n,setSystems:r,modalRef:i})=>{var u,p,j,R,C,f,g,k,A,W,V,Y,N,S,P,w,F,K,M,O,se,te;const[l,x]=c.useState((s==null?void 0:s.data)||{}),[h,b]=c.useState([]),m={};m.model=c.useRef(null),m.filters=c.useRef(null),m.filtersMethod=c.useRef(null);const o=async d=>{var E,z;d.preventDefault();const B=await ve.save({id:s.id,data:l,filters:$(m.filters.current).val(),filters_method:(z=(E=s==null?void 0:s.component)==null?void 0:E.using)==null?void 0:z["filters:method"],filters_method_values:$(m.filtersMethod.current).val()});B&&(n(null),$(i.current).modal("hide"),r(Z=>Z.map(J=>J.id==s.id?B.data:J)))};c.useEffect(()=>{var z,Z,J,ae,ce,ne,oe;const d={};(z=s==null?void 0:s.component)==null||z.data.forEach(Q=>{var me;d[Q]=((me=s==null?void 0:s.data)==null?void 0:me[Q])??""}),x(d),m.model.current.value=((J=(Z=s==null?void 0:s.component)==null?void 0:Z.using)==null?void 0:J.model)??"",$(m.filters.current).val((s==null?void 0:s.filters)??[]).trigger("change"),$(m.filtersMethod.current).val((s==null?void 0:s.filtersMethod)??[]).trigger("change");const B=(ce=(ae=s==null?void 0:s.component)==null?void 0:ae.using)==null?void 0:ce.model,E=(oe=(ne=s==null?void 0:s.component)==null?void 0:ne.using)==null?void 0:oe["filters:method"];!B||!E||ve.simpleGet(`/api/admin/system/related/${B}/${E}`).then(Q=>{b(Q)})},[s]);const a=(d,B)=>{x({...l,[d]:B})};return console.log(l),e.jsxs(de,{modalRef:i,title:s==null?void 0:s.name,onSubmit:o,size:(p=(u=s==null?void 0:s.component)==null?void 0:u.data)!=null&&p.some(d=>d.startsWith("code:"))?"lg":"md",children:[e.jsxs("ul",{className:"nav nav-tabs nav-bordered",children:[e.jsx("li",{className:"nav-item",hidden:!((R=(j=s==null?void 0:s.component)==null?void 0:j.data)!=null&&R.length),children:e.jsx("a",{href:"#tab-info","data-bs-toggle":"tab","aria-expanded":"true",className:"nav-link active",children:"Información"})}),e.jsx("li",{className:"nav-item",hidden:!((f=(C=s==null?void 0:s.component)==null?void 0:C.using)!=null&&f.filters)&&!((k=(g=s==null?void 0:s.component)==null?void 0:g.using)!=null&&k["filters:method"]),children:e.jsx("a",{href:"#tab-db","data-bs-toggle":"tab","aria-expanded":"true",className:"nav-link",children:"Base de datos"})})]}),e.jsxs("div",{className:"tab-content",id:"data-modal-container",children:[e.jsx("div",{className:"tab-pane active",id:"tab-info",hidden:!((W=(A=s==null?void 0:s.component)==null?void 0:A.data)!=null&&W.length),children:(Y=(V=s==null?void 0:s.component)==null?void 0:V.data)==null?void 0:Y.map((d,B)=>d.startsWith("code:")?e.jsx(_e,{label:d.replace("code:",""),value:l[d]??"",rows:1,onChange:E=>x({...l,[d]:E.target.value})},B):e.jsx(e.Fragment,{children:d.startsWith("bool:")?e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:d.replace("bool:","")}),e.jsxs("div",{children:[e.jsxs("div",{className:"form-check form-check-inline",children:[e.jsx("input",{type:"radio",className:"form-check-input",id:`${d}-true`,name:d,value:"true",checked:l[d]===!0,onChange:E=>a(d,E.target.value==="true")}),e.jsx("label",{className:"form-check-label",htmlFor:`${d}-true`,children:"Sí"})]}),e.jsxs("div",{className:"form-check form-check-inline",children:[e.jsx("input",{type:"radio",className:"form-check-input",id:`${d}-false`,name:d,value:"false",checked:l[d]===!1,onChange:E=>a(d,E.target.value==="true")}),e.jsx("label",{className:"form-check-label",htmlFor:`${d}-false`,children:"No"})]})]})]}):e.jsx(Ce,{label:d,value:l[d]??"",rows:1,onChange:E=>x({...l,[d]:E.target.value})},B)}))}),e.jsxs("div",{className:"tab-pane show",id:"tab-db",children:[e.jsx(ye,{eRef:m.model,label:"Modelo",disabled:!0}),e.jsx(L,{eRef:m.filters,label:"Filtros",multiple:!0,dropdownParent:"#tab-db",hidden:!((S=(N=s==null?void 0:s.component)==null?void 0:N.using)!=null&&S.filters),children:(F=(w=(P=s==null?void 0:s.component)==null?void 0:P.using)==null?void 0:w.filters)==null?void 0:F.map((d,B)=>e.jsx("option",{value:d,children:d},B))}),e.jsx("div",{hidden:!((M=(K=s==null?void 0:s.component)==null?void 0:K.using)!=null&&M["filters:method"]),children:e.jsx(L,{eRef:m.filtersMethod,label:(te=(se=(O=s==null?void 0:s.component)==null?void 0:O.using)==null?void 0:se["filters:method"])==null?void 0:te.toTitleCase(),multiple:!0,dropdownParent:"#tab-db",changeWith:[h],children:h==null?void 0:h.map(d=>e.jsx("option",{value:d.id,children:d.name},d.id))})})]})]})]})},Ne=new ee,Ae=({components:s,onClick:n})=>e.jsx("div",{className:"left-side-menu top-0 pt-2",children:e.jsxs("div",{"data-simplebar":!0,className:"h-100",children:[e.jsx("div",{id:"sidebar-menu",className:"show",children:e.jsxs("ul",{id:"side-menu",children:[e.jsx("li",{className:"menu-title",children:"Lista de componentes"}),s.filter(r=>r.options.length>0).map((r,i)=>e.jsx(Fe,{title:r.name,icon:r.icon,children:r.options.map((l,x)=>e.jsx(he,{name:l.name,icon:l.icon,onClick:()=>{const h=$(".tab-pane:visible .components-container > div").last().data("id");n({name:`${r.name} - ${l.name}`,component:r.id,value:l.id,after_component:h})},children:l.name},x))},i)),e.jsx("li",{className:"menu-title",children:"Sistema de respaldo"}),e.jsx(he,{icon:"mdi mdi-cogs",rightBarToggle:!0,children:"Configuraciones"}),e.jsx(he,{icon:"mdi mdi-cloud-download",onClick:async()=>{const r=await Ne.exportBK(),i=new Blob([JSON.stringify(r)],{type:"application/json"}),l=URL.createObjectURL(i),x=document.createElement("a");x.href=l,x.download="backup.json",document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(l)},children:"Exportar Backup"}),e.jsx("input",{type:"file",id:"file-input",accept:"application/json",style:{display:"none"},onChange:async r=>{const i=r.target.files[0];if(r.target.value=null,i){const l=new FormData;if(l.append("backup",i),!await Ne.importBK(l))return;location.reload()}}}),e.jsx(he,{icon:"mdi mdi-backup-restore",onClick:()=>{document.getElementById("file-input").click()},children:"Importar Backup"})]})}),e.jsx("div",{className:"clearfix"})]})}),Ve=({page:s,param:n,models:r,setUsing:i,setPages:l})=>{var j,R,C;const x=c.useRef(),h=c.useRef(),b=c.useRef(),m=s==null?void 0:s.using,[o,a]=c.useState(null),u=f=>{const g=x.current.value,k=r.find(A=>A.name==g)??null;a(k)};c.useEffect(()=>{var f;$(x.current).val((f=m==null?void 0:m[n])==null?void 0:f.model).trigger("change")},[n]),c.useEffect(()=>{var f,g;i(k=>({...k,[n]:{...k[n],model:(o==null?void 0:o.name)??null}})),$(h.current).val(((f=m==null?void 0:m[n])==null?void 0:f.field)??null).trigger("change"),$(b.current).val(((g=m==null?void 0:m[n])==null?void 0:g.relations)??[]).trigger("change")},[o]);const p=`${n}-container`;return e.jsxs("div",{id:p,className:"row",children:[e.jsxs("label",{className:"form-label",children:["Parámetro ",e.jsx("code",{children:n})]}),e.jsx(L,{eRef:x,label:"Modelo",col:"col-md-6",dropdownParent:`#${p}`,onChange:u,children:r.map((f,g)=>e.jsx("option",{value:f.name,children:f.name},g))}),e.jsx(L,{eRef:h,label:"Campo",col:"col-md-6",dropdownParent:`#${p}`,onChange:f=>{i(g=>({...g,[n]:{...g[n],field:f.target.value}}))},children:(j=o==null?void 0:o.fields)==null?void 0:j.map((f,g)=>e.jsx("option",{children:f},g))}),e.jsx("div",{hidden:(((R=o==null?void 0:o.relations)==null?void 0:R.length)??0)==0,children:e.jsx(L,{eRef:b,label:"Relaciones",multiple:!0,dropdownParent:`#${p}`,onChange:f=>{const g=$(f.target).val();i(k=>({...k,[n]:{...k[n],relations:g}}))},children:(C=o==null?void 0:o.relations)==null?void 0:C.map((f,g)=>e.jsx("option",{children:f},g))})})]})},Ge=new ee,ze=({dataLoaded:s,setDataLoaded:n,setPages:r,modalRef:i,models:l})=>{const x=le((s==null?void 0:s.path)??""),[h,b]=c.useState({}),m=async o=>{o.preventDefault();const a=await Ge.savePage({id:s.id,using:h});a&&(n(null),r(a),$(i.current).modal("hide"))};return c.useEffect(()=>{b((s==null?void 0:s.using)??{})},[s]),e.jsx(de,{modalRef:i,title:`Editar parámetros de URL - ${s==null?void 0:s.name}`,onSubmit:m,onClose:()=>n(null),children:x.map((o,a)=>e.jsx(Ve,{page:s,param:o,models:l,using:h,setUsing:b,setPages:r},a))})};class Ue extends xe{constructor(){super(...arguments);D(this,"path","admin/colors")}}class He extends xe{constructor(){super(...arguments);D(this,"path","admin/settings")}}const We=new Be,Ke=new Ue,Je=new He,Xe=({colors:s,setColors:n,settings:r,setSettings:i})=>{const[l,x]=c.useState([{uuid:crypto.randomUUID(),col:"col-3",name:"Icon (1:1)",src:"icon.png",width:"100%",aspectRatio:1},{uuid:crypto.randomUUID(),col:"col-5",name:"Logo (13:4)",src:"logo.png",width:"100%",aspectRatio:3.25},{uuid:crypto.randomUUID(),col:"col-4",name:"Logo footer (1:1)",src:"logo-footer.png",width:"100%",aspectRatio:1}]),h=async a=>{var C;const u=((C=a.target.files)==null?void 0:C[0])??null;if(!u)return;a.target.value=null;const p=a.target.name,j=new FormData;j.append("image",u),j.append("name",p),await We.save(j)&&x(f=>f.map(g=>(g.src==p&&(g.uuid=crypto.randomUUID()),g)))},b=async a=>{const u=a.target.getAttribute("data-color-id"),p=a.target.name,j=a.target.value;if(s.find(f=>f.id==u)[p]===j)return;const C=await Ke.save({id:u,[p]:j});C&&n(f=>f.map(g=>g.id==u?C.data:g))},m=async a=>{var f;const u=a.target.getAttribute("data-id"),p=a.target.name;let j=a.target.value;if(a.target.type=="checkbox"&&(j=a.target.checked?"true":"false"),(((f=r.find(g=>g.name==p))==null?void 0:f.description)??"")===j)return;const C=await Je.save({name:p,value:j});C&&i(g=>g.map(k=>k.id==u?C.data:k))},o=a=>{const u=r.find(p=>p.name==a);return u?u.value:""};return e.jsx("div",{className:"right-bar",children:e.jsxs("div",{"data-simplebar":!0,className:"h-100",children:[e.jsxs("div",{className:"rightbar-title",children:[e.jsx("a",{href:"#",className:"right-bar-toggle float-end",children:e.jsx("i",{className:"mdi mdi-close"})}),e.jsx("h4",{className:"font-16 m-0 text-white",children:"Configuraciones"})]}),e.jsxs("div",{className:"p-2",children:[e.jsx("h5",{children:"Imágenes principales"}),e.jsx("div",{className:"row",children:l.map((a,u)=>{const p="file-"+a.uuid;return e.jsxs("div",{className:a.col,children:[e.jsx("input",{id:p,name:a.src,type:"file",accept:"image/png",hidden:!0,onChange:h}),e.jsx("label",{htmlFor:p,className:"form-label d-block mb-1",style:{cursor:"pointer"},children:a.name}),e.jsx("label",{htmlFor:p,style:{cursor:"pointer"},className:"w-100",children:e.jsx("img",{className:"border",src:`/assets/resources/${a.src}?v=${a.uuid}`,alt:"",style:{height:a.height,width:a.width,objectFit:"contain",objectPosition:"center",backgroundColor:"#f5f5f5",borderRadius:"4px",aspectRatio:a.aspectRatio}})})]},u)})}),e.jsx("hr",{className:"my-2"}),e.jsx("h5",{children:"Fuentes del sistema"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"",className:"form-label mb-1",children:"Titulos"}),e.jsx(T,{content:"Nombre de la fuente",children:e.jsx("input",{type:"text",className:"form-control form-control-sm mb-1",name:"title-font-name",defaultValue:o("title-font-name"),onBlur:m})}),e.jsx(T,{content:"Enlace de la fuente",children:e.jsx("textarea",{className:"form-control form-control-sm",rows:1,name:"title-font-url",defaultValue:o("title-font-url"),onBlur:m,style:{minHeight:27,fieldSizing:"content"}})}),e.jsx(T,{content:"Marcar si el archivo es un archivo de fuente (otf, woff, woff2, etc)",children:e.jsxs("div",{className:"form-check mt-1",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",name:"title-font-source",id:"title-font-source",defaultChecked:o("title-font-source")=="true",onBlur:m}),e.jsx("label",{className:"form-check-label",htmlFor:"title-font-source",children:"¿Es este un archivo de fuente?"})]})})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"",className:"form-label mb-1",children:"Parrafos"}),e.jsx(T,{content:"Nombre de la fuente",children:e.jsx("input",{type:"text",className:"form-control form-control-sm mb-1",name:"paragraph-font-name",defaultValue:o("paragraph-font-name"),onBlur:m})}),e.jsx(T,{content:"Enlace de la fuente",children:e.jsx("textarea",{className:"form-control form-control-sm",rows:1,name:"paragraph-font-url",defaultValue:o("paragraph-font-url"),onBlur:m,style:{minHeight:27,fieldSizing:"content"}})}),e.jsx(T,{content:"Marcar si el archivo es un archivo de fuente (otf, woff, woff2, etc)",children:e.jsxs("div",{className:"form-check mt-1",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",name:"paragraph-font-source",id:"paragraph-font-source",defaultChecked:o("paragraph-font-source")=="true",onBlur:m}),e.jsx("label",{className:"form-check-label",htmlFor:"paragraph-font-source",children:"¿Es este un archivo de fuente?"})]})})]}),e.jsx("hr",{className:"my-2"}),e.jsx("h5",{children:"Colores del sistema"}),e.jsx("div",{className:"d-flex flex-column gap-1",children:s.map((a,u)=>e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("span",{className:"input-group-text px-1",children:e.jsx("input",{type:"color",name:"description","data-color-id":a.id,className:"p-0",style:{width:"20px",height:"20px",border:"1px solid #ced4da",borderRadius:"4px",cursor:"pointer"},defaultValue:a.description,onBlur:b})}),e.jsx("input",{type:"text",name:"name","data-color-id":a.id,className:"form-control form-control-sm",placeholder:"Color",defaultValue:a.name,onBlur:b,disabled:a.name=="primary",style:{cursor:a.name=="primary"?"not-allowed":"text"}})]},u))})]})]})})},q=new ee,Ye=({systems:s=[],pages:n=[],colors:r=[],components:i,models:l,settings:x=[]})=>{const h=c.useRef(null),b=c.useRef(null),m=c.useRef(null),o=c.useRef(null),[a,u]=c.useState(s),[p,j]=c.useState(n),[R,C]=c.useState(r),[f,g]=c.useState(x),[k,A]=c.useState(!1),[W,V]=c.useState(null),[Y,N]=c.useState(null),[S,P]=c.useState(!1),[w,F]=c.useState(!1),[K,M]=c.useState(null),[O,se]=c.useState(!1),[te,d]=c.useState(0),B=async()=>{A(!0);const t=await q.savePage();t&&(A(!1),j(t))},E=async t=>{const v=$(".tab-pane:visible").data("id")??null;t.page_id=v;const I=await q.save(t);if(!I)return;const U=I.data;u(H=>H.some(G=>G.id===U.id)?H.map(G=>G.id===U.id?U:G):[...H,U])},z=async t=>{await q.delete(t.id)&&u(v=>v.filter(I=>I.id!=t.id))},Z=async()=>{se(!0);const t=await q.fetchRemoteChanges();se(!1),t&&location.reload()},J=t=>{const y=$(t.target).data("page-id"),v=$(t.target).data("page-path"),I=$(t.target).val();$(`#iframe-${y}`).removeAttr("src"),$(`#iframe-${y}`).attr("src",`${v}/${I}`)},ae=async t=>{V(t),$(h.current).modal("show")},ce=async t=>{V(t),$(b.current).modal("show")},ne=async(t,y)=>{N({...t,component:y}),$(o.current).modal("show")};c.useEffect(()=>{let t=null;const y=async()=>{if(O)return;if(S){clearInterval(t);return}const v=await q.hasRemoteChanges();if(!v){P(!0);return}F(v.has_changes),M(v.last_commit),d(v.commits)};return t=setInterval(async()=>{await y()},1e4),()=>clearInterval(t)},[S,O]),c.useEffect(()=>{const t=$("iframe:visible");t&&($(t).removeAttr("src"),$(t).attr("src",t.data("path")))},[a,R,f]),c.useEffect(()=>{[...$(".components-container")].forEach(y=>{$(y).sortable({connectWith:".components-container",handle:".handle-sortable",forcePlaceholderSize:!0,update:async function(v,I){const U=[...$(y).children()],H={};if(U.forEach(ue=>{const G=$(ue).data("id"),X=$(ue).prev().data("id")??null,re=a.find(fe=>fe.id==G);(re==null?void 0:re.after_component)!==X&&(H[G]=X)}),Object.keys(H).length>0){if(!await q.updateOrder(H))return;u(G=>{const X=[...G];return Object.entries(H).forEach(([re,fe])=>{const pe=X.findIndex(ke=>ke.id==re);pe!==-1&&(X[pe]={...X[pe],after_component:fe})}),X})}}}).disableSelection()})},[p,a]),c.useEffect(()=>{document.title=`Sistema | ${we.APP_NAME}`},[null]);const[oe,Q,me]=(K==null?void 0:K.split(`
`))??[];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"wrapper position-relative",children:[e.jsx(Ae,{components:i,onClick:E}),e.jsx("div",{className:"content-page mt-2 pb-3",style:{height:"max-content"},children:e.jsx("div",{className:"content mt-2",children:e.jsxs("div",{className:"container-fluid",children:[e.jsx("button",{className:"button-menu-mobile d-lg-none d-md-block position-absolute ",style:{zIndex:1,border:"none",borderRadius:"0 50% 50% 0",backgroundColor:"#fff",color:"#343a40",top:"50%",left:"0",transform:"translateY(-50%)",padding:"24px 0px 20px 6px ",fontWeight:"bold"},children:"〉"}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card mb-0",children:e.jsxs("div",{className:"card-body",style:{height:"calc(100vh - 48px)"},children:[e.jsxs("ul",{className:"nav nav-tabs nav-bordered flex-nowrap",style:{overflowX:"auto",overflowY:"hidden"},children:[e.jsx("li",{className:"nav-item",children:e.jsx("a",{id:"base-template-link",href:"#base-template","data-bs-toggle":"tab","aria-expanded":"false",className:"nav-link active h-100",children:"Base"})}),p.map((t,y)=>e.jsx("li",{className:"nav-item",children:e.jsxs("a",{href:`#page-${t.id}`,"data-bs-toggle":"tab","aria-expanded":"false",className:"nav-link h-100",style:{whiteSpace:"nowrap"},children:[t.name,e.jsx("small",{className:"d-block text-muted",style:{fontWeight:"normal"},children:t.path})]})},y)),e.jsx("li",{className:"nav-item d-flex justify-content-center align-items-center px-2",children:e.jsx(T,{content:"Agregar página",children:e.jsx("button",{className:"nav-link btn btn-xs btn-white rounded-pill",onClick:B,disabled:k,children:k?e.jsx("i",{className:"mdi mdi-loading mdi-spin"}):e.jsx("i",{className:"mdi mdi-plus"})})})})]}),e.jsxs("div",{className:"tab-content",children:[e.jsx("div",{className:"tab-pane active",id:"base-template",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"d-flex flex-column gap-2 components-container","data-page-id":null,children:be(a).filter(t=>t.page_id==null).map(t=>{const y=i.find(v=>v.id==t.component);if(y==null||y.options,t.component=="content")return e.jsxs("button",{"data-id":t.id,className:"btn btn-light text-truncate w-100 text-start",type:"button",children:[e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("span",{className:"ms-1",children:t.name})]},t.id);{const v=i.find(I=>I.id==t.component);return e.jsx(je,{className:"",system:t,component:v,onComponentClicked:E,onDeleteClicked:z,onEditDataClicked:ne},t.id)}})})}),e.jsx("div",{className:"col-md-8",children:e.jsx("iframe",{src:"/base-template","data-path":"/base-template",className:"w-100 h-100 border",style:{minHeight:"calc(100vh - 200px)",borderRadius:"4px"}})})]})}),p.map((t,y)=>e.jsx("div",{className:"tab-pane",id:`page-${t.id}`,"data-id":t.id,children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx(Oe,{...t,models:l,setPages:j,onSEOClicked:ae,onParamsClicked:ce}),e.jsx("hr",{className:"my-2"}),e.jsx("div",{className:"d-flex flex-column gap-2 components-container","data-page-id":t.id,children:be(a).filter(v=>v.page_id==t.id).map(v=>{const I=i.find(U=>U.id==v.component);return e.jsx(je,{className:"",system:v,component:I,onComponentClicked:E,onDeleteClicked:z,onEditDataClicked:ne},v.id)})})]}),e.jsxs("div",{className:"col-md-8",children:[e.jsxs("div",{className:"input-group mb-2",children:[e.jsxs("span",{className:"input-group-text",children:[(t==null?void 0:t.pseudo_path)||t.path,le(t==null?void 0:t.path).length>0&&"/"]}),le(t==null?void 0:t.path).length>0&&e.jsx("input",{type:"text",className:"form-control",placeholder:"Parametros","data-page-path":t.pseudo_path,"data-page-id":t.id,onChange:J})]}),e.jsx("iframe",{id:`iframe-${t.id}`,src:(t==null?void 0:t.pseudo_path)||t.path,"data-path":(t==null?void 0:t.pseudo_path)||t.path,className:"w-100 h-100 border",style:{minHeight:"calc(100vh - 302px)",borderRadius:"4px"}})]})]})},y))]})]})})})})]})})}),w&&e.jsx(T,{content:`Tienes ${te} cambios sin sincronizar`,children:e.jsxs("button",{className:"btn btn-dark p-0 position-absolute rounded-pill",style:{right:"20px",bottom:"20px",height:"40px",width:"40px"},onClick:()=>$(m.current).modal("show"),children:[e.jsx("small",{className:"position-absolute",style:{backgroundColor:"#ff5b5b",borderRadius:"50%",width:"18px",height:"18px",top:"-5px",left:"-5px"},children:te}),e.jsx("i",{className:"mdi mdi-github mdi-24px"})]})})]}),e.jsx(de,{modalRef:m,title:"Cambios de Github",size:"sm",hideFooter:!0,children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"mdi mdi-github mdi-48px"}),e.jsx("h5",{className:"mt-2",children:"Tienes cambios sin sincronizar"}),e.jsxs("div",{className:"mb-2 py-2",children:[e.jsx("b",{className:"d-block",children:oe}),e.jsx("small",{className:"d-block text-muted",children:moment(Q).fromNow()}),e.jsxs("span",{className:"d-block",children:["Commit: ",me]})]}),e.jsx("button",{className:"btn btn-primary mb-2",type:"button",onClick:()=>Z(),disabled:O,children:O?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-loading mdi-spin me-1"}),"Sincronizando"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-cloud-download me-1"}),"Sincronizar"]})})]})}),e.jsx(Xe,{colors:R,setColors:C,settings:f,setSettings:g}),e.jsx(De,{dataLoaded:W,setDataLoaded:V,modalRef:h}),e.jsx(ze,{dataLoaded:W,setDataLoaded:V,setPages:j,modalRef:b,models:l}),e.jsx(Te,{dataLoaded:Y,setDataLoaded:N,setSystems:u,modalRef:o})]})};Ee((s,n)=>{Se.createRoot(s).render(e.jsx(Ye,{...n}))});
