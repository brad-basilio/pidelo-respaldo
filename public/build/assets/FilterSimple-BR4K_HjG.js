import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as l}from"./index-BH53Isel.js";import{u as B,S as J,_ as L}from"./Select-aab027f3.esm-kGkkFbxE.js";import"./index-rimy3MAc.js";import{I as $}from"./ItemsRest-DBSKIEqF.js";import{A as F,F as k}from"./ArrayJoin-D8pAQiSC.js";import{P as M}from"./ProductCard-CuDzCVRt.js";import"./index-yBjzXJbu.js";import"./hoist-non-react-statics.cjs-kbdZbs82.js";import"./index-fNjTmf9T.js";import"./main-BSEyQEJW.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./BasicRest-DEv02zgs.js";import"./Number2Currency-e57Tgsuk.js";import"./tippy-react.esm-BWiGTO87.js";import"./ProductCard-C2H10lUi.js";var z=l.forwardRef(function(s,n){var o=B(s);return l.createElement(J,L({ref:n},o))}),D=z;const G=new $,v=({summary:s,keyName:n,field:o,otherField:p,title:b,onChange:N,filter:a})=>{var u;if((s[n]??[]).length==0)return;const d=a.find(i=>i.field==o);return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-2"}),e.jsxs("div",{children:[e.jsx("b",{className:"mb-1 block",children:b}),e.jsx("div",{className:"flex flex-wrap gap-x-2 gap-y-1",children:(u=s[n])==null?void 0:u.map((i,m)=>{var g;const y=(g=d==null?void 0:d.values)==null?void 0:g.includes(i.id);return e.jsxs("label",{className:"cursor-pointer border rounded-lg py-1 px-2 text-sm",children:[e.jsx("input",{className:"me-1 cursor-pointer",type:"checkbox",name:o,value:i.id,"other-field":p,"other-field-value":i[p],onChange:N,checked:y}),e.jsx("span",{children:i.name})]},m)})})]})]})},oe=({data:s,category:n,subcategory:o,cart:p,setCart:b})=>{const N=["category_id","subcategory_id","brand_id","item_tag.tag_id"],[a,d]=l.useState(N.map(t=>{const r=[];return t=="category_id"&&n&&r.push(n.id),t=="subcategory_id"&&o&&r.push(o.id),{field:t,values:r}})),[u,i]=l.useState([]),[m,y]=l.useState({value:"asc",label:e.jsxs(e.Fragment,{children:["Menor a mayor ",e.jsx("i",{className:"mdi mdi-arrow-up"})]})}),[g,P]=l.useState(0),[w,I]=l.useState(1),[x,S]=l.useState(1),[h,A]=l.useState({}),[E,_]=l.useState(!1);l.useEffect(()=>{R()},[a,m,x]);const f=({target:t})=>{const r=t.name,j=t.value,C=t.checked,T=t.getAttribute("other-field"),O=t.getAttribute("other-field-value");d(V=>V.map(c=>(c.field==r&&(C?c.values.push(j):c.values=c.values.filter(q=>q!=j)),c.field==T&&C&&c.values.push(O),c)))},R=async()=>{_(!0),i([]);const t=await G.paginate({filter:F(a.map(r=>{if(r.values.length!=0)return F(r.values.map(j=>[r.field,"=",j]),"or")}).filter(Boolean),"and"),take:12,skip:12*(x-1),requireTotalCount:!0,sort:[{selector:"final_price",desc:m.value=="desc"},{selector:"discount_percent",desc:m.value!="desc"}]});t.status&&(i(t.data??[]),P(t.totalCount),I(Math.ceil(t.totalCount/12)),A(t.summary),_(!1))};return e.jsx("section",{className:"bg-white",children:e.jsxs("div",{className:"px-[5%] replace-max-w-here w-full mx-auto px-4 py-[5%] md:py-[2.5%]",children:[((s==null?void 0:s.title)||(s==null?void 0:s.description))&&e.jsxs("div",{className:"mb-[2%]",children:[(s==null?void 0:s.title)&&e.jsx("h1",{className:"text-2xl font-bold mb-[2%]",children:s==null?void 0:s.title}),(s==null?void 0:s.description)&&e.jsx("p",{className:"text-sm mb-[3%]",children:s==null?void 0:s.description})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5",children:[e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"shadow-lg border h-max sticky top-4 p-4 rounded-3xl",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Filtros de items"}),e.jsx(v,{filter:a,keyName:"categories",title:"Categoria",field:"category_id",summary:h,onChange:f}),e.jsx(v,{filter:a,keyName:"subcategories",title:"Subcategoria",field:"subcategory_id",otherField:"category_id",summary:h,onChange:f}),e.jsx(v,{filter:a,keyName:"brands",title:"Marca",field:"brand_id",summary:h,onChange:f}),e.jsx(v,{filter:a,keyName:"tags",title:"Tags",field:"item_tag.tag_id",summary:h,onChange:f}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{children:[e.jsx("b",{className:"mb-1 block",children:"Ordenar precio"}),e.jsx(D,{className:"text-sm",options:[{value:"asc",label:e.jsxs(e.Fragment,{children:["Menor a mayor"," ",e.jsx("i",{className:"mdi mdi-arrow-up"})]})},{value:"desc",label:e.jsxs(e.Fragment,{children:["Mayor a menor"," ",e.jsx("i",{className:"mdi mdi-arrow-down"})]})}],defaultValue:m,onChange:t=>y(t)})]})]})}),e.jsxs("div",{className:"w-full md:col-span-2 lg:col-span-3",children:[e.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5 mb-[2.5%] items-center justify-between",children:[e.jsxs("div",{className:"",children:["Mostrando ",e.jsx("b",{children:u.length})," items de"," ",e.jsx("b",{children:g})]}),e.jsxs("div",{className:"lg:col-span-2 flex justify-between w-full",children:[e.jsx("div",{className:"mx-auto"}),e.jsx(k,{pages:w,current:x,setCurrent:S})]})]}),e.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5",children:[u.map((t,r)=>e.jsx(M,{data:s,item:t,cart:p,setCart:b},r)),E&&[null,null,null].map(t=>e.jsx(M,{}))]}),e.jsx("div",{className:"mt-[5%] w-max max-w-full mx-auto",children:e.jsx(k,{pages:w,current:x,setCurrent:S})})]})]})]})})};export{oe as default};
