import{j as e}from"./AboutHeader-COUW3Uy_.js";import{r as n}from"./index-CqkZ-sT_.js";import{C as R}from"./CardHoverBtn-CYD42p2B.js";import{I}from"./ItemsRest-CA_6SdLr.js";import{c as L}from"./createLucideIcon-D0vxYqnu.js";import{C as h}from"./chevron-down-CxOx8ByU.js";import{S as f}from"./search-DhoFIDMi.js";import"./ProductCard-DppMoL6U.js";import"./main-CkMzf7wF.js";import"./___vite-browser-external_commonjs-proxy-DA7w84js.js";import"./BasicEditing-BqNQNO7h.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=L("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Z=new I,X=({items:q,data:m,filteredData:b,cart:y,setCart:N})=>{const{categories:u,brands:w,priceRanges:v}=b,[l,C]=n.useState({marca:!0,precio:!0,categoria:!0,colores:!1}),[c,g]=n.useState({category_id:[],brand_id:[],price:null,sort_by:"created_at",order:"desc"}),[o,P]=n.useState([]),[_,j]=n.useState(!1),[i,S]=n.useState({currentPage:1,totalPages:1}),F=s=>{const a=[];if(s.category_id.length>0){const r=s.category_id.map(t=>["category_id","=",t]);a.push(["or",...r])}if(s.brand_id.length>0){const r=s.brand_id.map(t=>["brand_id","=",t]);a.push(["or",...r])}return s.price&&a.push(["and",[["final_price",">=",s.price.min],"and",["final_price","<=",s.price.max]]]),a},x=async(s=1)=>{j(!0);try{const r={filter:F(c),page:s,take:20};console.log(r);const t=await Z.paginate(r);console.log(t),P(t.data),S({currentPage:t.currentPage,totalPages:t.lastPage})}catch(a){console.error("Error fetching products:",a)}finally{j(!1)}};n.useEffect(()=>{x()},[c]);const d=(s,a)=>{g(r=>{if(s==="price")return{...r,price:r.price&&r.price.min===a.min&&r.price.max===a.max?null:a};const t=Array.isArray(r[s])?r[s]:[],M=t.includes(a)?t.filter(E=>E!==a):[...t,a];return{...r,[s]:M}})},p=s=>{C(a=>({...a,[s]:!a[s]}))},[k,A]=n.useState(""),[$,B]=n.useState("");return e.jsx("section",{className:"py-12 bg-[#F7F9FB]",children:e.jsxs("div",{className:"mx-auto px-primary",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 pb-4 border-b-2",children:[e.jsx("h2",{className:"text-4xl font-bold",children:m==null?void 0:m.title}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:["Productos seleccionados: ",e.jsx("strong",{children:o==null?void 0:o.length})]}),e.jsxs("select",{value:c.sort_by+":"+c.order,onChange:s=>{const[a,r]=s.target.value.split(":");g(t=>({...t,sort_by:a,order:r}))},children:[e.jsx("option",{value:"created_at:desc",children:"Más reciente"}),e.jsx("option",{value:"created_at:asc",children:"Más antiguo"}),e.jsx("option",{value:"price:asc",children:"Precio: Menor a mayor"}),e.jsx("option",{value:"price:desc",children:"Precio: Mayor a menor"}),e.jsx("option",{value:"name:asc",children:"Nombre: A-Z"}),e.jsx("option",{value:"name:desc",children:"Nombre: Z-A"})]})]})]}),e.jsxs("div",{className:"relative flex gap-4",children:[e.jsxs("div",{className:"w-3/12 bg-white p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsx(V,{className:"h-5 w-5"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>p("marca"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Marca"}),e.jsx(h,{className:`h-5 w-5 transform transition-transform ${l.marca?"":"-rotate-180"}`})]}),l.marca&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-2 bg-gray-100 rounded-lg text-sm",value:k,onChange:s=>A(s.target.value)})]}),e.jsx("div",{className:"space-y-3",children:w.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>d("brand_id",s.id)}),e.jsx("span",{children:s.name})]},s.id))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>p("precio"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(h,{className:`h-5 w-5 transform transition-transform ${l.precio?"":"-rotate-180"}`})]}),l.precio&&e.jsx("div",{className:"space-y-3",children:v.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>d("price",s),checked:c.price&&c.price.min===s.min&&c.price.max===s.max}),e.jsx("span",{children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>p("categoria"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Categoría"}),e.jsx(h,{className:`h-5 w-5 transform transition-transform ${l.categoria?"":"-rotate-180"}`})]}),l.categoria&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(f,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-2 bg-gray-100 rounded-lg text-sm",value:$,onChange:s=>B(s.target.value)})]}),u.map(s=>e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>d("category_id",s.id)}),e.jsx("span",{children:s.name})]}),u.includes(s.id)&&e.jsx("ul",{className:"ml-6 mt-2 space-y-2",children:s.subcategories.map(a=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>d("subcategorias",a.name)}),e.jsx("span",{children:a.name})]},a.id))})]},s.id))]})]}),e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-lg hover:brightness-90 transition-colors text-sm font-bold",children:"Aplicar Filtro"})]}),e.jsx("div",{className:"w-9/12 py-4",children:_?e.jsx("p",{children:"Cargando..."}):e.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:Array.isArray(o)&&o.length>0?o.map(s=>e.jsx(R,{product:s,widthClass:"lg:w-1/4",cart:y,setCart:N},s.id)):e.jsx("p",{children:"No hay productos que coincidan con los filtros seleccionados."})})})]}),e.jsxs("div",{children:[e.jsx("button",{disabled:i.currentPage===1,onClick:()=>x(i.currentPage-1),children:"Anterior"}),e.jsxs("span",{children:["Página ",i.currentPage," de ",i.totalPages]}),e.jsx("button",{disabled:i.currentPage===i.totalPages,onClick:()=>x(i.currentPage+1),children:"Siguiente"})]})]})})};export{X as default};
