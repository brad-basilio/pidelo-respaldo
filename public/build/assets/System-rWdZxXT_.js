var Re=Object.defineProperty;var $e=(s,n,r)=>n in s?Re(s,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[n]=r;var B=(s,n,r)=>$e(s,typeof n!="symbol"?n+"":n,r);import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as c}from"./index-BH53Isel.js";import{c as Se}from"./ReactAppend-DTVVXReZ.js";import{C as Ee}from"./CreateReactScript-H8Uf0Xeb.js";import{i as A}from"./tippy-react.esm-BWiGTO87.js";import{m as O}from"./main-BSEyQEJW.js";import{B as ne}from"./ModalImportItem-BAoaR7zQ.js";import{S as oe}from"./SwitchFormGroup-DUGhyqoj.js";import{G as he}from"./Global-CklCDfn9.js";import{S as me}from"./SortByAfterField-BaS5rBg8.js";import{I as pe}from"./InputFormGroup-D5I6zpZc.js";import{T as fe}from"./TextareaFormGroup-CdwdsTk2.js";import{M as L}from"./Modal-CIqmjseY.js";import{S as Y}from"./SelectFormGroup-BPkIDnvX.js";import{S as Pe}from"./SetSelectValue-UxyCmHse.js";import{a as Fe,M as q}from"./MenuItemContainer-BkmzVQNY.js";import{G as Be}from"./GalleryRest-I9JAkJ4D.js";import"./index-yBjzXJbu.js";import"./index-fNjTmf9T.js";import"./index.esm-BE8-iLxT.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";/* empty css               *//* empty css              */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";import"./index-rimy3MAc.js";class K extends ne{constructor(){super(...arguments);B(this,"path","admin/system");B(this,"savePage",async(r={})=>{try{const{status:a,result:i}=await O.Fetch(`/api/${this.path}/page`,{method:"POST",body:JSON.stringify(r)});if(!a)throw new Error((i==null?void 0:i.message)||"Ocurrio un error inesperado");return i.data??[]}catch(a){return O.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:a.message,type:"danger"}),null}});B(this,"updateOrder",async r=>{try{const{status:a,result:i}=await O.Fetch(`/api/${this.path}/order`,{method:"PATCH",body:JSON.stringify(r)});if(!a)throw new Error((i==null?void 0:i.message)??"Ocurrio un error inesperado");return!0}catch(a){O.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:a.message,type:"danger"})}});B(this,"deletePage",async r=>{try{const{status:a,result:i}=await O.Fetch(`/api/${this.path}/page/${r}`,{method:"DELETE"});if(!a)throw new Error((i==null?void 0:i.message)||"Ocurrio un error inesperado");return i.data??!0}catch(a){return O.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:a.message,type:"danger"}),!1}});B(this,"exportBK",async()=>{try{const{status:r,result:a}=await O.Fetch(`/api/${this.path}/backup`);if(!r)throw new Error((a==null?void 0:a.message)||"Ocurrio un error inesperado");return a}catch(r){return O.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:r.message,type:"danger"}),null}});B(this,"importBK",async r=>{try{const a=await fetch(`/api/${this.path}/backup`,{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(O.Cookies.get("XSRF-TOKEN"))},body:r}),i=JSON.parseable(await a.text());if(!a.ok)throw new Error((i==null?void 0:i.message)||"Ocurrio un error inesperado");return i??!0}catch(a){return O.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:a.message,type:"danger"}),null}});B(this,"hasRemoteChanges",async()=>await this.simpleGet(`/api/${this.path}/has-remote-changes`));B(this,"fetchRemoteChanges",async()=>await this.simpleGet(`/api/${this.path}/fetch-remote-changes`))}}const Z=(s="")=>{s=s.replace(/[^a-zA-Z0-9_{}]/g,"");const n=/{([^}]+)}/g,r=[];let a;for(;(a=n.exec(s))!==null;)r.push(a[1]);return r},Oe=(s,n)=>{const r=new RegExp(`[${n}]+$`,"g");return s.replace(r,"")},X=new K,Ie=s=>{const{id:n,name:r,path:a,extends_base:i=!1,menuable:f=!1,setPages:d,onSEOClicked:j,onParamsClicked:g}=s,[m,l]=c.useState(!1),[u,p]=c.useState(!1),[N,S]=c.useState(!1),[k,h]=c.useState(!1),x=async y=>{if(r===y.target.value)return l(!1);X.savePage({id:n,name:y.target.value})&&(l(!1),d(v=>v.map(b=>b.id===n?{...b,name:y.target.value}:b)))},R=async y=>{if(a===y.target.value)return p(!1);const o=y.target.value;let v=structuredClone(o);const b=s.using??{};for(const P of Z(o))v=v.replace(`{${P}}`,"").replace(`{${P}?}`,""),b[P]=b[P]??{model:null};const E=Oe(v,"/");X.savePage({id:n,path:o,pseudo_path:E,using:Object.keys(b).length>0?b:void 0})&&(p(!1),d(P=>P.map(U=>U.id===n?{...U,path:y.target.value}:U)))},I=async y=>{S(!0);const o=y.target.checked,v=X.savePage({id:n,extends_base:o});S(!1),v&&d(b=>b.map(E=>E.id===n?{...E,extends_base:o}:E))},V=async y=>{h(!0);const o=y.target.checked,v=X.savePage({id:n,menuable:o});h(!1),v&&d(b=>b.map(E=>E.id===n?{...E,menuable:o}:E))},D=async y=>{await X.deletePage(y.id)&&(d(v=>v.filter(b=>b.id!=y.id)),$('[data-bs-toggle="tab"]').removeClass("active"),$(".tab-pane").removeClass("active"),$("#base-template-link").addClass("active"),$("#base-template").addClass("active"))},H=Z(a);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"dropdown float-end",children:[e.jsx("a",{href:"#",className:"dropdown-toggle arrow-none card-drop","data-bs-toggle":"dropdown","aria-expanded":"false",children:e.jsx("i",{className:"mdi mdi-dots-vertical"})}),e.jsxs("div",{className:"dropdown-menu dropdown-menu-end",children:[e.jsxs("button",{className:"dropdown-item",onClick:()=>j(s),children:[e.jsx("i",{className:"mdi mdi-cloud-search-outline me-1"}),"Editar SEO"]}),H.length>0&&e.jsxs("button",{className:"dropdown-item",onClick:()=>g(s),children:[e.jsx("i",{className:"mdi mdi-code-braces me-1"}),"Parámetros"]}),e.jsx("div",{className:"dropdown-divider"}),e.jsxs("button",{className:"dropdown-item",onClick:()=>D(s),children:[e.jsx("i",{className:"mdi mdi-trash-can-outline me-1"}),"Eliminar página"]})]})]}),e.jsxs("div",{children:[m?e.jsx("input",{className:"form-control form-control-sm mb-1",defaultValue:r,onBlur:x,autoFocus:!0}):e.jsx(A,{content:"Editar nombre",placement:"left",children:e.jsx("h4",{className:"header-title mb-1 d-block",onClick:()=>l(!0),style:{minWidth:"200px",cursor:"pointer"},children:r||"Sin nombre"})}),u?e.jsx("input",{className:"form-control form-control-sm mb-1",defaultValue:a,style:{minHeight:27,fieldSizing:"content"},onBlur:R,autoFocus:!0}):e.jsx(A,{content:"Editar ruta",placement:"left",children:e.jsx("small",{className:"text-muted d-block mb-1",onClick:()=>p(!0),style:{minWidth:"200px",cursor:"pointer"},children:a||"Sin ruta"})})]}),e.jsxs("div",{className:"row",children:[e.jsx(oe,{label:"Extiende de base",col:"col-lg-6 col-md-12 col-sm-6",checked:i,onChange:I,disabled:N}),e.jsx(oe,{label:"Mostrar en menu",col:"col-lg-6 col-md-12 col-sm-6",checked:f,onChange:V,disabled:k})]})]})},De=new K,Me=({dataLoaded:s,setDataLoaded:n,modalRef:r})=>{const a=c.useRef(null),i=c.useRef(null),f=c.useRef(null),d=async j=>{j.preventDefault(),await De.savePage({id:s.id,description:i.current.value,keywords:$(f.current).val()})&&(n(null),$(r.current).modal("hide"))};return c.useEffect(()=>{a.current.value=`${s==null?void 0:s.name} | ${he.APP_NAME}`,i.current.value=(s==null?void 0:s.description)??"",Pe(f.current,(s==null?void 0:s.keywords)??[])},[s]),e.jsx(L,{modalRef:r,title:`Editar SEO - ${s==null?void 0:s.name}`,size:"sm",onSubmit:d,children:e.jsxs("div",{id:"seo-container",children:[e.jsx(pe,{eRef:a,label:"Título",disabled:!0}),e.jsx(fe,{eRef:i,label:"Descripción",rows:2}),e.jsx(Y,{eRef:f,label:"Palabras clave",tags:!0,multiple:!0,dropdownParent:"#seo-container"})]})})},ue=({className:s,system:n,component:r,onComponentClicked:a,onDeleteClicked:i,onEditDataClicked:f})=>{var g;const d=(r==null?void 0:r.options)??[],j=d.find(m=>m.id==n.value);return e.jsxs("div",{className:`dropdown ${s}`,"data-id":n.id,children:[e.jsxs("div",{className:"btn btn-light dropdown-toggle text-truncate w-100 text-start",type:"button",id:`dd-${n.id}`,"data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true",children:[e.jsx("i",{className:"mdi mdi-chevron-down ms-1 float-end"}),e.jsxs("span",{className:"handle-sortable",style:{cursor:"move"},children:[e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("i",{className:"fa fa-ellipsis-v"})]}),e.jsx("span",{className:"ms-1",children:n.name})]}),e.jsxs("div",{className:"dropdown-menu","aria-labelledby":`dd-${n.id}`,"data-popper-placement":"bottom-start",children:[d.length>1&&e.jsxs(e.Fragment,{children:[d.filter(m=>m.id!=n.value).map(m=>e.jsxs("button",{className:"dropdown-item",onClick:()=>a({...n,name:`${r.name} - ${m.name}`,value:m.id}),children:[r.name," - ",m.name]})),e.jsx("div",{className:"dropdown-divider"})]}),(((g=j==null?void 0:j.using)==null?void 0:g.filters)||(j==null?void 0:j.data))&&e.jsxs("button",{className:"dropdown-item",onClick:()=>f(n,j),children:[e.jsx("i",{className:"mdi mdi-pencil me-1"}),"Configurar datos"]}),e.jsxs("button",{className:"dropdown-item",onClick:()=>i(n),children:[e.jsx("i",{className:"mdi mdi-trash-can-outline me-1"}),"Eliminar"]})]})]})},Te=({col:s,label:n,eRef:r,placeholder:a,required:i=!1,rows:f=3,value:d,onChange:j=()=>{}})=>{const[g,m]=c.useState(d),l=c.useRef(),u=c.useRef(null),p=r||l;return c.useEffect(()=>(u.current&&(u.current.toTextArea(),u.current=null),u.current=CodeMirror.fromTextArea(p.current,{mode:"htmlmixed",theme:"sode",indentUnit:2,tabSize:2}),u.current.setValue(d),setTimeout(()=>{u.current.refresh()},125),u.current.on("change",N=>{const S=N.getValue();m(S),j({target:{value:S}})}),()=>{u.current&&(u.current.toTextArea(),u.current=null)}),[p]),c.useEffect(()=>{g!==d&&(m(d),u.current&&(u.current.setValue(d),setTimeout(()=>{u.current.refresh()},125)))},[d]),e.jsxs("div",{className:`form-group ${s} mb-2`,children:[e.jsxs("label",{htmlFor:"",className:"mb-1",children:[n," ",i&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsx("textarea",{ref:p,className:"form-control",placeholder:a,required:i,rows:f,defaultValue:d,onChange:N=>m(N.target.value)})]})},_e=new K,Ae=({dataLoaded:s,setDataLoaded:n,setSystems:r,modalRef:a})=>{var m,l,u,p,N,S,k,h,x,R,I,V,D,H,y;const[i,f]=c.useState((s==null?void 0:s.data)||{}),d={};d.model=c.useRef(null),d.filters=c.useRef(null);const j=async o=>{o.preventDefault();const v=await _e.save({id:s.id,data:i,filters:$(d.filters.current).val()});v&&(n(null),$(a.current).modal("hide"),r(b=>b.map(E=>E.id==s.id?v.data:E)))};c.useEffect(()=>{var v,b,E;const o={};(v=s==null?void 0:s.component)==null||v.data.forEach(G=>{var P;o[G]=((P=s==null?void 0:s.data)==null?void 0:P[G])??""}),f(o),d.model.current.value=((E=(b=s==null?void 0:s.component)==null?void 0:b.using)==null?void 0:E.model)??"",$(d.filters.current).val((s==null?void 0:s.filters)??[]).trigger("change")},[s]);const g=(o,v)=>{f({...i,[o]:v})};return console.log(i),e.jsxs(L,{modalRef:a,title:s==null?void 0:s.name,onSubmit:j,size:(l=(m=s==null?void 0:s.component)==null?void 0:m.data)!=null&&l.some(o=>o.startsWith("code:"))?"lg":"md",children:[e.jsxs("ul",{className:"nav nav-tabs nav-bordered",children:[e.jsx("li",{className:"nav-item",hidden:!((p=(u=s==null?void 0:s.component)==null?void 0:u.data)!=null&&p.length),children:e.jsx("a",{href:"#tab-info","data-bs-toggle":"tab","aria-expanded":"true",className:"nav-link active",children:"Información"})}),e.jsx("li",{className:"nav-item",hidden:!((S=(N=s==null?void 0:s.component)==null?void 0:N.using)!=null&&S.filters),children:e.jsx("a",{href:"#tab-db","data-bs-toggle":"tab","aria-expanded":"true",className:"nav-link",children:"Base de datos"})})]}),e.jsxs("div",{className:"tab-content",id:"data-modal-container",children:[e.jsx("div",{className:"tab-pane active",id:"tab-info",hidden:!((h=(k=s==null?void 0:s.component)==null?void 0:k.data)!=null&&h.length),children:(R=(x=s==null?void 0:s.component)==null?void 0:x.data)==null?void 0:R.map((o,v)=>o.startsWith("code:")?e.jsx(Te,{label:o.replace("code:",""),value:i[o]??"",rows:1,onChange:b=>f({...i,[o]:b.target.value})},v):e.jsx(e.Fragment,{children:o.startsWith("bool:")?e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:o.replace("bool:","")}),e.jsxs("div",{children:[e.jsxs("div",{className:"form-check form-check-inline",children:[e.jsx("input",{type:"radio",className:"form-check-input",id:`${o}-true`,name:o,value:"true",checked:i[o]===!0,onChange:b=>g(o,b.target.value==="true")}),e.jsx("label",{className:"form-check-label",htmlFor:`${o}-true`,children:"Sí"})]}),e.jsxs("div",{className:"form-check form-check-inline",children:[e.jsx("input",{type:"radio",className:"form-check-input",id:`${o}-false`,name:o,value:"false",checked:i[o]===!1,onChange:b=>g(o,b.target.value==="true")}),e.jsx("label",{className:"form-check-label",htmlFor:`${o}-false`,children:"No"})]})]})]}):e.jsx(fe,{label:o,value:i[o]??"",rows:1,onChange:b=>f({...i,[o]:b.target.value})},v)}))}),e.jsxs("div",{className:"tab-pane show",id:"tab-db",children:[e.jsx(pe,{eRef:d.model,label:"Modelo",disabled:!0}),e.jsx(Y,{eRef:d.filters,label:"Filtros",multiple:!0,dropdownParent:"#tab-db",hidden:!((V=(I=s==null?void 0:s.component)==null?void 0:I.using)!=null&&V.filters),children:(y=(H=(D=s==null?void 0:s.component)==null?void 0:D.using)==null?void 0:H.filters)==null?void 0:y.map((o,v)=>e.jsx("option",{value:o,children:o},v))})]})]})]})},de=new K,Ve=({components:s,onClick:n})=>e.jsx("div",{className:"left-side-menu top-0 pt-2",children:e.jsxs("div",{"data-simplebar":!0,className:"h-100",children:[e.jsx("div",{id:"sidebar-menu",className:"show",children:e.jsxs("ul",{id:"side-menu",children:[e.jsx("li",{className:"menu-title",children:"Lista de componentes"}),s.filter(r=>r.options.length>0).map((r,a)=>e.jsx(Fe,{title:r.name,children:r.options.map((i,f)=>e.jsx(q,{name:i.name,icon:i.image,onClick:()=>{const d=$(".tab-pane:visible .components-container > div").last().data("id");n({name:`${r.name} - ${i.name}`,component:r.id,value:i.id,after_component:d})},children:i.name},f))},a)),e.jsx("li",{className:"menu-title",children:"Sistema de respaldo"}),e.jsx(q,{icon:"mdi mdi-cogs",rightBarToggle:!0,children:"Configuraciones"}),e.jsx(q,{icon:"mdi mdi-cloud-download",onClick:async()=>{const r=await de.exportBK(),a=new Blob([JSON.stringify(r)],{type:"application/json"}),i=URL.createObjectURL(a),f=document.createElement("a");f.href=i,f.download="backup.json",document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(i)},children:"Exportar Backup"}),e.jsx("input",{type:"file",id:"file-input",accept:"application/json",style:{display:"none"},onChange:async r=>{const a=r.target.files[0];if(r.target.value=null,a){const i=new FormData;if(i.append("backup",a),!await de.importBK(i))return;location.reload()}}}),e.jsx(q,{icon:"mdi mdi-backup-restore",onClick:()=>{document.getElementById("file-input").click()},children:"Importar Backup"})]})}),e.jsx("div",{className:"clearfix"})]})}),Ge=({page:s,param:n,models:r,setUsing:a,setPages:i})=>{var N,S,k;const f=c.useRef(),d=c.useRef(),j=c.useRef(),g=s==null?void 0:s.using,[m,l]=c.useState(null),u=h=>{const x=f.current.value,R=r.find(I=>I.name==x)??null;l(R)};c.useEffect(()=>{var h;$(f.current).val((h=g==null?void 0:g[n])==null?void 0:h.model).trigger("change")},[n]),c.useEffect(()=>{var h,x;a(R=>({...R,[n]:{...R[n],model:(m==null?void 0:m.name)??null}})),$(d.current).val(((h=g==null?void 0:g[n])==null?void 0:h.field)??null).trigger("change"),$(j.current).val(((x=g==null?void 0:g[n])==null?void 0:x.relations)??[]).trigger("change")},[m]);const p=`${n}-container`;return e.jsxs("div",{id:p,className:"row",children:[e.jsxs("label",{className:"form-label",children:["Parámetro ",e.jsx("code",{children:n})]}),e.jsx(Y,{eRef:f,label:"Modelo",col:"col-md-6",dropdownParent:`#${p}`,onChange:u,children:r.map((h,x)=>e.jsx("option",{value:h.name,children:h.name},x))}),e.jsx(Y,{eRef:d,label:"Campo",col:"col-md-6",dropdownParent:`#${p}`,onChange:h=>{a(x=>({...x,[n]:{...x[n],field:h.target.value}}))},children:(N=m==null?void 0:m.fields)==null?void 0:N.map((h,x)=>e.jsx("option",{children:h},x))}),e.jsx("div",{hidden:(((S=m==null?void 0:m.relations)==null?void 0:S.length)??0)==0,children:e.jsx(Y,{eRef:j,label:"Relaciones",multiple:!0,dropdownParent:`#${p}`,onChange:h=>{const x=$(h.target).val();a(R=>({...R,[n]:{...R[n],relations:x}}))},children:(k=m==null?void 0:m.relations)==null?void 0:k.map((h,x)=>e.jsx("option",{children:h},x))})})]})},Ue=new K,ze=({dataLoaded:s,setDataLoaded:n,setPages:r,modalRef:a,models:i})=>{const f=Z((s==null?void 0:s.path)??""),[d,j]=c.useState({}),g=async m=>{m.preventDefault();const l=await Ue.savePage({id:s.id,using:d});l&&(n(null),r(l),$(a.current).modal("hide"))};return c.useEffect(()=>{j((s==null?void 0:s.using)??{})},[s]),e.jsx(L,{modalRef:a,title:`Editar parámetros de URL - ${s==null?void 0:s.name}`,onSubmit:g,onClose:()=>n(null),children:f.map((m,l)=>e.jsx(Ge,{page:s,param:m,models:i,using:d,setUsing:j,setPages:r},l))})};class He extends ne{constructor(){super(...arguments);B(this,"path","admin/colors")}}class We extends ne{constructor(){super(...arguments);B(this,"path","admin/settings")}}const Ke=new Be,Je=new He,Xe=new We,Ye=({colors:s,setColors:n,settings:r,setSettings:a})=>{const[i,f]=c.useState([{uuid:crypto.randomUUID(),col:"col-3",name:"Icon (1:1)",src:"icon.png",width:"100%",aspectRatio:1},{uuid:crypto.randomUUID(),col:"col-5",name:"Logo (13:4)",src:"logo.png",width:"100%",aspectRatio:3.25},{uuid:crypto.randomUUID(),col:"col-4",name:"Logo footer (1:1)",src:"logo-footer.png",width:"100%",aspectRatio:1}]),d=async l=>{var k;const u=((k=l.target.files)==null?void 0:k[0])??null;if(!u)return;l.target.value=null;const p=l.target.name,N=new FormData;N.append("image",u),N.append("name",p),await Ke.save(N)&&f(h=>h.map(x=>(x.src==p&&(x.uuid=crypto.randomUUID()),x)))},j=async l=>{const u=l.target.getAttribute("data-color-id"),p=l.target.name,N=l.target.value;if(s.find(h=>h.id==u)[p]===N)return;const k=await Je.save({id:u,[p]:N});k&&n(h=>h.map(x=>x.id==u?k.data:x))},g=async l=>{var h;const u=l.target.getAttribute("data-id"),p=l.target.name,N=l.target.value;if((((h=r.find(x=>x.name==p))==null?void 0:h.description)??"")===N)return;const k=await Xe.save({name:p,value:N});k&&a(x=>x.map(R=>R.id==u?k.data:R))},m=l=>{const u=r.find(p=>p.name==l);return u?u.value:""};return e.jsx("div",{className:"right-bar",children:e.jsxs("div",{"data-simplebar":!0,className:"h-100",children:[e.jsxs("div",{className:"rightbar-title",children:[e.jsx("a",{href:"#",className:"right-bar-toggle float-end",children:e.jsx("i",{className:"mdi mdi-close"})}),e.jsx("h4",{className:"font-16 m-0 text-white",children:"Configuraciones"})]}),e.jsxs("div",{className:"p-2",children:[e.jsx("h5",{children:"Imágenes principales"}),e.jsx("div",{className:"row",children:i.map((l,u)=>{const p="file-"+l.uuid;return e.jsxs("div",{className:l.col,children:[e.jsx("input",{id:p,name:l.src,type:"file",accept:"image/png",hidden:!0,onChange:d}),e.jsx("label",{htmlFor:p,className:"form-label d-block mb-1",style:{cursor:"pointer"},children:l.name}),e.jsx("label",{htmlFor:p,style:{cursor:"pointer"},className:"w-100",children:e.jsx("img",{className:"border",src:`/assets/resources/${l.src}?v=${l.uuid}`,alt:"",style:{height:l.height,width:l.width,objectFit:"contain",objectPosition:"center",backgroundColor:"#f5f5f5",borderRadius:"4px",aspectRatio:l.aspectRatio}})})]},u)})}),e.jsx("hr",{className:"my-2"}),e.jsx("h5",{children:"Fuentes del sistema"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"",className:"form-label mb-1",children:"Titulos"}),e.jsx(A,{content:"Nombre de la fuente",children:e.jsx("input",{type:"text",className:"form-control form-control-sm mb-1",name:"title-font-name",defaultValue:m("title-font-name"),onBlur:g})}),e.jsx(A,{content:"Enlace de la fuente",children:e.jsx("textarea",{className:"form-control form-control-sm",rows:1,name:"title-font-url",defaultValue:m("title-font-url"),onBlur:g,style:{minHeight:27,fieldSizing:"content"}})})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"",className:"form-label mb-1",children:"Parrafos"}),e.jsx(A,{content:"Nombre de la fuente",children:e.jsx("input",{type:"text",className:"form-control form-control-sm mb-1",name:"paragraph-font-name",defaultValue:m("paragraph-font-name"),onBlur:g})}),e.jsx(A,{content:"Enlace de la fuente",children:e.jsx("textarea",{className:"form-control form-control-sm",rows:1,name:"paragraph-font-url",defaultValue:m("paragraph-font-url"),onBlur:g,style:{minHeight:27,fieldSizing:"content"}})})]}),e.jsx("hr",{className:"my-2"}),e.jsx("h5",{children:"Colores del sistema"}),e.jsx("div",{className:"d-flex flex-column gap-1",children:s.map((l,u)=>e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("span",{className:"input-group-text px-1",children:e.jsx("input",{type:"color",name:"description","data-color-id":l.id,className:"p-0",style:{width:"20px",height:"20px",border:"1px solid #ced4da",borderRadius:"4px",cursor:"pointer"},defaultValue:l.description,onBlur:j})}),e.jsx("input",{type:"text",name:"name","data-color-id":l.id,className:"form-control form-control-sm",placeholder:"Color",defaultValue:l.name,onBlur:j,disabled:l.name=="primary",style:{cursor:l.name=="primary"?"not-allowed":"text"}})]},u))})]})]})})},W=new K,Ze=({systems:s=[],pages:n=[],colors:r=[],components:a,models:i,settings:f=[]})=>{const d=c.useRef(null),j=c.useRef(null),g=c.useRef(null),m=c.useRef(null),[l,u]=c.useState(s),[p,N]=c.useState(n),[S,k]=c.useState(r),[h,x]=c.useState(f),[R,I]=c.useState(!1),[V,D]=c.useState(null),[H,y]=c.useState(null),[o,v]=c.useState(!1),[b,E]=c.useState(!1),[G,P]=c.useState(null),[U,re]=c.useState(!1),[ae,ie]=c.useState(!1),[Qe,xe]=c.useState(0),ge=async()=>{I(!0);const t=await W.savePage();t&&(I(!1),N(t))},ee=async t=>{const w=$(".tab-pane:visible").data("id")??null;t.page_id=w;const F=await W.save(t);if(!F)return;const T=F.data;u(_=>_.some(M=>M.id===T.id)?_.map(M=>M.id===T.id?T:M):[..._,T])},le=async t=>{await W.delete(t.id)&&u(w=>w.filter(F=>F.id!=t.id))},be=async()=>{re(!0);const t=await W.fetchRemoteChanges();re(!1),t&&location.reload()},je=t=>{const C=$(t.target).data("page-id"),w=$(t.target).data("page-path"),F=$(t.target).val();$(`#iframe-${C}`).removeAttr("src"),$(`#iframe-${C}`).attr("src",`${w}/${F}`)},ve=async t=>{D(t),$(d.current).modal("show")},Ne=async t=>{D(t),$(j.current).modal("show")},ce=async(t,C)=>{y({...t,component:C}),$(m.current).modal("show")};c.useEffect(()=>{let t=null;const C=async()=>{if(ae)return;if(o){clearInterval(t);return}ie(!0);const w=await W.hasRemoteChanges();if(ie(!1),!w){v(!0);return}E(w.has_changes),P(w.last_commit),xe(w.commits)};return C(),t=setInterval(C,1e4),()=>clearInterval(t)},[o,U,ae]),c.useEffect(()=>{document.title=`Sistema | ${he.APP_NAME}`},[null]),c.useEffect(()=>{const t=$("iframe:visible");t&&($(t).removeAttr("src"),$(t).attr("src",t.data("path")))},[l,S,h]),c.useEffect(()=>{[...$(".components-container")].forEach(C=>{$(C).sortable({connectWith:".components-container",handle:".handle-sortable",forcePlaceholderSize:!0,update:async function(w,F){const T=[...$(C).children()],_={};if(T.forEach(Q=>{const M=$(Q).data("id"),z=$(Q).prev().data("id")??null,J=l.find(se=>se.id==M);(J==null?void 0:J.after_component)!==z&&(_[M]=z)}),Object.keys(_).length>0){if(!await W.updateOrder(_))return;u(M=>{const z=[...M];return Object.entries(_).forEach(([J,se])=>{const te=z.findIndex(ke=>ke.id==J);te!==-1&&(z[te]={...z[te],after_component:se})}),z})}}}).disableSelection()})},[p,l]);const[we,ye,Ce]=(G==null?void 0:G.split(`
`))??[];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"wrapper position-relative",children:[e.jsx(Ve,{components:a,onClick:ee}),e.jsx("div",{className:"content-page mt-2 pb-3",style:{height:"max-content"},children:e.jsx("div",{className:"content mt-2",children:e.jsxs("div",{className:"container-fluid",children:[e.jsx("button",{className:"button-menu-mobile d-lg-none d-md-block position-absolute ",style:{zIndex:1,border:"none",borderRadius:"0 50% 50% 0",backgroundColor:"#fff",color:"#343a40",top:"50%",left:"0",transform:"translateY(-50%)",padding:"24px 0px 20px 6px ",fontWeight:"bold"},children:"〉"}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card mb-0",children:e.jsxs("div",{className:"card-body",style:{height:"calc(100vh - 48px)"},children:[e.jsxs("ul",{className:"nav nav-tabs nav-bordered flex-nowrap",style:{overflowX:"auto",overflowY:"hidden"},children:[e.jsx("li",{className:"nav-item",children:e.jsx("a",{id:"base-template-link",href:"#base-template","data-bs-toggle":"tab","aria-expanded":"false",className:"nav-link active h-100",children:"Base"})}),p.map((t,C)=>e.jsx("li",{className:"nav-item",children:e.jsxs("a",{href:`#page-${t.id}`,"data-bs-toggle":"tab","aria-expanded":"false",className:"nav-link h-100",style:{whiteSpace:"nowrap"},children:[t.name,e.jsx("small",{className:"d-block text-muted",style:{fontWeight:"normal"},children:t.path})]})},C)),e.jsx("li",{className:"nav-item d-flex justify-content-center align-items-center px-2",children:e.jsx(A,{content:"Agregar página",children:e.jsx("button",{className:"nav-link btn btn-xs btn-white rounded-pill",onClick:ge,disabled:R,children:R?e.jsx("i",{className:"mdi mdi-loading mdi-spin"}):e.jsx("i",{className:"mdi mdi-plus"})})})})]}),e.jsxs("div",{className:"tab-content",children:[e.jsx("div",{className:"tab-pane active",id:"base-template",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"d-flex flex-column gap-2 components-container","data-page-id":null,children:me(l).filter(t=>t.page_id==null).map(t=>{const C=a.find(w=>w.id==t.component);if(C==null||C.options,t.component=="content")return e.jsxs("button",{"data-id":t.id,className:"btn btn-light text-truncate w-100 text-start",type:"button",children:[e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("span",{className:"ms-1",children:t.name})]},t.id);{const w=a.find(F=>F.id==t.component);return e.jsx(ue,{className:"",system:t,component:w,onComponentClicked:ee,onDeleteClicked:le,onEditDataClicked:ce},t.id)}})})}),e.jsx("div",{className:"col-md-8",children:e.jsx("iframe",{src:"/base-template","data-path":"/base-template",className:"w-100 h-100 border",style:{minHeight:"calc(100vh - 200px)",borderRadius:"4px"}})})]})}),p.map((t,C)=>e.jsx("div",{className:"tab-pane",id:`page-${t.id}`,"data-id":t.id,children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx(Ie,{...t,models:i,setPages:N,onSEOClicked:ve,onParamsClicked:Ne}),e.jsx("hr",{className:"my-2"}),e.jsx("div",{className:"d-flex flex-column gap-2 components-container","data-page-id":t.id,children:me(l).filter(w=>w.page_id==t.id).map(w=>{const F=a.find(T=>T.id==w.component);return e.jsx(ue,{className:"",system:w,component:F,onComponentClicked:ee,onDeleteClicked:le,onEditDataClicked:ce},w.id)})})]}),e.jsxs("div",{className:"col-md-8",children:[e.jsxs("div",{className:"input-group mb-2",children:[e.jsxs("span",{className:"input-group-text",children:[(t==null?void 0:t.pseudo_path)||t.path,Z(t==null?void 0:t.path).length>0&&"/"]}),Z(t==null?void 0:t.path).length>0&&e.jsx("input",{type:"text",className:"form-control",placeholder:"Parametros","data-page-path":t.pseudo_path,"data-page-id":t.id,onChange:je})]}),e.jsx("iframe",{id:`iframe-${t.id}`,src:(t==null?void 0:t.pseudo_path)||t.path,"data-path":(t==null?void 0:t.pseudo_path)||t.path,className:"w-100 h-100 border",style:{minHeight:"calc(100vh - 302px)",borderRadius:"4px"}})]})]})},C))]})]})})})})]})})}),b&&e.jsx(A,{content:"Tienes cambios sin sincronizar",children:e.jsx("button",{className:"btn btn-dark p-0 position-absolute rounded-pill",style:{right:"20px",bottom:"20px",height:"40px",width:"40px"},onClick:()=>$(g.current).modal("show"),children:e.jsx("i",{className:"mdi mdi-github mdi-24px"})})})]}),e.jsx(L,{modalRef:g,title:"Cambios de Github",size:"sm",hideFooter:!0,children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"mdi mdi-github mdi-48px"}),e.jsx("h5",{className:"mt-2",children:"Tienes cambios sin sincronizar"}),e.jsxs("div",{children:[e.jsx("b",{className:"d-block",children:we}),e.jsx("small",{className:"d-block text-muted",children:moment(ye).fromNow()}),e.jsx("span",{className:"d-block",children:Ce})]}),e.jsxs("button",{className:"btn btn-primary",type:"button",onClick:()=>be(),disabled:U,children:[U?e.jsx("i",{className:"mdi mdi-loading mdi-spin me-1"}):e.jsx("i",{className:"mdi mdi-cloud-download me-1"}),"Sincronizar"]})]})}),e.jsx(Ye,{colors:S,setColors:k,settings:h,setSettings:x}),e.jsx(Me,{dataLoaded:V,setDataLoaded:D,modalRef:d}),e.jsx(ze,{dataLoaded:V,setDataLoaded:D,setPages:N,modalRef:j,models:i}),e.jsx(Ae,{dataLoaded:H,setDataLoaded:y,setSystems:u,modalRef:m})]})};Ee((s,n)=>{Se.createRoot(s).render(e.jsx(Ze,{...n}))});
