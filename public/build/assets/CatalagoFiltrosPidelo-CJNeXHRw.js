var X=Object.defineProperty;var Y=(l,n,i)=>n in l?X(l,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[n]=i;var S=(l,n,i)=>Y(l,typeof n!="symbol"?n+"":n,i);import{j as e}from"./AboutHeader-COUW3Uy_.js";import{r as c}from"./index-CqkZ-sT_.js";import"./ProductCard-DppMoL6U.js";import{m as y}from"./main-CkMzf7wF.js";import"./BasicEditing-CqE15M_Q.js";import{L as Z,N as ee}from"./NoResult-CROInX6p.js";import{P as se}from"./ProductCardScraping-CVJALr5M.js";import{C as ae,a as te}from"./chevron-right-B4p_OAUH.js";import{F as re}from"./filter-CawzT8aa.js";import{C as k}from"./chevron-down-CxOx8ByU.js";import{S as I}from"./search-DhoFIDMi.js";import"./___vite-browser-external_commonjs-proxy-DA7w84js.js";import"./index.esm-DfKMpHf8.js";import"./createLucideIcon-D0vxYqnu.js";class F{}S(F,"getProducts",async n=>{console.log(n);try{const{query:i,proveedor:p,page:g,limit:d=12}=n,{status:f,result:o}=await y.Fetch("./api/scrap",{method:"POST",body:JSON.stringify({query:i,proveedor:p,page:g,limit:d})});return f?(y.Notify.add({icon:"/assets/img/icon.svg",title:"Operación correcta",body:"Se obtuvieron los productos correctamente"}),{data:o.data||[],hasMore:o.data.length===d}):(console.log((o==null?void 0:o.message)||"Error al obtener datos"),{data:[],hasMore:!1})}catch(i){return y.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:i.message,type:"danger"}),{data:[],hasMore:!1}}}),S(F,"getPaginatedProducts",async n=>{try{const{query:i,proveedor:p,page:g,limit:d=10}=n,{status:f,result:o}=await y.Fetch("./api/scrap",{method:"POST",body:JSON.stringify({query:i,proveedor:p,page:g,limit:d})});return f?{data:o.data||[],hasMore:o.data.length===d}:(console.log((o==null?void 0:o.message)||"Error al obtener más datos"),{data:[],hasMore:!1})}catch(i){return y.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:i.message,type:"danger"}),{data:[],hasMore:!1}}});const Ne=({items:l,data:n,filteredData:i,cart:p,setCart:g})=>{const{categories:d,brands:f,priceRanges:o}=i,[x,T]=c.useState({marca:!0,precio:!0,categoria:!0,colores:!1}),[u,_]=c.useState({category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[j,L]=c.useState([]),[q,$]=c.useState(!1),[ie,J]=c.useState({currentPage:1,totalPages:1}),A=async(s,t,r=1)=>{if(!s){alert("Por favor, ingresa un término de búsqueda");return}$(!0);try{const a=await F.getProducts({query:s,proveedor:t,page:r});L(r===1?a.data:m=>[...m,...a.data]),J({currentPage:a.currentPage,totalPages:a.lastPage}),console.log(a.data)}catch(a){console.error("Error:",a),alert("Hubo un error al realizar la búsqueda. Por favor, intenta nuevamente.")}finally{$(!1)}},[v,V]=c.useState(""),[E,z]=c.useState("nike");c.useEffect(()=>{const s=new URLSearchParams(window.location.search),t=s.get("category");if(t){const r=d.find(a=>a.slug===t);r&&_(a=>({...a,category_id:[r.id]}))}V(s.get("search")),z(s.get("provider")),v&&A(v,E)},[l]);const b=(s,t)=>{_(r=>{if(s==="price")return{...r,price:r.price&&r.price.min===t.min&&r.price.max===t.max?null:t};const a=Array.isArray(r[s])?r[s]:[],m=a.includes(t)?a.filter(w=>w!==t):[...a,t];return{...r,[s]:m}})},P=s=>{T(t=>({...t,[s]:!t[s]}))},[M,D]=c.useState(""),[O,H]=c.useState(""),U=d.filter(s=>s.name.toLowerCase().includes(M.toLowerCase())),G=f.filter(s=>s.name.toLowerCase().includes(O.toLowerCase())),[h,N]=c.useState(1),C=12,B=h*C,K=B-C,Q=Array.isArray(j)?j.slice(K,B):[],R=Math.ceil(j.length/C),W=s=>N(s);return e.jsx("section",{className:"py-12 bg-[#F7F9FB] font-font-general",children:e.jsxs("div",{className:"mx-auto px-primary",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 pb-4 border-b-2",children:[e.jsx("h2",{className:"text-4xl font-bold w-6/12",children:"Todos los productos"}),e.jsx("div",{className:"flex items-center gap-4 w-5/12",children:e.jsx("div",{className:"flex justify-end items-center mb-4 w-full",children:e.jsx("div",{className:"customtext-neutral-dark font-semibold",children:e.jsxs("nav",{class:"flex items-center gap-x-2 min-w-max",children:[e.jsx("button",{class:" p-4 inline-flex items-center",onClick:()=>{N(h-1)},disabled:h===1,children:e.jsx(ae,{})}),e.jsx("ul",{className:"list-none flex gap-2",children:[...Array(R).keys()].map(s=>e.jsx("li",{className:`page-item ${h===s+1?"active":""}`,children:e.jsx("button",{onClick:()=>W(s+1),class:`w-10 h-10  p-2 inline-flex items-center justify-center rounded-full transition-all duration-300  hover:text-white hover:bg-primary ${h===s+1?"bg-primary text-white":" bg-transparent"}`,"aria-current":"page",children:s+1})},s+1))}),e.jsx("button",{class:" p-4 inline-flex items-center ",onClick:()=>{const s=h+1;s<=R?N(s):(N(s),A(v,E,s)),console.log("Página solicitada:",s)},children:e.jsx(te,{})})]})})})})]}),e.jsxs("div",{className:"relative flex gap-4",children:[e.jsxs("div",{className:"w-3/12 bg-white p-4 rounded-lg h-max",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsx(re,{className:"h-5 w-5"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>P("marca"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Marca"}),e.jsx(k,{className:`h-5 w-5 transform transition-transform ${x.marca?"":"-rotate-180"}`})]}),x.marca&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:O,onChange:s=>H(s.target.value)})]}),e.jsx("div",{className:"space-y-3",children:G.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>b("brand_id",s.id)}),e.jsx("span",{children:s.name})]},s.id))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>P("precio"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(k,{className:`h-5 w-5 transform transition-transform ${x.precio?"":"-rotate-180"}`})]}),x.precio&&e.jsx("div",{className:"space-y-3",children:o.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>b("price",s),checked:u.price&&u.price.min===s.min&&u.price.max===s.max}),e.jsx("span",{children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>P("categoria"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Categoría"}),e.jsx(k,{className:`h-5 w-5 transform transition-transform ${x.categoria?"":"-rotate-180"}`})]}),x.categoria&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:M,onChange:s=>D(s.target.value)})]}),U.map(s=>{var t,r,a;return e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>b("category_id",s.id),checked:(t=u.category_id)==null?void 0:t.includes(s.id)}),e.jsx("span",{children:s.name})]}),((r=u.category_id)==null?void 0:r.includes(s.id))&&((a=s.subcategories)==null?void 0:a.length)>0&&e.jsx("ul",{className:"ml-6 mt-2 space-y-2",children:s.subcategories.map(m=>{var w;return e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>b("subcategory_id",m.id),checked:(w=u.subcategory_id)==null?void 0:w.includes(m.id)}),e.jsx("span",{children:m.name})]},m.id)})})]},s.id)})]})]}),e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl hover:brightness-90 transition-colors text-sm font-bold",children:"Aplicar Filtro"})]}),e.jsx("div",{className:"w-9/12",children:q?e.jsx(Z,{}):e.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:Array.isArray(j)&&j.length>0?Q.map(s=>e.jsx(se,{product:s,widthClass:"lg:w-1/3",cart:p,setCart:g},s.id)):e.jsx(ee,{})})})]})]})})};export{Ne as default};
