import{j as s}from"./AboutHeader-COUW3Uy_.js";import{r as i}from"./index-CqkZ-sT_.js";import{C as K}from"./CardHoverBtn-CDft0zDk.js";import{I as O}from"./ItemsRest-COC0wVJZ.js";import{L as V}from"./Loading-CS0Y7TJ8.js";import{N as Z}from"./NoResult-CKKmsI7-.js";import{S as D}from"./SelectForm-B3_ZzKEz.js";import{F as H}from"./filter-CawzT8aa.js";import{C as h}from"./chevron-down-CxOx8ByU.js";import{S as y}from"./search-DhoFIDMi.js";import"./ProductCard-DppMoL6U.js";import"./main-CkMzf7wF.js";import"./___vite-browser-external_commonjs-proxy-DA7w84js.js";import"./BasicEditing-CqE15M_Q.js";import"./check-CvqheCNB.js";import"./createLucideIcon-D0vxYqnu.js";const U=new O,oe=({items:N,data:x,filteredData:w,cart:C,setCart:_})=>{const{categories:f,brands:v,priceRanges:S}=w,[o,P]=i.useState({marca:!0,precio:!0,categoria:!0,colores:!1}),[n,d]=i.useState({category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[l,k]=i.useState([]),[F,g]=i.useState(!1),[q,L]=i.useState({currentPage:1,totalPages:1}),A=e=>{const a=[];if(e.category_id.length>0){const t=e.category_id.map(r=>["category_id","=",r]);a.push(["or",...t])}if(e.subcategory_id.length>0){const t=e.subcategory_id.map(r=>["subcategory_id","=",r]);a.push(["and",...t])}if(e.brand_id.length>0){const t=e.brand_id.map(r=>["brand_id","=",r]);a.push(["or",...t])}return e.price&&a.push(["and",[["final_price",">=",e.price.min],"and",["final_price","<=",e.price.max]]]),e.name&&a.push(["name","contains",e.name]),a},B=async(e=1)=>{g(!0);try{const t={filter:A(n),sort:n.sort,take:20},r=await U.paginate(t);k(r.data),L({currentPage:r.currentPage,totalPages:r.lastPage})}catch(a){console.error("Error fetching products:",a)}finally{g(!1)}};i.useEffect(()=>{B()},[n]),i.useEffect(()=>{const e=new URLSearchParams(window.location.search),a=e.get("category");if(a){const r=f.find(c=>c.slug===a);r&&d(c=>({...c,category_id:[r.id]}))}const t=e.get("search");t&&d(r=>({...r,name:t}))},[N]);const m=(e,a)=>{d(t=>{if(e==="price")return{...t,price:t.price&&t.price.min===a.min&&t.price.max===a.max?null:a};const r=Array.isArray(t[e])?t[e]:[],c=r.includes(a)?r.filter(u=>u!==a):[...r,a];return{...t,[e]:c}})},p=e=>{P(a=>({...a,[e]:!a[e]}))},M=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[b,$]=i.useState(""),[j,R]=i.useState(""),E=f.filter(e=>e.name.toLowerCase().includes(b.toLowerCase())),I=v.filter(e=>e.name.toLowerCase().includes(j.toLowerCase()));return s.jsx("section",{className:"py-12 bg-[#F7F9FB]",children:s.jsxs("div",{className:"mx-auto px-primary",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between items-center mb-8 pb-4 border-b-2",children:[s.jsx("h2",{className:"text-[32px] md:text-4xl font-bold md:w-6/12",children:x==null?void 0:x.title}),s.jsxs("div",{className:"flex items-center gap-4 md:w-5/12",children:[s.jsxs("span",{className:"block w-6/12",children:["Productos seleccionados:"," ",s.jsx("strong",{children:l==null?void 0:l.length})]}),s.jsx("div",{className:"w-6/12",children:s.jsx(D,{options:M,placeholder:"Ordenar por",onChange:e=>{const[a,t]=e.split(":"),r=[{selector:a,desc:t==="desc"}];d(c=>({...c,sort:r}))},labelKey:"label",valueKey:"value"})})]})]}),s.jsxs("div",{className:"relative flex gap-4",children:[s.jsxs("div",{className:"hidden md:block md:w-3/12 bg-white p-4 rounded-lg h-max",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),s.jsx(H,{className:"h-5 w-5"})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>p("marca"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Marca"}),s.jsx(h,{className:`h-5 w-5 transform transition-transform ${o.marca?"":"-rotate-180"}`})]}),o.marca&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:j,onChange:e=>R(e.target.value)})]}),s.jsx("div",{className:"space-y-3",children:I.map(e=>s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>m("brand_id",e.id)}),s.jsx("span",{children:e.name})]},e.id))})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>p("precio"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Precio"}),s.jsx(h,{className:`h-5 w-5 transform transition-transform ${o.precio?"":"-rotate-180"}`})]}),o.precio&&s.jsx("div",{className:"space-y-3",children:S.map(e=>s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>m("price",e),checked:n.price&&n.price.min===e.min&&n.price.max===e.max}),s.jsx("span",{children:`S/ ${e.min} - S/ ${e.max}`})]},`${e.min}-${e.max}`))})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>p("categoria"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Categoría"}),s.jsx(h,{className:`h-5 w-5 transform transition-transform ${o.categoria?"":"-rotate-180"}`})]}),o.categoria&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:b,onChange:e=>$(e.target.value)})]}),E.map(e=>{var a,t,r;return s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>m("category_id",e.id),checked:(a=n.category_id)==null?void 0:a.includes(e.id)}),s.jsx("span",{children:e.name})]}),((t=n.category_id)==null?void 0:t.includes(e.id))&&((r=e.subcategories)==null?void 0:r.length)>0&&s.jsx("ul",{className:"ml-6 mt-2 space-y-2",children:e.subcategories.map(c=>{var u;return s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>m("subcategory_id",c.id),checked:(u=n.subcategory_id)==null?void 0:u.includes(c.id)}),s.jsx("span",{children:c.name})]},c.id)})})]},e.id)})]})]}),s.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl hover:brightness-90 transition-colors text-sm font-bold",children:"Aplicar Filtro"})]}),s.jsx("div",{className:"w-full md:w-9/12 py-4",children:F?s.jsx(V,{}):s.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:Array.isArray(l)&&l.length>0?l.map(e=>s.jsx(K,{product:e,widthClass:"lg:w-1/4",cart:C,setCart:_},e.id)):s.jsx(Z,{})})})]})]})})};export{oe as default};
