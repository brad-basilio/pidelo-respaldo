import{j as t}from"./AboutHeader-ClKiNAEV.js";import{r as c,R as C}from"./index-DFv2mRv-.js";import"./ProductCard-NsyC22vv.js";import{I as U}from"./ItemsRest-ei1fmHEM.js";import"./HeaderSearch-C6xLnU5a.js";import"./main-rZoj-gSW.js";import{L as G}from"./Loading-O_y8BNFU.js";import{N as H}from"./NoResult-BasQTFzm.js";import{S as J}from"./SelectForm-Ckz_d_he.js";import{P as Q}from"./ProductCardSimple-BWc0etaM.js";import{C as f}from"./chevron-down-Bgb5hLdB.js";import{S as v}from"./search-BlyVC63b.js";import{C as _,a as S}from"./chevron-right--XtiYjfH.js";import"./ModalImportItem-Cwh6n2ot.js";import"./index-BOPJobjj.js";import"./index-Sd7so-oN.js";import"./index-Cevqm-zP.js";import"./CartItemRow-BRRZMnl0.js";import"./tippy-react.esm-CGYKl-Jd.js";import"./Number2Currency-e57Tgsuk.js";import"./minus-C_LiTw_8.js";import"./createLucideIcon-CC2OGGjd.js";import"./plus-DqVREqgL.js";import"./___vite-browser-external_commonjs-proxy-BQdpDcDf.js";import"./check-sPmXvS3y.js";const W=new U,ve=({items:k,data:X,filteredData:$,cart:R,setCart:L})=>{const{collections:x,categories:b,brands:F,priceRanges:M}=$;console.log(x);const[m,E]=c.useState({collection:!0,marca:!0,precio:!0,categoria:!0,colores:!1}),[l,u]=c.useState({collection_id:[],category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[p,A]=c.useState([]),[I,j]=c.useState(!1),[a,B]=c.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),z=e=>{const s=[];if(e.collection_id.length>0){const r=e.collection_id.map(n=>["collection_id","=",n]);s.push(["or",...r])}if(e.category_id.length>0){const r=e.category_id.map(n=>["category_id","=",n]);s.push(["or",...r])}if(e.subcategory_id.length>0){const r=e.subcategory_id.map(n=>["subcategory_id","=",n]);s.push(["and",...r])}if(e.brand_id.length>0){const r=e.brand_id.map(n=>["brand_id","=",n]);s.push(["or",...r])}return e.price&&s.push(["and",[["final_price",">=",e.price.min],"and",["final_price","<=",e.price.max]]]),e.name&&s.push(["name","contains",e.name]),s},y=async(e=1)=>{j(!0);try{const r={filter:z(l),sort:l.sort,skip:(e-1)*a.itemsPerPage,take:a.itemsPerPage,requireTotalCount:!0},n=await W.paginate(r);A(n.data),B({currentPage:e,totalPages:Math.ceil(n.totalCount/a.itemsPerPage),totalItems:n.totalCount,itemsPerPage:a.itemsPerPage,from:(e-1)*a.itemsPerPage+1,to:Math.min(e*a.itemsPerPage,n.totalCount)})}catch(s){console.error("Error fetching products:",s)}finally{j(!1)}};c.useEffect(()=>{y(a.currentPage)},[l]);const d=e=>{e>=1&&e<=a.totalPages&&y(e)},N=()=>{const e=[],s=a.totalPages,r=a.currentPage,n=2;for(let i=1;i<=s;i++)i===1||i===s||i>=r-n&&i<=r+n?e.push(i):(i===r-n-1||i===r+n+1)&&e.push("...");return e.filter((i,o,T)=>i!=="..."||T[o-1]!=="...")};c.useEffect(()=>{const e=new URLSearchParams(window.location.search),s=e.get("category");if(s){const i=b.find(o=>o.slug===s);i&&u(o=>({...o,category_id:[i.id]}))}const r=e.get("collection");if(r){const i=x.find(o=>o.slug===r);i&&u(o=>({...o,collection_id:[i.id]}))}const n=e.get("search");n&&u(i=>({...i,name:n}))},[k]);const h=(e,s)=>{u(r=>{if(e==="price")return{...r,price:r.price&&r.price.min===s.min&&r.price.max===s.max?null:s};const n=Array.isArray(r[e])?r[e]:[],i=n.includes(s)?n.filter(o=>o!==s):[...n,s];return{...r,[e]:i}})},g=e=>{E(s=>({...s,[e]:!s[e]}))},K=[{value:"created_at:desc",label:"MÃ¡s reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[w,O]=c.useState(""),[P,V]=c.useState(""),[Z,Y]=c.useState(""),q=x.filter(e=>e.name.toLowerCase().includes(P.toLowerCase())),D=b.filter(e=>e.name.toLowerCase().includes(w.toLowerCase()));return F.filter(e=>e.name.toLowerCase().includes(Z.toLowerCase())),t.jsx("section",{className:"py-6  font-font-general customtext-primary",children:t.jsx("div",{className:"mx-auto px-primary",children:t.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[t.jsxs("div",{className:"w-full sm:w-1/5 bg-white p-4 rounded-lg h-max",children:[t.jsx("p",{className:"customtext-primary text-2xl font-bold pb-4 mb-4 border-b",children:"Combina como desees tu sala"}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("button",{onClick:()=>g("collection"),className:"flex items-center justify-between w-full mb-4",children:[t.jsx("span",{className:"font-medium",children:"Colecciones"}),t.jsx(f,{className:`h-5 w-5 transform transition-transform ${m.collection?"":"-rotate-180"}`})]}),m.collection&&t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"relative",children:[t.jsx(v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:P,onChange:e=>V(e.target.value)})]}),q.map(e=>{var r,n;const s=(r=l.collection_id)==null?void 0:r.includes(e.id);return t.jsx("div",{className:`group py-1 rounded-md ${s?"bg-secondary":"bg-transparent"}`,children:t.jsxs("label",{className:"flex items-center space-x-3 ",children:[t.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>h("collection_id",e.id),checked:(n=l.collection_id)==null?void 0:n.includes(e.id)}),t.jsx("img",{src:`/storage/images/collection/${e.image}`,onError:i=>i.target.src="assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"}),t.jsx("span",{children:e.name})]})},e.id)})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("button",{onClick:()=>g("categoria"),className:"flex items-center justify-between w-full mb-4",children:[t.jsx("span",{className:"font-medium",children:"Categorias"}),t.jsx(f,{className:`h-5 w-5 transform transition-transform ${m.categoria?"":"-rotate-180"}`})]}),m.categoria&&t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"relative",children:[t.jsx(v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:w,onChange:e=>O(e.target.value)})]}),D.map(e=>{var r,n;const s=(r=l.category_id)==null?void 0:r.includes(e.id);return t.jsx("div",{className:`group py-2 rounded-md ${s?"bg-secondary":"bg-transparent"}`,children:t.jsxs("label",{className:"flex items-center space-x-3 ",children:[t.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>h("category_id",e.id),checked:(n=l.category_id)==null?void 0:n.includes(e.id)}),t.jsx("img",{src:`/storage/images/category/${e.image}`,onError:i=>i.target.src="assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"}),t.jsx("span",{children:e.name})]})},e.id)})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("button",{onClick:()=>g("precio"),className:"flex items-center justify-between w-full mb-4",children:[t.jsx("span",{className:"font-medium",children:"Precio"}),t.jsx(f,{className:`h-5 w-5 transform transition-transform ${m.precio?"":"-rotate-180"}`})]}),m.precio&&t.jsx("div",{className:"space-y-3",children:M.map(e=>t.jsxs("label",{className:"flex items-center space-x-3",children:[t.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>h("price",e),checked:l.price&&l.price.min===e.min&&l.price.max===e.max}),t.jsx("span",{children:`S/ ${e.min} - S/ ${e.max}`})]},`${e.min}-${e.max}`))})]})]}),t.jsxs("div",{className:"w-full sm:w-4/5 py-4",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between items-center mb-4 w-full",children:[t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),t.jsx(J,{options:K,placeholder:"Recomendados",onChange:e=>{const[s,r]=e.split(":"),n=[{selector:s,desc:r==="desc"}];u(i=>({...i,sort:n}))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),t.jsx("div",{className:"customtext-primary font-semibold",children:t.jsxs("div",{className:"flex justify-between items-center w-full",children:[t.jsx("div",{className:"customtext-primary font-semibold",children:t.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[t.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(a.currentPage-1),disabled:a.currentPage===1,children:t.jsx(_,{})}),N().map((e,s)=>t.jsx(C.Fragment,{children:e==="..."?t.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):t.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${e===a.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>d(e),children:e})},s)),t.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===a.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(a.currentPage+1),disabled:a.currentPage===a.totalPages,children:t.jsx(S,{})})]})}),t.jsx("div",{children:t.jsxs("p",{className:"font-semibold",children:[a.from," - ",a.to," ","de ",a.totalItems," ","Resultados"]})})]})})]}),I?t.jsx(G,{}):t.jsx("div",{className:"flex items-center flex-wrap gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray(p)&&p.length>0?p.map(e=>t.jsx(Q,{product:e,widthClass:"lg:w-1/3",cart:R,setCart:L},e.id)):t.jsx(H,{})}),t.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[t.jsx("div",{className:"customtext-primary font-semibold",children:t.jsx("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:t.jsx("div",{className:"customtext-primary font-semibold",children:t.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[t.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(a.currentPage-1),disabled:a.currentPage===1,children:t.jsx(_,{})}),N().map((e,s)=>t.jsx(C.Fragment,{children:e==="..."?t.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):t.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${e===a.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>d(e),children:e})},s)),t.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===a.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(a.currentPage+1),disabled:a.currentPage===a.totalPages,children:t.jsx(S,{})})]})})})}),t.jsx("div",{children:t.jsxs("p",{className:"font-semibold",children:[a.from," - ",a.to," de"," ",a.totalItems," Resultados"]})})]})]})]})})})};export{ve as default};
