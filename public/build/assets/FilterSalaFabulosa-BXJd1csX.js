import{j as s}from"./AboutHeader-ClKiNAEV.js";import{r as l,R as P}from"./index-DFv2mRv-.js";import"./ProductCard-NsyC22vv.js";import{I as D}from"./ItemsRest-DK8CnWHO.js";import"./HeaderSearch-fmi4lDBf.js";import{L as T}from"./Loading-O_y8BNFU.js";import{N as U}from"./NoResult-BasQTFzm.js";import{S as G}from"./SelectForm-Ckz_d_he.js";import{P as H}from"./ProductCardSimple-QNvvEyKe.js";import{C as f}from"./chevron-down-Bgb5hLdB.js";import{S as C}from"./search-BlyVC63b.js";import{C as v,a as _}from"./chevron-right--XtiYjfH.js";import"./main-rZoj-gSW.js";import"./___vite-browser-external_commonjs-proxy-BQdpDcDf.js";import"./ModalImportItem-DaJ_kNWW.js";import"./index-BOPJobjj.js";import"./index-Sd7so-oN.js";import"./index-Cevqm-zP.js";import"./CartItemRow-CWsNppc-.js";import"./tippy-react.esm-CGYKl-Jd.js";import"./Number2Currency-e57Tgsuk.js";import"./check-sPmXvS3y.js";import"./createLucideIcon-CC2OGGjd.js";const J=new D,ye=({items:S,data:Q,filteredData:k,cart:$,setCart:R})=>{const{categories:g,brands:F,priceRanges:L}=k,[o,M]=l.useState({marca:!0,precio:!0,categoria:!0,colores:!1}),[c,d]=l.useState({category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[u,A]=l.useState([]),[E,b]=l.useState(!1),[t,I]=l.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),B=e=>{const a=[];if(e.category_id.length>0){const n=e.category_id.map(r=>["category_id","=",r]);a.push(["or",...n])}if(e.subcategory_id.length>0){const n=e.subcategory_id.map(r=>["subcategory_id","=",r]);a.push(["and",...n])}if(e.brand_id.length>0){const n=e.brand_id.map(r=>["brand_id","=",r]);a.push(["or",...n])}return e.price&&a.push(["and",[["final_price",">=",e.price.min],"and",["final_price","<=",e.price.max]]]),e.name&&a.push(["name","contains",e.name]),a},j=async(e=1)=>{b(!0);try{const n={filter:B(c),sort:c.sort,skip:(e-1)*t.itemsPerPage,take:t.itemsPerPage,requireTotalCount:!0},r=await J.paginate(n);A(r.data),I({currentPage:e,totalPages:Math.ceil(r.totalCount/t.itemsPerPage),totalItems:r.totalCount,itemsPerPage:t.itemsPerPage,from:(e-1)*t.itemsPerPage+1,to:Math.min(e*t.itemsPerPage,r.totalCount)})}catch(a){console.error("Error fetching products:",a)}finally{b(!1)}};l.useEffect(()=>{j(t.currentPage)},[c]);const m=e=>{e>=1&&e<=t.totalPages&&j(e)},y=()=>{const e=[],a=t.totalPages,n=t.currentPage,r=2;for(let i=1;i<=a;i++)i===1||i===a||i>=n-r&&i<=n+r?e.push(i):(i===n-r-1||i===n+r+1)&&e.push("...");return e.filter((i,h,z)=>i!=="..."||z[h-1]!=="...")};l.useEffect(()=>{const e=new URLSearchParams(window.location.search),a=e.get("category");if(a){const r=g.find(i=>i.slug===a);r&&d(i=>({...i,category_id:[r.id]}))}const n=e.get("search");n&&d(r=>({...r,name:n}))},[S]);const x=(e,a)=>{d(n=>{if(e==="price")return{...n,price:n.price&&n.price.min===a.min&&n.price.max===a.max?null:a};const r=Array.isArray(n[e])?n[e]:[],i=r.includes(a)?r.filter(h=>h!==a):[...r,a];return{...n,[e]:i}})},p=e=>{M(a=>({...a,[e]:!a[e]}))},K=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[N,O]=l.useState(""),[w,V]=l.useState(""),Z=g.filter(e=>e.name.toLowerCase().includes(N.toLowerCase())),q=F.filter(e=>e.name.toLowerCase().includes(w.toLowerCase()));return s.jsx("section",{className:"py-12  font-font-general customtext-primary",children:s.jsx("div",{className:"mx-auto px-primary",children:s.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"w-full sm:w-1/5 bg-white p-4 rounded-lg h-max",children:[s.jsx("p",{className:"customtext-primary text-2xl font-bold pb-4 mb-4 border-b",children:"Combina como desees tu sala"}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>p("marca"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-semibold text-lg",children:"Marca"}),s.jsx(f,{className:`h-5 w-5 transform transition-transform ${o.marca?"":"-rotate-180"}`})]}),o.marca&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:w,onChange:e=>V(e.target.value)})]}),s.jsx("div",{className:"space-y-3",children:q.map(e=>s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>x("brand_id",e.id)}),s.jsx("span",{children:e.name})]},e.id))})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>p("categoria"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Categoría"}),s.jsx(f,{className:`h-5 w-5 transform transition-transform ${o.categoria?"":"-rotate-180"}`})]}),o.categoria&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:N,onChange:e=>O(e.target.value)})]}),Z.map(e=>{var n,r;const a=(n=c.category_id)==null?void 0:n.includes(e.id);return s.jsx("div",{className:`group py-2 rounded-md ${a?"bg-secondary":"bg-transparent"}`,children:s.jsxs("label",{className:"flex items-center space-x-3 ",children:[s.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>x("category_id",e.id),checked:(r=c.category_id)==null?void 0:r.includes(e.id)}),s.jsx("img",{src:`/storage/images/category/${e.image}`,onError:i=>i.target.src="assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"}),s.jsx("span",{children:e.name})]})},e.id)})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>p("precio"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Precio"}),s.jsx(f,{className:`h-5 w-5 transform transition-transform ${o.precio?"":"-rotate-180"}`})]}),o.precio&&s.jsx("div",{className:"space-y-3",children:L.map(e=>s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>x("price",e),checked:c.price&&c.price.min===e.min&&c.price.max===e.max}),s.jsx("span",{children:`S/ ${e.min} - S/ ${e.max}`})]},`${e.min}-${e.max}`))})]})]}),s.jsxs("div",{className:"w-full sm:w-4/5 py-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4 w-full",children:[s.jsxs("div",{className:"flex gap-4 items-center",children:[s.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),s.jsx(G,{options:K,placeholder:"Recomendados",onChange:e=>{const[a,n]=e.split(":"),r=[{selector:a,desc:n==="desc"}];d(i=>({...i,sort:r}))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[s.jsx("button",{className:`p-4 inline-flex items-center ${t.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>m(t.currentPage-1),disabled:t.currentPage===1,children:s.jsx(v,{})}),y().map((e,a)=>s.jsx(P.Fragment,{children:e==="..."?s.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):s.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${e===t.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>m(e),children:e})},a)),s.jsx("button",{className:`p-4 inline-flex items-center ${t.currentPage===t.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>m(t.currentPage+1),disabled:t.currentPage===t.totalPages,children:s.jsx(_,{})})]})}),s.jsx("div",{children:s.jsxs("p",{className:"font-semibold",children:[t.from," - ",t.to," ","de ",t.totalItems," ","Resultados"]})})]})})]}),E?s.jsx(T,{}):s.jsx("div",{className:"flex items-center flex-wrap gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray(u)&&u.length>0?u.map(e=>s.jsx(H,{product:e,widthClass:"lg:w-1/3",cart:$,setCart:R},e.id)):s.jsx(U,{})}),s.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsx("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[s.jsx("button",{className:`p-4 inline-flex items-center ${t.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>m(t.currentPage-1),disabled:t.currentPage===1,children:s.jsx(v,{})}),y().map((e,a)=>s.jsx(P.Fragment,{children:e==="..."?s.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):s.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${e===t.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>m(e),children:e})},a)),s.jsx("button",{className:`p-4 inline-flex items-center ${t.currentPage===t.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>m(t.currentPage+1),disabled:t.currentPage===t.totalPages,children:s.jsx(_,{})})]})})})}),s.jsx("div",{children:s.jsxs("p",{className:"font-semibold",children:[t.from," - ",t.to," de"," ",t.totalItems," Resultados"]})})]})]})]})})})};export{ye as default};
