var Z=Object.defineProperty;var z=(d,o,n)=>o in d?Z(d,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):d[o]=n;var _=(d,o,n)=>z(d,typeof o!="symbol"?o+"":o,n);import{j as a}from"./AboutHeader-COUW3Uy_.js";import{r as l}from"./index-CqkZ-sT_.js";import"./ProductCard-DppMoL6U.js";import{I as D}from"./ItemsRest-COC0wVJZ.js";import{L as H,N as J}from"./NoResult-CROInX6p.js";import{S as U}from"./SelectForm-B3_ZzKEz.js";import{P as q}from"./ProductCardScraping-CVJALr5M.js";import{m as y}from"./main-CkMzf7wF.js";import{F as G}from"./filter-CawzT8aa.js";import{C as j}from"./chevron-down-CxOx8ByU.js";import{S as P}from"./search-DhoFIDMi.js";import"./BasicEditing-CqE15M_Q.js";import"./check-CvqheCNB.js";import"./createLucideIcon-D0vxYqnu.js";import"./index.esm-DfKMpHf8.js";import"./___vite-browser-external_commonjs-proxy-DA7w84js.js";class S{}_(S,"getProducts",async o=>{console.log(o);try{const{status:n,result:u}=await y.Fetch("./api/scrap-nike",{method:"POST",body:JSON.stringify(o)});return n||console.log((u==null?void 0:u.message)||"Error al obtener datos"),y.Notify.add({icon:"/assets/img/icon.svg",title:"Operacion correcta",body:"Se obtuvo correctamente el precio de envio"}),u}catch(n){return y.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:n.message,type:"danger"}),!1}});const Q=new D,xe=({items:d,data:o,filteredData:n,cart:u,setCart:k})=>{const{categories:N,brands:F,priceRanges:E}=n,[p,L]=l.useState({marca:!0,precio:!0,categoria:!0,colores:!1}),[i,f]=l.useState({category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[h,w]=l.useState([]),[A,x]=l.useState(!1),[W,M]=l.useState({currentPage:1,totalPages:1}),$=e=>{const s=[];if(e.category_id.length>0){const r=e.category_id.map(t=>["category_id","=",t]);s.push(["or",...r])}if(e.subcategory_id.length>0){const r=e.subcategory_id.map(t=>["subcategory_id","=",t]);s.push(["and",...r])}if(e.brand_id.length>0){const r=e.brand_id.map(t=>["brand_id","=",t]);s.push(["or",...r])}return e.price&&s.push(["and",[["final_price",">=",e.price.min],"and",["final_price","<=",e.price.max]]]),e.name&&s.push(["name","contains",e.name]),s},B=async(e=1)=>{x(!0);try{const r={filter:$(i),sort:i.sort,take:20},t=await Q.paginate(r);w(t.data),M({currentPage:t.currentPage,totalPages:t.lastPage})}catch(s){console.error("Error fetching products:",s)}finally{x(!1)}};l.useEffect(()=>{B()},[i]);const R=async(e,s)=>{if(!e){alert("Por favor, ingresa un término de búsqueda");return}x(!0);try{const r=await S.getProducts({query:e,proveedor:s});w(r.data),console.log(r.data)}catch(r){console.error("Error:",r),alert("Hubo un error al realizar la búsqueda. Por favor, intenta nuevamente.")}finally{x(!1)}};l.useEffect(()=>{const e=new URLSearchParams(window.location.search),s=e.get("category");if(s){const c=N.find(m=>m.slug===s);c&&f(m=>({...m,category_id:[c.id]}))}const r=e.get("search"),t=e.get("provider");r&&R(r,t)},[d]);const g=(e,s)=>{f(r=>{if(e==="price")return{...r,price:r.price&&r.price.min===s.min&&r.price.max===s.max?null:s};const t=Array.isArray(r[e])?r[e]:[],c=t.includes(s)?t.filter(m=>m!==s):[...t,s];return{...r,[e]:c}})},b=e=>{L(s=>({...s,[e]:!s[e]}))},O=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[v,I]=l.useState(""),[C,K]=l.useState(""),T=N.filter(e=>e.name.toLowerCase().includes(v.toLowerCase())),V=F.filter(e=>e.name.toLowerCase().includes(C.toLowerCase()));return a.jsx("section",{className:"py-12 bg-[#F7F9FB] font-font-general",children:a.jsxs("div",{className:"mx-auto px-primary",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8 pb-4 border-b-2",children:[a.jsx("h2",{className:"text-4xl font-bold w-6/12",children:"Todos los productos"}),a.jsxs("div",{className:"flex items-center gap-4 w-5/12",children:[a.jsxs("span",{className:"block w-6/12",children:["Productos seleccionados: ",a.jsx("strong",{children:h==null?void 0:h.length})]}),a.jsx("div",{className:"w-6/12",children:a.jsx(U,{options:O,placeholder:"Ordenar por",onChange:e=>{const[s,r]=e.split(":"),t=[{selector:s,desc:r==="desc"}];f(c=>({...c,sort:t}))},labelKey:"label",valueKey:"value"})})]})]}),a.jsxs("div",{className:"relative flex gap-4",children:[a.jsxs("div",{className:"w-3/12 bg-white p-4 rounded-lg h-max",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),a.jsx(G,{className:"h-5 w-5"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("button",{onClick:()=>b("marca"),className:"flex items-center justify-between w-full mb-4",children:[a.jsx("span",{className:"font-medium",children:"Marca"}),a.jsx(j,{className:`h-5 w-5 transform transition-transform ${p.marca?"":"-rotate-180"}`})]}),p.marca&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:C,onChange:e=>K(e.target.value)})]}),a.jsx("div",{className:"space-y-3",children:V.map(e=>a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>g("brand_id",e.id)}),a.jsx("span",{children:e.name})]},e.id))})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("button",{onClick:()=>b("precio"),className:"flex items-center justify-between w-full mb-4",children:[a.jsx("span",{className:"font-medium",children:"Precio"}),a.jsx(j,{className:`h-5 w-5 transform transition-transform ${p.precio?"":"-rotate-180"}`})]}),p.precio&&a.jsx("div",{className:"space-y-3",children:E.map(e=>a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>g("price",e),checked:i.price&&i.price.min===e.min&&i.price.max===e.max}),a.jsx("span",{children:`S/ ${e.min} - S/ ${e.max}`})]},`${e.min}-${e.max}`))})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("button",{onClick:()=>b("categoria"),className:"flex items-center justify-between w-full mb-4",children:[a.jsx("span",{className:"font-medium",children:"Categoría"}),a.jsx(j,{className:`h-5 w-5 transform transition-transform ${p.categoria?"":"-rotate-180"}`})]}),p.categoria&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:v,onChange:e=>I(e.target.value)})]}),T.map(e=>{var s,r,t;return a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>g("category_id",e.id),checked:(s=i.category_id)==null?void 0:s.includes(e.id)}),a.jsx("span",{children:e.name})]}),((r=i.category_id)==null?void 0:r.includes(e.id))&&((t=e.subcategories)==null?void 0:t.length)>0&&a.jsx("ul",{className:"ml-6 mt-2 space-y-2",children:e.subcategories.map(c=>{var m;return a.jsxs("label",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>g("subcategory_id",c.id),checked:(m=i.subcategory_id)==null?void 0:m.includes(c.id)}),a.jsx("span",{children:c.name})]},c.id)})})]},e.id)})]})]}),a.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl hover:brightness-90 transition-colors text-sm font-bold",children:"Aplicar Filtro"})]}),a.jsx("div",{className:"w-9/12",children:A?a.jsx(H,{}):a.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:Array.isArray(h)&&h.length>0?h.map(e=>a.jsx(q,{product:e,widthClass:"lg:w-1/3",cart:u,setCart:k},e.id)):a.jsx(J,{})})})]})]})})};export{xe as default};
