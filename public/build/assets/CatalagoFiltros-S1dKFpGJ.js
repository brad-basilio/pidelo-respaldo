import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as n,R as ee}from"./index-BH53Isel.js";import{C as se}from"./ProductNavigation-BuCk53LU.js";import{I as te}from"./ItemsRest-BIADNguh.js";import{N as ae}from"./NoResult-C9qZVva5.js";import{S as re}from"./SelectForm-G0J6yhhv.js";import{m as p}from"./main-BvVILmTO.js";import{F as B}from"./filter-Ci9tsc_e.js";import{X as le}from"./x-DBMwyD6F.js";import{C as b}from"./chevron-down-DS-mdh9v.js";import{S as y}from"./search-TwiiKGP5.js";import{m}from"./proxy-BTYtmp9V.js";import{A as ie}from"./index-CFtDjG4d.js";import{C as ne}from"./chevron-left-B2s3ZsB7.js";import{C as oe}from"./chevron-right-Ckt5D2ka.js";import"./index-yBjzXJbu.js";import"./ProductCard-erObE6pO.js";import"./HeaderSearch-DiN9TfNr.js";import"./index-Bv81MoWS.js";import"./index-fNjTmf9T.js";import"./index-Chjiymov.js";import"./CartItemRow-BhtCHp_j.js";import"./tippy-react.esm-BWiGTO87.js";import"./index-rimy3MAc.js";import"./Number2Currency-e57Tgsuk.js";import"./minus-jyhodMPN.js";import"./createLucideIcon-Cy5Ya80P.js";import"./plus-Bot15Khs.js";import"./BasicRest-C_0LADdJ.js";import"./check-DQ7QoS0v.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";const ce=new te,me=()=>e.jsx("div",{className:"group  animate-pulse  transition-transform duration-300 hover:scale-105 w-1/2 lg:w-1/4 flex-shrink-0 font-font-general customtext-primary cursor-pointer",children:e.jsx("div",{className:" px-4",children:e.jsx("div",{className:"bg-white rounded-3xl",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"aspect-square bg-gray-300 rounded-3xl overflow-hidden flex items-center justify-center  bg-secondary",children:e.jsx("svg",{class:"w-10 h-10 text-gray-200 ","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 18",children:e.jsx("path",{d:"M18 0H2a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm-5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm4.376 10.481A1 1 0 0 1 16 15H4a1 1 0 0 1-.895-1.447l3.5-7A1 1 0 0 1 7.468 6a.965.965 0 0 1 .9.5l2.775 4.757 1.546-1.887a1 1 0 0 1 1.618.1l2.541 4a1 1 0 0 1 .028 1.011Z"})})})})})})}),Ve=({items:F,data:g,filteredData:de,cart:R,setCart:E})=>{const[A,M]=n.useState([]),[w,L]=n.useState([]),[N,T]=n.useState([]),[H,G]=n.useState([]),[d,I]=n.useState({marca:!0,precio:!0,categoria:!0,subcategoria:!0,colores:!1}),[c,x]=n.useState({collection_id:[p.GET.collection].filter(Boolean),category_id:[p.GET.category].filter(Boolean),brand_id:[p.GET.brand].filter(Boolean),subcategory_id:[p.GET.subcategory].filter(Boolean),price:null,name:p.GET.search||null,sort_by:"created_at",order:"desc"}),[u,Z]=n.useState([]),[O,v]=n.useState(!0),[i,V]=n.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:24,from:0,to:0}),q=s=>{const a=[];if(s.collection_id.length>0){const r=s.collection_id.map(t=>["collection_id","=",t]);a.push(["or",...r])}if(s.category_id.length>0){const r=s.category_id.map(t=>["category.slug","=",t]);a.push(["or",...r])}if(s.subcategory_id.length>0){const r=s.subcategory_id.map(t=>["subcategory.slug","=",t]);a.push(["or",...r])}if(s.brand_id.length>0){const r=s.brand_id.map(t=>["brand_id","=",t]);a.push(["or",...r])}return s.price&&a.push(["or",[["final_price",">=",s.price.min],"and",["final_price","<=",s.price.max]]]),s.name&&a.push(["name","contains",s.name]),a},C=async(s=1)=>{v(!0);try{const r={filter:q(c),sort:c.sort,skip:(s-1)*i.itemsPerPage,take:i.itemsPerPage,requireTotalCount:!0};console.log(r);const t=await ce.paginate(r);console.log(t),Z(t.data),V({currentPage:s,totalPages:Math.ceil(t.totalCount/i.itemsPerPage),totalItems:t.totalCount,itemsPerPage:i.itemsPerPage,from:(s-1)*i.itemsPerPage+1,to:Math.min(s*i.itemsPerPage,t.totalCount)}),console.log(t),M(t==null?void 0:t.summary.brands),T(t==null?void 0:t.summary.categories),L(t==null?void 0:t.summary.subcategories),G(t==null?void 0:t.summary.priceRanges)}catch(a){console.log("Error fetching products:",a)}finally{v(!1)}};n.useEffect(()=>{const s=new URLSearchParams(window.location.search),a=s.get("category"),r=s.get("subcategory");s.get("collection");const t=s.get("search");if(s.get("campaign"),s.get("sort"),a){const l=N.find(o=>o.slug===a);l&&x(o=>({...o,category_id:[l.id]}))}if(r){const l=w.find(o=>o.slug===r);l&&x(o=>({...o,subcategory_id:[l.id]}))}t&&x(l=>({...l,name:t}))},[null]),n.useEffect(()=>{console.log("selectd filters",F),C(i.currentPage)},[c]);const j=s=>{s>=1&&s<=i.totalPages&&C(s)},D=()=>{const s=[],a=i.totalPages,r=i.currentPage,t=2;for(let l=1;l<=a;l++)l===1||l===a||l>=r-t&&l<=r+t?s.push(l):(l===r-t-1||l===r+t+1)&&s.push("...");return s.filter((l,o,Y)=>l!=="..."||Y[o-1]!=="...")},K=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],h=(s,a)=>{x(r=>{if(s==="price")return{...r,price:r.price&&r.price.min===a.min&&r.price.max===a.max?null:a};const t=Array.isArray(r[s])?r[s]:[],l=t.includes(a)?t.filter(o=>o!==a):[...t,a];return{...r,[s]:l}})},f=s=>{I(a=>({...a,[s]:!a[s]}))},[P,z]=n.useState(""),[S,U]=n.useState(""),[_,X]=n.useState(""),J=N.filter(s=>s.name.toLowerCase().includes(P.toLowerCase())),Q=w.filter(s=>s.name.toLowerCase().includes(S.toLowerCase())),W=A.filter(s=>s.name.toLowerCase().includes(_.toLowerCase())),[k,$]=n.useState(!1);return e.jsx("section",{className:"py-12 bg-sections-color customtext-neutral-dark",children:e.jsxs("div",{className:"mx-auto px-primary 2xl:px-0 2xl:max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between items-center mb-8 pb-4 border-b-2",children:[e.jsx("h2",{className:"text-[32px] md:text-4xl font-bold md:w-6/12",children:g==null?void 0:g.title}),e.jsxs("div",{className:"flex items-center gap-4 md:w-5/12",children:[e.jsxs("span",{className:"block w-6/12",children:["Productos seleccionados:"," ",e.jsx("strong",{children:u==null?void 0:u.length})]}),e.jsx("div",{className:"w-6/12",children:e.jsx(re,{options:K,placeholder:"Ordenar por",onChange:s=>{const[a,r]=s.split(":"),t=[{selector:a,desc:r==="desc"}];x(l=>({...l,sort:t}))},labelKey:"label",valueKey:"value"})})]})]}),e.jsxs("div",{className:"relative flex flex-col lg:flex-row gap-4",children:[e.jsxs("button",{className:"w-full flex lg:hidden gap-2 items-center",onClick:()=>$(!0),children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Filtros"}),e.jsx(B,{className:"h-5 w-5"})]}),e.jsxs("div",{className:`${k?"fixed inset-0 z-50 bg-white p-4 overflow-y-auto":"hidden"} lg:block lg:w-3/12 bg-white p-4 rounded-lg h-max`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsx(B,{className:"hidden lg:block h-5 w-5"}),e.jsx("button",{className:" lg:hidden ",onClick:()=>$(!k),children:e.jsx(le,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>f("marca"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Marca"}),e.jsx(b,{className:`h-5 w-5 transform transition-transform ${d.marca?"":"-rotate-180"}`})]}),d.marca&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:_,onChange:s=>X(s.target.value)})]}),e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:W.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 customtext-neutral-light",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>h("brand_id",s.id)}),e.jsx("span",{children:s.name})]},s.id))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>f("categoria"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Categoría"}),e.jsx(b,{className:`h-5 w-5 transform transition-transform ${d.categoria?"":"-rotate-180"}`})]}),d.categoria&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:P,onChange:s=>z(s.target.value)})]}),e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:J.map(s=>{var a,r,t;return e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-3 customtext-neutral-light",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>h("category_id",s.id),checked:(a=c.category_id)==null?void 0:a.includes(s.id)}),e.jsx("span",{children:s.name})]}),((r=c.category_id)==null?void 0:r.includes(s.id))&&((t=s.subcategories)==null?void 0:t.length)>0&&e.jsx("ul",{className:"ml-6 mt-2 space-y-2",children:s.subcategories.map(l=>{var o;return e.jsxs("label",{className:"flex items-center space-x-3 customtext-neutral-light",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>h("subcategory_id",l.id),checked:(o=c.subcategory_id)==null?void 0:o.includes(l.id)}),e.jsx("span",{children:l.name})]},l.id)})})]},s.id)})})]})]}),e.jsxs(m.div,{className:"mb-6",children:[e.jsxs(m.button,{onClick:()=>f("subcategoria"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[e.jsx("span",{className:"font-medium",children:"Sub Categorías"}),e.jsx(b,{className:`h-5 w-5 transform transition-transform ${d.subcategoria?"":"-rotate-180"}`})]}),e.jsx(ie,{children:d.subcategoria&&e.jsxs(m.div,{className:"space-y-1",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:[e.jsxs(m.div,{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0 transition-all duration-300",value:S,onChange:s=>U(s.target.value)})]}),Q.map(s=>{var r;const a=(r=c.subcategory_id)==null?void 0:r.includes(s.id);return e.jsx(m.div,{className:`group py-2 rounded-md ${a?"bg-primary ":"bg-transparent"}`,children:e.jsxs("label",{className:"flex items-center justify-between space-x-3 px-4 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"hidden",onChange:()=>h("subcategory_id",s.id),checked:a}),e.jsx("span",{className:`${a?"text-white":"text-gray-700"}`,children:s.name})]})},s.id)})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>f("precio"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(b,{className:`h-5 w-5 transform transition-transform ${d.precio?"":"-rotate-180"}`})]}),d.precio&&e.jsx("div",{className:"space-y-3",children:H.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 customtext-neutral-light",children:[e.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>h("price",s),checked:c.price&&c.price.min===s.min&&c.price.max===s.max}),e.jsx("span",{children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`))})]})]}),e.jsxs("div",{className:"w-full lg:w-9/12 py-4",children:[O?e.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(s=>e.jsx(me,{},s))}):e.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:Array.isArray(u)&&u.length>0?u.map(s=>e.jsx("div",{className:"   w-1/2 lg:w-1/3 xl:w-1/4 lg:h-[460px] lg:max-h-[460px]  xl:h-[400px] xl:max-h-[400px] 2xl:h-[430px] 2xl:max-h-[430px] flex items-center justify-center",children:e.jsx(se,{data:g,product:s,widthClass:"w-full sm:w-full lg:w-full",cart:R,setCart:E})},s.id)):e.jsx(ae,{})}),e.jsxs(m.div,{className:"flex justify-between items-center mb-4 w-full mt-8",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[e.jsx(m.button,{className:`p-4 inline-flex items-center ${i.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>j(i.currentPage-1),disabled:i.currentPage===1,whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx(ne,{})}),D().map((s,a)=>e.jsx(ee.Fragment,{children:s==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx(m.button,{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                                        ${s===i.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>j(s),whileHover:{scale:1.05},whileTap:{scale:.95},children:s})},a)),e.jsx(m.button,{className:`p-4 inline-flex items-center ${i.currentPage===i.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>j(i.currentPage+1),disabled:i.currentPage===i.totalPages,whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx(oe,{})})]})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[i.from," - ",i.to," de"," ",i.totalItems," Resultados"]})})]})]})]})]})})};export{Ve as default};
