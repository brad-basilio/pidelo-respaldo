var w=Object.defineProperty;var R=(s,t,a)=>t in s?w(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var b=(s,t,a)=>R(s,typeof t!="symbol"?t+"":t,a);import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as u}from"./index-BH53Isel.js";import{c as C}from"./ReactAppend-DTVVXReZ.js";import{i as E}from"./tippy-react.esm-BWiGTO87.js";/* empty css              */import{m as i}from"./main-BvVILmTO.js";import{C as S}from"./CreateReactScript-Bq8gMpEh.js";import{I as y}from"./InputFormGroup-D5I6zpZc.js";import{B as F}from"./Base-eMlfXmua.js";import"./index-yBjzXJbu.js";import"./index-fNjTmf9T.js";import"./index-rimy3MAc.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./index.esm-CveLAcri.js";import"./Global-ErywZRdd.js";/* empty css               */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";import"./Logout-7s5dsuEK.js";import"./MenuItemContainer-BwGvRAHs.js";class g{}b(g,"save",async t=>{try{const{status:a,result:r}=await i.Fetch("/api/admin/profile",{method:"PATCH",body:JSON.stringify(t)});if(!a)throw new Error((r==null?void 0:r.message)||"Ocurrio un error inesperado");return i.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:r.message,type:"success"}),!0}catch(a){return i.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:a.message,type:"danger"}),!1}});const P=s=>{const t=u.useRef(),a=u.useRef(),[r,p]=u.useState(s.session),v=async c=>{c.preventDefault();const o={name:t.current.value,lastname:a.current.value};if(!await g.save(o))return;const n=structuredClone(r);n.name=o.name,n.lastname=o.lastname,n.birthdate=o.birthdate,p(n)},j=async c=>{const o=c.target.files[0];if(o)try{const{full:l,thumbnail:n,type:f,ok:N}=await File.compress(o);if(!N)throw new Error("Ocurrio un error al comprimir la imagen. Intenta con otra.");const d=new FormData;d.append("thumbnail",await File.fromURL(`data:${f};base64,${n}`)),d.append("full",await File.fromURL(`data:${f};base64,${l}`));const h=await fetch("/api/admin/profile",{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(i.Cookies.get("XSRF-TOKEN"))},body:d}),m=i.JSON.parseable(await h.text());if(!h.ok)throw new Error((m==null?void 0:m.message)??"Ocurrio un error inesperado");const x=structuredClone(r);x.relative_id=m.data.relative_id,p(x),i.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:"La imagen de perfil se actualizo correctamente",type:"success"})}catch(l){i.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:l.message,type:"danger"})}};return e.jsx("div",{className:"row justify-content-center align-items-center",style:{height:"calc(100vh - 135px)"},children:e.jsx("div",{className:"col-xl-3 col-lg-4 col-md-6 col-sm-8 col-xs-12",children:e.jsxs("form",{className:"card",onSubmit:v,children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"card-title mb-0",children:"Perfil"})}),e.jsxs("div",{className:"card-body",children:[e.jsx(E,{content:"Cambiar foto de perfil",arrow:!0,children:e.jsxs("label",{htmlFor:"avatar",className:"rounded-circle mx-auto d-block",style:{cursor:"pointer",width:"max-content"},children:[e.jsx("input",{className:"d-none",type:"file",name:"avatar",id:"avatar",accept:"image/*",onChange:j}),e.jsx("img",{className:"avatar-xl rounded-circle",src:`/api/admin/profile/${r.relative_id}`,alt:`Perfil de ${r.name} ${r.lastname}`,style:{objectFit:"cover",objectPosition:"center"},onError:c=>c.target.src="/api/cover/thumbnail/null"})]})}),e.jsx("hr",{className:"mt-3 mb-2"}),e.jsx(y,{eRef:t,label:"Nombres",value:r.name,required:!0}),e.jsx(y,{eRef:a,label:"Apellidos",value:r.lastname,required:!0}),e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"btn btn-primary btn-block",type:"submit",children:[e.jsx("i",{className:"fa fa-save"})," Actualizar"]})}),e.jsx("hr",{className:"mt-3 mb-2"}),e.jsx("p",{className:"card-text text-center",children:e.jsxs("small",{className:"text-muted",children:["Ultima actualizacion"," ",moment(r.updated_at).fromNow()]})})]})]})})})};S((s,t)=>{C.createRoot(s).render(e.jsx(F,{...t,title:"Perfil de usuario",children:e.jsx(P,{...t})}))});
