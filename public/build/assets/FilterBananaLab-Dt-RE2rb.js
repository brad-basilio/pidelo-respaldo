import{j as t}from"./AboutSimple-Cf8x2fCZ.js";import{r as d,R as $}from"./index-BH53Isel.js";import{I as Y}from"./ItemsRest-CIxFJbfu.js";import{L as ee}from"./Loading-B-FwDSWi.js";import{N as te}from"./NoResult-C9qZVva5.js";import{S as ae}from"./SelectForm-G0J6yhhv.js";import{C as se}from"./CardProductBananaLab-Co5VMoCh.js";import{m as r}from"./proxy-BTYtmp9V.js";import{C as f}from"./chevron-down-DS-mdh9v.js";import{A as b}from"./index-CFtDjG4d.js";import{S as H}from"./search-TwiiKGP5.js";import{C as R}from"./chevron-left-B2s3ZsB7.js";import{C as L}from"./chevron-right-Ckt5D2ka.js";import"./index-yBjzXJbu.js";import"./main-BSEyQEJW.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./ModalImportItem-DX0jV3py.js";import"./check-DQ7QoS0v.js";import"./createLucideIcon-Cy5Ya80P.js";import"./ProductCard-C2H10lUi.js";import"./HeaderSearch-Cpa753QT.js";import"./index-Bv81MoWS.js";import"./index-fNjTmf9T.js";import"./index-Chjiymov.js";import"./CartItemRow-wjCZuSxN.js";import"./tippy-react.esm-BWiGTO87.js";import"./index-rimy3MAc.js";import"./Number2Currency-e57Tgsuk.js";import"./minus-jyhodMPN.js";import"./plus-Bot15Khs.js";import"./index-CMHsc23u.js";import"./HeaderBananaLab-C4EYtzjC.js";/* empty css              */import"./trash-2-DK1wnsDn.js";import"./shopping-bag-CoWGrL8C.js";import"./x-DBMwyD6F.js";import"./shopping-cart-CZEUxbmv.js";import"./arrow-right-DR00rP9v.js";import"./heart-ChuvJi-4.js";import"./circle-check-big-D6DM3vPb.js";const E=new Y,De=({items:F,data:ie,filteredData:M,cart:A,setCart:B})=>{const{collections:I,categories:v,brands:T,priceRanges:z}=M,[w,N]=d.useState([]),[u,y]=d.useState({collection:!0,marca:!0,precio:!0,categoria:!0,subcategoria:!1,colores:!1}),[c,p]=d.useState({collection_id:[],category_id:[],subcategory_id:[],brand_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[j,K]=d.useState([]),[O,P]=d.useState(!1),[i,U]=d.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),V={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.5}}},l={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.3}}},Z={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}};d.useEffect(()=>{(async()=>{if(c.category_id.length>0)try{const a=await E.getSubcategories({category_id:c.category_id[0]});N(a),y(s=>({...s,subcategoria:!0}))}catch(a){console.error("Error fetching subcategories:",a)}else N([]),p(a=>({...a,subcategory_id:[]})),y(a=>({...a,subcategoria:!1}))})()},[c.category_id]);const q=e=>{const a=[];if(e.collection_id.length>0){const s=e.collection_id.map(n=>["collection_id","=",n]);a.push(["or",...s])}if(e.category_id.length>0){const s=e.category_id.map(n=>["category_id","=",n]);a.push(["or",...s])}if(e.subcategory_id.length>0){const s=e.subcategory_id.map(n=>["subcategory_id","=",n]);a.push(["or",...s])}if(e.brand_id.length>0){const s=e.brand_id.map(n=>["brand_id","=",n]);a.push(["or",...s])}return e.price&&a.push(["and",[["final_price",">=",e.price.min],"and",["final_price","<=",e.price.max]]]),e.name&&a.push(["name","contains",e.name]),a},C=async(e=1)=>{P(!0);try{const s={filter:q(c),sort:c.sort,skip:(e-1)*i.itemsPerPage,take:i.itemsPerPage,requireTotalCount:!0},n=await E.paginate(s);K(n.data),U({currentPage:e,totalPages:Math.ceil(n.totalCount/i.itemsPerPage),totalItems:n.totalCount,itemsPerPage:i.itemsPerPage,from:(e-1)*i.itemsPerPage+1,to:Math.min(e*i.itemsPerPage,n.totalCount)})}catch(a){console.error("Error fetching products:",a)}finally{P(!1)}};d.useEffect(()=>{C(i.currentPage)},[c]);const h=e=>{e>=1&&e<=i.totalPages&&C(e)},_=()=>{const e=[],a=i.totalPages,s=i.currentPage,n=2;for(let o=1;o<=a;o++)o===1||o===a||o>=s-n&&o<=s+n?e.push(o):(o===s-n-1||o===s+n+1)&&e.push("...");return e.filter((o,m,X)=>o!=="..."||X[m-1]!=="...")};d.useEffect(()=>{const e=new URLSearchParams(window.location.search),a=e.get("category"),s=e.get("collection"),n=e.get("search");if(a){const o=v.find(m=>m.slug===a);o&&p(m=>({...m,category_id:[o.id]}))}if(s){const o=I.find(m=>m.slug===s);o&&p(m=>({...m,collection_id:[o.id]}))}n&&p(o=>({...o,name:n}))},[F]);const x=(e,a)=>{p(s=>{if(e==="price")return{...s,price:s.price&&s.price.min===a.min&&s.price.max===a.max?null:a};const n=Array.isArray(s[e])?s[e]:[],o=n.includes(a)?n.filter(m=>m!==a):[...n,a];return{...s,[e]:o}})},g=e=>{y(a=>({...a,[e]:!a[e]}))},D=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[k,G]=d.useState(""),[re,ne]=d.useState(""),[S,J]=d.useState(""),Q=v.filter(e=>e.name.toLowerCase().includes(k.toLowerCase())),W=T.filter(e=>e.name.toLowerCase().includes(S.toLowerCase()));return t.jsx(r.section,{initial:"hidden",animate:"visible",variants:V,className:"py-6 customtext-neutral-dark font-paragraph",children:t.jsx("div",{className:"mx-auto px-primary",children:t.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[t.jsxs(r.div,{className:"w-full sm:w-1/5 bg-white p-4 rounded-lg h-max shadow-sm",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2},children:[t.jsx("p",{className:"customtext-neutral-dark text-2xl font-bold pb-4 mb-4 border-b",children:"Escoge el regalo y personaliza"}),t.jsxs(r.div,{className:"mb-6",variants:l,children:[t.jsxs(r.button,{onClick:()=>g("categoria"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[t.jsx("span",{className:"font-medium",children:"Categorías"}),t.jsx(f,{className:`h-5 w-5 transform transition-transform ${u.categoria?"":"-rotate-180"}`})]}),t.jsx(b,{children:u.categoria&&t.jsxs(r.div,{className:"space-y-1",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:[t.jsxs(r.div,{className:"relative",variants:l,children:[t.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0 transition-all duration-300",value:k,onChange:e=>G(e.target.value)})]}),Q.map(e=>{var s;const a=(s=c.category_id)==null?void 0:s.includes(e.id);return t.jsx(r.div,{className:`group py-2 rounded-md ${a?"bg-primary brightness-125":"bg-transparent"}`,variants:l,children:t.jsxs("label",{className:"flex items-center justify-between space-x-3 px-4 cursor-pointer",children:[t.jsx("input",{type:"checkbox",className:"hidden",onChange:()=>x("category_id",e.id),checked:a}),t.jsx("img",{src:`/storage/images/category/${e.image}`,onError:n=>n.target.src="assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover order-1",loading:"lazy"}),t.jsx("span",{className:`${a?"text-white":"text-gray-700"}`,children:e.name})]})},e.id)})]})})]}),w.length>0&&t.jsxs(r.div,{className:"mb-6",variants:l,children:[t.jsxs(r.button,{onClick:()=>g("subcategoria"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[t.jsx("span",{className:"font-medium",children:"Subcategorías"}),t.jsx(f,{className:`h-5 w-5 transform transition-transform ${u.subcategoria?"":"-rotate-180"}`})]}),t.jsx(b,{children:u.subcategoria&&t.jsx(r.div,{className:"space-y-1 pl-8",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:w.map(e=>{var s;const a=(s=c.subcategory_id)==null?void 0:s.includes(e.id);return t.jsx(r.div,{className:`group py-2 rounded-md ${a?"bg-primary/10":"bg-transparent"}`,variants:l,children:t.jsxs("label",{className:"flex items-center space-x-3 px-4 cursor-pointer",children:[t.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",onChange:()=>x("subcategory_id",e.id),checked:a}),t.jsx("span",{className:`${a?"font-medium text-primary":"text-gray-600"}`,children:e.name})]})},e.id)})})})]}),t.jsxs(r.div,{className:"mb-6",variants:l,children:[t.jsxs(r.button,{onClick:()=>g("precio"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[t.jsx("span",{className:"font-medium",children:"Precio"}),t.jsx(f,{className:`h-5 w-5 transform transition-transform ${u.precio?"":"-rotate-180"}`})]}),t.jsx(b,{children:u.precio&&t.jsx(r.div,{className:"space-y-3",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:z.map(e=>{const a=c.price&&c.price.min===e.min&&c.price.max===e.max;return t.jsxs(r.label,{className:"flex items-center space-x-3 cursor-pointer",variants:l,whileHover:{x:3},children:[t.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",onChange:()=>x("price",e),checked:a}),t.jsx("span",{className:`${a?"font-medium text-primary":"text-gray-600"}`,children:`S/ ${e.min} - S/ ${e.max}`})]},`${e.min}-${e.max}`)})})})]}),t.jsxs(r.div,{className:"mb-6",variants:l,children:[t.jsxs(r.button,{onClick:()=>g("marca"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[t.jsx("span",{className:"font-medium",children:"Marcas"}),t.jsx(f,{className:`h-5 w-5 transform transition-transform ${u.marca?"":"-rotate-180"}`})]}),t.jsx(b,{children:u.marca&&t.jsxs(r.div,{className:"space-y-1",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:[t.jsxs(r.div,{className:"relative",variants:l,children:[t.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0 transition-all duration-300",value:S,onChange:e=>J(e.target.value)})]}),W.map(e=>{var s;const a=(s=c.brand_id)==null?void 0:s.includes(e.id);return t.jsx(r.div,{className:`group py-2 rounded-md ${a?"bg-primary/10":"bg-transparent"}`,variants:l,children:t.jsxs("label",{className:"flex items-center space-x-3 px-4 cursor-pointer",children:[t.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",onChange:()=>x("brand_id",e.id),checked:a}),t.jsx("span",{className:`${a?"font-medium text-primary":"text-gray-600"}`,children:e.name})]})},e.id)})]})})]})]}),t.jsxs(r.div,{className:"w-full sm:w-4/5 py-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[t.jsxs(r.div,{className:"flex flex-col lg:flex-row lg:justify-between items-center mb-4 w-full",variants:l,children:[t.jsxs("div",{className:"flex gap-4 items-center mb-4 lg:mb-0",children:[t.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),t.jsx(ae,{options:D,placeholder:"Recomendados",onChange:e=>{const[a,s]=e.split(":"),n=[{selector:a,desc:s==="desc"}];p(o=>({...o,sort:n}))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),t.jsx("div",{className:"customtext-primary font-semibold",children:t.jsxs("div",{className:"flex justify-between items-center w-full",children:[t.jsx("div",{className:"customtext-primary font-semibold",children:t.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[t.jsx(r.button,{className:`p-4 inline-flex items-center ${i.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>h(i.currentPage-1),disabled:i.currentPage===1,whileHover:{scale:1.1},whileTap:{scale:.9},children:t.jsx(R,{})}),_().map((e,a)=>t.jsx($.Fragment,{children:e==="..."?t.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):t.jsx(r.button,{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                                                ${e===i.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>h(e),whileHover:{scale:1.05},whileTap:{scale:.95},children:e})},a)),t.jsx(r.button,{className:`p-4 inline-flex items-center ${i.currentPage===i.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>h(i.currentPage+1),disabled:i.currentPage===i.totalPages,whileHover:{scale:1.1},whileTap:{scale:.9},children:t.jsx(L,{})})]})}),t.jsx("div",{children:t.jsxs("p",{className:"font-semibold",children:[i.from," - ",i.to," de ",i.totalItems," Resultados"]})})]})})]}),O?t.jsx(ee,{}):t.jsx(r.div,{className:"flex items-center flex-wrap gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",variants:Z,initial:"hidden",animate:"visible",children:Array.isArray(j)&&j.length>0?j.map((e,a)=>t.jsx(r.div,{custom:a,variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:100,delay:a*.03}}},whileHover:{y:-5},className:"w-full md:w-1/2 lg:w-1/3 px-2",children:t.jsx(se,{product:e,cart:A,setCart:B})},e.id)):t.jsx(te,{})}),t.jsxs(r.div,{className:"flex justify-between items-center mb-4 w-full mt-8",variants:l,children:[t.jsx("div",{className:"customtext-primary font-semibold",children:t.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[t.jsx(r.button,{className:`p-4 inline-flex items-center ${i.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>h(i.currentPage-1),disabled:i.currentPage===1,whileHover:{scale:1.1},whileTap:{scale:.9},children:t.jsx(R,{})}),_().map((e,a)=>t.jsx($.Fragment,{children:e==="..."?t.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):t.jsx(r.button,{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                                        ${e===i.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>h(e),whileHover:{scale:1.05},whileTap:{scale:.95},children:e})},a)),t.jsx(r.button,{className:`p-4 inline-flex items-center ${i.currentPage===i.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>h(i.currentPage+1),disabled:i.currentPage===i.totalPages,whileHover:{scale:1.1},whileTap:{scale:.9},children:t.jsx(L,{})})]})}),t.jsx("div",{children:t.jsxs("p",{className:"font-semibold",children:[i.from," - ",i.to," de ",i.totalItems," Resultados"]})})]})]})]})})})};export{De as default};
