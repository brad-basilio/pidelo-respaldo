import{j as e}from"./AboutHeader-COUW3Uy_.js";import{r as c}from"./index-CqkZ-sT_.js";import{C as B}from"./CardHoverBtn-CgVpcroB.js";import{I as z}from"./ItemsRest-COC0wVJZ.js";import{L as I,N as K}from"./NoResult-CROInX6p.js";import{C as w}from"./chevron-down-CxOx8ByU.js";import{S as L}from"./search-DhoFIDMi.js";import{C as V}from"./check-CvqheCNB.js";import{c as T}from"./createLucideIcon-D0vxYqnu.js";import"./ProductCard-DppMoL6U.js";import"./main-CkMzf7wF.js";import"./___vite-browser-external_commonjs-proxy-DA7w84js.js";import"./BasicEditing-CqE15M_Q.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=T("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),D=({options:u=[],placeholder:f="Select an option",onChange:v,valueKey:C,labelKey:_,label:b,labelClass:k,className:S,disabled:d=!1})=>{const[x,n]=c.useState(!1),[i,m]=c.useState(null),[j,P]=c.useState(""),p=c.useRef(null),y=u.length>0&&typeof u[0]=="object",F=y?C||Object.keys(u[0])[0]:null,O=y?_||Object.keys(u[0])[1]:null,h=u.map(t=>y?{value:t[F],label:t[O]}:{value:t,label:t}).filter(t=>t.label.toLowerCase().includes(j.toLowerCase()));c.useEffect(()=>{const t=$=>{p.current&&!p.current.contains($.target)&&n(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const g=t=>{m(t),v(t.value),n(!1)};return e.jsxs("div",{className:"relative w-full",ref:p,children:[b&&e.jsx("label",{className:`block text-sm mb-1 customtext-neutral-dark ${k}`,children:b}),e.jsxs("button",{className:`w-full relative text-start  px-4 py-3 border customtext-neutral-dark   rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300 ${S}`,onClick:()=>n(!x),"aria-haspopup":"listbox","aria-expanded":x,disabled:d,children:[e.jsx("span",{className:"block truncate",children:i?i.label:f}),e.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center justify-center py-3 pr-2 pointer-events-none",children:e.jsx(w,{className:`w-5 h-5 customtext-neutral-dark transition-transform duration-200 ${x?"rotate-180":""}`})})]}),x&&e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white rounded-lg shadow-lg max-h-60 overflow-auto",children:[e.jsx("div",{className:"sticky top-0 bg-white p-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Search options...",value:j,onChange:t=>P(t.target.value)})]})}),e.jsx("ul",{className:"py-1",role:"listbox",children:h.map(t=>e.jsxs("li",{className:`px-4 py-2 cursor-pointer flex items-center justify-between 
                                    ${i&&i.value===t.value?"bg-blue-500 text-white":"hover:bg-gray-100"}`,onClick:()=>g(t),role:"option","aria-selected":i&&i.value===t.value,children:[e.jsx("span",{className:"block truncate",children:t.label}),i&&i.value===t.value&&e.jsx(V,{className:"w-5 h-5"})]},t.value))})]})]})},H=new z,le=({items:u,data:f,filteredData:v,cart:C,setCart:_})=>{const{categories:b,brands:k,priceRanges:S}=v,[d,x]=c.useState({marca:!0,precio:!0,categoria:!0,colores:!1}),[n,i]=c.useState({category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[m,j]=c.useState([]),[P,p]=c.useState(!1),[y,F]=c.useState({currentPage:1,totalPages:1}),O=s=>{const a=[];if(s.category_id.length>0){const r=s.category_id.map(l=>["category_id","=",l]);a.push(["or",...r])}if(s.subcategory_id.length>0){const r=s.subcategory_id.map(l=>["subcategory_id","=",l]);a.push(["and",...r])}if(s.brand_id.length>0){const r=s.brand_id.map(l=>["brand_id","=",l]);a.push(["or",...r])}return s.price&&a.push(["and",[["final_price",">=",s.price.min],"and",["final_price","<=",s.price.max]]]),s.name&&a.push(["name","contains",s.name]),a},A=async(s=1)=>{p(!0);try{const r={filter:O(n),sort:n.sort,take:20},l=await H.paginate(r);j(l.data),F({currentPage:l.currentPage,totalPages:l.lastPage})}catch(a){console.error("Error fetching products:",a)}finally{p(!1)}};c.useEffect(()=>{A()},[n]),c.useEffect(()=>{const s=new URLSearchParams(window.location.search),a=s.get("category");if(a){const l=b.find(o=>o.slug===a);l&&i(o=>({...o,category_id:[l.id]}))}const r=s.get("search");r&&i(l=>({...l,name:r}))},[u]);const h=(s,a)=>{i(r=>{if(s==="price")return{...r,price:r.price&&r.price.min===a.min&&r.price.max===a.max?null:a};const l=Array.isArray(r[s])?r[s]:[],o=l.includes(a)?l.filter(N=>N!==a):[...l,a];return{...r,[s]:o}})},g=s=>{x(a=>({...a,[s]:!a[s]}))},[t,$]=c.useState(""),[E,R]=c.useState(""),M=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}];return e.jsx("section",{className:"py-12 bg-[#F7F9FB]",children:e.jsxs("div",{className:"mx-auto px-primary",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 pb-4 border-b-2",children:[e.jsx("h2",{className:"text-4xl font-bold w-6/12",children:f==null?void 0:f.title}),e.jsxs("div",{className:"flex items-center gap-4 w-5/12",children:[e.jsxs("span",{className:"block w-6/12",children:["Productos seleccionados: ",e.jsx("strong",{children:m==null?void 0:m.length})]}),e.jsx("div",{className:"w-6/12",children:e.jsx(D,{options:M,placeholder:"Ordenar por",onChange:s=>{const[a,r]=s.split(":"),l=[{selector:a,desc:r==="desc"}];i(o=>({...o,sort:l}))},labelKey:"label",valueKey:"value"})})]})]}),e.jsxs("div",{className:"relative flex gap-4",children:[e.jsxs("div",{className:"w-3/12 bg-white p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsx(Z,{className:"h-5 w-5"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>g("marca"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Marca"}),e.jsx(w,{className:`h-5 w-5 transform transition-transform ${d.marca?"":"-rotate-180"}`})]}),d.marca&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-2 bg-gray-100 rounded-lg text-sm",value:t,onChange:s=>$(s.target.value)})]}),e.jsx("div",{className:"space-y-3",children:k.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>h("brand_id",s.id)}),e.jsx("span",{children:s.name})]},s.id))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>g("precio"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(w,{className:`h-5 w-5 transform transition-transform ${d.precio?"":"-rotate-180"}`})]}),d.precio&&e.jsx("div",{className:"space-y-3",children:S.map(s=>e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>h("price",s),checked:n.price&&n.price.min===s.min&&n.price.max===s.max}),e.jsx("span",{children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>g("categoria"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Categoría"}),e.jsx(w,{className:`h-5 w-5 transform transition-transform ${d.categoria?"":"-rotate-180"}`})]}),d.categoria&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-2 bg-gray-100 rounded-lg text-sm",value:E,onChange:s=>R(s.target.value)})]}),b.map(s=>{var a,r,l;return e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>h("category_id",s.id),checked:(a=n.category_id)==null?void 0:a.includes(s.id)}),e.jsx("span",{children:s.name})]}),((r=n.category_id)==null?void 0:r.includes(s.id))&&((l=s.subcategories)==null?void 0:l.length)>0&&e.jsx("ul",{className:"ml-6 mt-2 space-y-2",children:s.subcategories.map(o=>{var N;return e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>h("subcategory_id",o.id),checked:(N=n.subcategory_id)==null?void 0:N.includes(o.id)}),e.jsx("span",{children:o.name})]},o.id)})})]},s.id)})]})]}),e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-lg hover:brightness-90 transition-colors text-sm font-bold",children:"Aplicar Filtro"})]}),e.jsx("div",{className:"w-9/12 py-4",children:P?e.jsx(I,{}):e.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:Array.isArray(m)&&m.length>0?m.map(s=>e.jsx(B,{product:s,widthClass:"lg:w-1/4",cart:C,setCart:_},s.id)):e.jsx(K,{})})})]})]})})};export{le as default};
