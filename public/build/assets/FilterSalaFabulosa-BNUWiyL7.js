import{j as s}from"./AboutHeader-ClKiNAEV.js";import{r as c,R as _}from"./index-DFv2mRv-.js";import"./ProductCard-NsyC22vv.js";import{I as H}from"./ItemsRest-DK8CnWHO.js";import"./HeaderSearch-BVKOE4_B.js";import"./main-rZoj-gSW.js";import{L as J}from"./Loading-O_y8BNFU.js";import{N as Q}from"./NoResult-BasQTFzm.js";import{S as W}from"./SelectForm-Ckz_d_he.js";import{P as X}from"./ProductCardSimple-BWc0etaM.js";import{C as h}from"./chevron-down-Bgb5hLdB.js";import{S as b}from"./search-BlyVC63b.js";import{C as k,a as S}from"./chevron-right--XtiYjfH.js";import"./ModalImportItem-DaJ_kNWW.js";import"./index-BOPJobjj.js";import"./index-Sd7so-oN.js";import"./index-Cevqm-zP.js";import"./CartItemRow-QqKWGbPZ.js";import"./tippy-react.esm-CGYKl-Jd.js";import"./Number2Currency-e57Tgsuk.js";import"./minus-C_LiTw_8.js";import"./createLucideIcon-CC2OGGjd.js";import"./plus-DqVREqgL.js";import"./___vite-browser-external_commonjs-proxy-BQdpDcDf.js";import"./check-sPmXvS3y.js";const Y=new H,_e=({items:$,data:ee,filteredData:R,cart:L,setCart:F})=>{const{collections:f,categories:j,brands:M,priceRanges:E}=R;console.log(f);const[m,A]=c.useState({collection:!0,marca:!0,precio:!0,categoria:!0,colores:!1}),[o,u]=c.useState({collection_id:[],category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[g,B]=c.useState([]),[I,y]=c.useState(!1),[a,z]=c.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),K=e=>{const t=[];if(e.collection_id.length>0){const r=e.collection_id.map(n=>["collection_id","=",n]);t.push(["or",...r])}if(e.category_id.length>0){const r=e.category_id.map(n=>["category_id","=",n]);t.push(["or",...r])}if(e.subcategory_id.length>0){const r=e.subcategory_id.map(n=>["subcategory_id","=",n]);t.push(["and",...r])}if(e.brand_id.length>0){const r=e.brand_id.map(n=>["brand_id","=",n]);t.push(["or",...r])}return e.price&&t.push(["and",[["final_price",">=",e.price.min],"and",["final_price","<=",e.price.max]]]),e.name&&t.push(["name","contains",e.name]),t},N=async(e=1)=>{y(!0);try{const r={filter:K(o),sort:o.sort,skip:(e-1)*a.itemsPerPage,take:a.itemsPerPage,requireTotalCount:!0},n=await Y.paginate(r);B(n.data),z({currentPage:e,totalPages:Math.ceil(n.totalCount/a.itemsPerPage),totalItems:n.totalCount,itemsPerPage:a.itemsPerPage,from:(e-1)*a.itemsPerPage+1,to:Math.min(e*a.itemsPerPage,n.totalCount)})}catch(t){console.error("Error fetching products:",t)}finally{y(!1)}};c.useEffect(()=>{N(a.currentPage)},[o]);const d=e=>{e>=1&&e<=a.totalPages&&N(e)},w=()=>{const e=[],t=a.totalPages,r=a.currentPage,n=2;for(let i=1;i<=t;i++)i===1||i===t||i>=r-n&&i<=r+n?e.push(i):(i===r-n-1||i===r+n+1)&&e.push("...");return e.filter((i,l,G)=>i!=="..."||G[l-1]!=="...")};c.useEffect(()=>{const e=new URLSearchParams(window.location.search),t=e.get("category");if(t){const i=j.find(l=>l.slug===t);i&&u(l=>({...l,category_id:[i.id]}))}const r=e.get("collection");if(r){const i=f.find(l=>l.slug===r);i&&u(l=>({...l,collection_id:[i.id]}))}const n=e.get("search");n&&u(i=>({...i,name:n}))},[$]);const x=(e,t)=>{u(r=>{if(e==="price")return{...r,price:r.price&&r.price.min===t.min&&r.price.max===t.max?null:t};const n=Array.isArray(r[e])?r[e]:[],i=n.includes(t)?n.filter(l=>l!==t):[...n,t];return{...r,[e]:i}})},p=e=>{A(t=>({...t,[e]:!t[e]}))},O=[{value:"created_at:desc",label:"MÃ¡s reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[P,V]=c.useState(""),[C,Z]=c.useState(""),[v,q]=c.useState(""),D=f.filter(e=>e.name.toLowerCase().includes(C.toLowerCase())),T=j.filter(e=>e.name.toLowerCase().includes(P.toLowerCase())),U=M.filter(e=>e.name.toLowerCase().includes(v.toLowerCase()));return s.jsx("section",{className:"py-6  font-font-general customtext-primary",children:s.jsx("div",{className:"mx-auto px-primary",children:s.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"w-full sm:w-1/5 bg-white p-4 rounded-lg h-max",children:[s.jsx("p",{className:"customtext-primary text-2xl font-bold pb-4 mb-4 border-b",children:"Combina como desees tu sala"}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>p("marca"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-semibold text-lg",children:"Marca"}),s.jsx(h,{className:`h-5 w-5 transform transition-transform ${m.marca?"":"-rotate-180"}`})]}),m.marca&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:v,onChange:e=>q(e.target.value)})]}),s.jsx("div",{className:"space-y-3",children:U.map(e=>s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>x("brand_id",e.id)}),s.jsx("span",{children:e.name})]},e.id))})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>p("collection"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Colecciones"}),s.jsx(h,{className:`h-5 w-5 transform transition-transform ${m.collection?"":"-rotate-180"}`})]}),m.collection&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:C,onChange:e=>Z(e.target.value)})]}),D.map(e=>{var r,n;const t=(r=o.collection_id)==null?void 0:r.includes(e.id);return s.jsx("div",{className:`group py-2 rounded-md ${t?"bg-secondary":"bg-transparent"}`,children:s.jsxs("label",{className:"flex items-center space-x-3 ",children:[s.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>x("collection_id",e.id),checked:(n=o.collection_id)==null?void 0:n.includes(e.id)}),s.jsx("img",{src:`/storage/images/collection/${e.image}`,onError:i=>i.target.src="assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"}),s.jsx("span",{children:e.name})]})},e.id)})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>p("categoria"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Categorias"}),s.jsx(h,{className:`h-5 w-5 transform transition-transform ${m.categoria?"":"-rotate-180"}`})]}),m.categoria&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:P,onChange:e=>V(e.target.value)})]}),T.map(e=>{var r,n;const t=(r=o.category_id)==null?void 0:r.includes(e.id);return s.jsx("div",{className:`group py-2 rounded-md ${t?"bg-secondary":"bg-transparent"}`,children:s.jsxs("label",{className:"flex items-center space-x-3 ",children:[s.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>x("category_id",e.id),checked:(n=o.category_id)==null?void 0:n.includes(e.id)}),s.jsx("img",{src:`/storage/images/category/${e.image}`,onError:i=>i.target.src="assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"}),s.jsx("span",{children:e.name})]})},e.id)})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>p("precio"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Precio"}),s.jsx(h,{className:`h-5 w-5 transform transition-transform ${m.precio?"":"-rotate-180"}`})]}),m.precio&&s.jsx("div",{className:"space-y-3",children:E.map(e=>s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>x("price",e),checked:o.price&&o.price.min===e.min&&o.price.max===e.max}),s.jsx("span",{children:`S/ ${e.min} - S/ ${e.max}`})]},`${e.min}-${e.max}`))})]})]}),s.jsxs("div",{className:"w-full sm:w-4/5 py-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4 w-full",children:[s.jsxs("div",{className:"flex gap-4 items-center",children:[s.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),s.jsx(W,{options:O,placeholder:"Recomendados",onChange:e=>{const[t,r]=e.split(":"),n=[{selector:t,desc:r==="desc"}];u(i=>({...i,sort:n}))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[s.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(a.currentPage-1),disabled:a.currentPage===1,children:s.jsx(k,{})}),w().map((e,t)=>s.jsx(_.Fragment,{children:e==="..."?s.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):s.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${e===a.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>d(e),children:e})},t)),s.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===a.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(a.currentPage+1),disabled:a.currentPage===a.totalPages,children:s.jsx(S,{})})]})}),s.jsx("div",{children:s.jsxs("p",{className:"font-semibold",children:[a.from," - ",a.to," ","de ",a.totalItems," ","Resultados"]})})]})})]}),I?s.jsx(J,{}):s.jsx("div",{className:"flex items-center flex-wrap gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray(g)&&g.length>0?g.map(e=>s.jsx(X,{product:e,widthClass:"lg:w-1/3",cart:L,setCart:F},e.id)):s.jsx(Q,{})}),s.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsx("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[s.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(a.currentPage-1),disabled:a.currentPage===1,children:s.jsx(k,{})}),w().map((e,t)=>s.jsx(_.Fragment,{children:e==="..."?s.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):s.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${e===a.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>d(e),children:e})},t)),s.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===a.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(a.currentPage+1),disabled:a.currentPage===a.totalPages,children:s.jsx(S,{})})]})})})}),s.jsx("div",{children:s.jsxs("p",{className:"font-semibold",children:[a.from," - ",a.to," de"," ",a.totalItems," Resultados"]})})]})]})]})})})};export{_e as default};
