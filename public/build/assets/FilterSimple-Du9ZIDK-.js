import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as i}from"./index-BH53Isel.js";import{S as B}from"./react-select.esm-Bm_2RwVo.js";import{I as J}from"./ItemsRest-CGu6Sw-g.js";import{F as S}from"./FilterPagination-DCLrjB48.js";import{A as k}from"./ArrayJoin-2k6ba35P.js";import{P as M}from"./ProductCard-CXvomStU.js";import"./index-yBjzXJbu.js";import"./Select-aab027f3.esm-kGkkFbxE.js";import"./hoist-non-react-statics.cjs-kbdZbs82.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";import"./main-BvVILmTO.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./BasicRest-C_0LADdJ.js";import"./Number2Currency-e57Tgsuk.js";import"./tippy-react.esm-BWiGTO87.js";import"./ProductCard-Bvp3XiVT.js";const L=new J,b=({summary:s,keyName:c,field:m,otherField:p,title:v,onChange:N,filter:a})=>{var u;if((s[c]??[]).length==0)return;const d=a.find(l=>l.field==m);return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-2"}),e.jsxs("div",{children:[e.jsx("b",{className:"mb-1 block",children:v}),e.jsx("div",{className:"flex flex-wrap gap-x-2 gap-y-1",children:(u=s[c])==null?void 0:u.map((l,n)=>{var g;const y=(g=d==null?void 0:d.values)==null?void 0:g.includes(l.id);return e.jsxs("label",{className:"cursor-pointer border rounded-lg py-1 px-2 text-sm",children:[e.jsx("input",{className:"me-1 cursor-pointer",type:"checkbox",name:m,value:l.id,"other-field":p,"other-field-value":l[p],onChange:N,checked:y}),e.jsx("span",{children:l.name})]},n)})})]})]})},ae=({data:s,category:c,subcategory:m,cart:p,setCart:v})=>{const N=["category_id","subcategory_id","brand_id","item_tag.tag_id"],[a,d]=i.useState(N.map(r=>{const t=[];return r=="category_id"&&c&&t.push(c.id),r=="subcategory_id"&&m&&t.push(m.id),{field:r,values:t}})),[u,l]=i.useState([]),[n,y]=i.useState({value:"asc",label:e.jsxs(e.Fragment,{children:["Menor a mayor ",e.jsx("i",{className:"mdi mdi-arrow-up"})]})}),[g,P]=i.useState(0),[w,I]=i.useState(1),[x,C]=i.useState(1),[h,A]=i.useState({}),[E,_]=i.useState(!1);i.useEffect(()=>{R()},[a,n,x]);const f=({target:r})=>{const t=r.name,j=r.value,F=r.checked,T=r.getAttribute("other-field"),O=r.getAttribute("other-field-value");d(V=>V.map(o=>(o.field==t&&(F?o.values.push(j):o.values=o.values.filter(q=>q!=j)),o.field==T&&F&&o.values.push(O),o)))},R=async()=>{_(!0),l([]);const r=await L.paginate({filter:k(a.map(t=>{if(t.values.length!=0)return k(t.values.map(j=>[t.field,"=",j]),"or")}).filter(Boolean),"and"),take:12,skip:12*(x-1),requireTotalCount:!0,sort:[{selector:"final_price",desc:n.value=="desc"},{selector:"discount_percent",desc:n.value!="desc"}]});r.status&&(l(r.data??[]),P(r.totalCount),I(Math.ceil(r.totalCount/12)),A(r.summary),_(!1))};return e.jsx("section",{className:"bg-white",children:e.jsxs("div",{className:"px-[5%] replace-max-w-here w-full mx-auto px-4 py-[5%] md:py-[2.5%]",children:[((s==null?void 0:s.title)||(s==null?void 0:s.description))&&e.jsxs("div",{className:"mb-[2%]",children:[(s==null?void 0:s.title)&&e.jsx("h1",{className:"text-2xl font-bold mb-[2%]",children:s==null?void 0:s.title}),(s==null?void 0:s.description)&&e.jsx("p",{className:"text-sm mb-[3%]",children:s==null?void 0:s.description})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5",children:[e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"shadow-lg border h-max sticky top-4 p-4 rounded-3xl",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Filtros de items"}),e.jsx(b,{filter:a,keyName:"categories",title:"Categoria",field:"category_id",summary:h,onChange:f}),e.jsx(b,{filter:a,keyName:"subcategories",title:"Subcategoria",field:"subcategory_id",otherField:"category_id",summary:h,onChange:f}),e.jsx(b,{filter:a,keyName:"brands",title:"Marca",field:"brand_id",summary:h,onChange:f}),e.jsx(b,{filter:a,keyName:"tags",title:"Tags",field:"item_tag.tag_id",summary:h,onChange:f}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{children:[e.jsx("b",{className:"mb-1 block",children:"Ordenar precio"}),e.jsx(B,{className:"text-sm",options:[{value:"asc",label:e.jsxs(e.Fragment,{children:["Menor a mayor"," ",e.jsx("i",{className:"mdi mdi-arrow-up"})]})},{value:"desc",label:e.jsxs(e.Fragment,{children:["Mayor a menor"," ",e.jsx("i",{className:"mdi mdi-arrow-down"})]})}],defaultValue:n,onChange:r=>y(r)})]})]})}),e.jsxs("div",{className:"w-full md:col-span-2 lg:col-span-3",children:[e.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5 mb-[2.5%] items-center justify-between",children:[e.jsxs("div",{className:"",children:["Mostrando ",e.jsx("b",{children:u.length})," items de"," ",e.jsx("b",{children:g})]}),e.jsxs("div",{className:"lg:col-span-2 flex justify-between w-full",children:[e.jsx("div",{className:"mx-auto"}),e.jsx(S,{pages:w,current:x,setCurrent:C})]})]}),e.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5",children:[u.map((r,t)=>e.jsx(M,{data:s,item:r,cart:p,setCart:v},t)),E&&[null,null,null].map(r=>e.jsx(M,{}))]}),e.jsx("div",{className:"mt-[5%] w-max max-w-full mx-auto",children:e.jsx(S,{pages:w,current:x,setCurrent:C})})]})]})]})})};export{ae as default};
