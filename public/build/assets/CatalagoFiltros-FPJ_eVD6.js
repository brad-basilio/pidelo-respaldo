import{j as e}from"./AboutHeader-ClKiNAEV.js";import{r as n}from"./index-DFv2mRv-.js";import{C as z}from"./CardHoverBtn-Bp5YJek1.js";import{I as D}from"./ItemsRest-Djkdejt2.js";import{N as U}from"./NoResult-BasQTFzm.js";import{S as X}from"./SelectForm-Ckz_d_he.js";import{F as C}from"./filter-BoD8ff5S.js";import{X as G}from"./x-D9PPtze2.js";import{C as g}from"./chevron-down-Bgb5hLdB.js";import{S as _}from"./search-BlyVC63b.js";import"./ProductCard-NsyC22vv.js";import"./main-rZoj-gSW.js";import"./___vite-browser-external_commonjs-proxy-BQdpDcDf.js";import"./ModalImportItem-omSGl0lS.js";import"./HeaderSearch-C6xLnU5a.js";import"./index-BOPJobjj.js";import"./index-Sd7so-oN.js";import"./index-Cevqm-zP.js";import"./CartItemRow-BRRZMnl0.js";import"./tippy-react.esm-CGYKl-Jd.js";import"./Number2Currency-e57Tgsuk.js";import"./minus-C_LiTw_8.js";import"./createLucideIcon-CC2OGGjd.js";import"./plus-DqVREqgL.js";import"./check-sPmXvS3y.js";const J=new D,Q=()=>e.jsx("div",{className:"group  animate-pulse  transition-transform duration-300 hover:scale-105 w-1/2 lg:w-1/4 flex-shrink-0 font-font-general customtext-primary cursor-pointer",children:e.jsx("div",{className:" px-4",children:e.jsx("div",{className:"bg-white rounded-3xl",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"aspect-square bg-gray-300 rounded-3xl overflow-hidden flex items-center justify-center  bg-secondary",children:e.jsx("svg",{class:"w-10 h-10 text-gray-200 ","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 18",children:e.jsx("path",{d:"M18 0H2a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm-5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm4.376 10.481A1 1 0 0 1 16 15H4a1 1 0 0 1-.895-1.447l3.5-7A1 1 0 0 1 7.468 6a.965.965 0 0 1 .9.5l2.775 4.757 1.546-1.887a1 1 0 0 1 1.618.1l2.541 4a1 1 0 0 1 .028 1.011Z"})})})})})})}),ve=({items:k,data:x,filteredData:S,cart:P,setCart:F})=>{const{categories:p,brands:A,priceRanges:M}=S,[o,$]=n.useState({marca:!0,precio:!0,categoria:!0,colores:!1}),[c,m]=n.useState({category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[d,B]=n.useState([]),[E,b]=n.useState(!1),[T,L]=n.useState({currentPage:1,totalPages:1}),R=s=>{const a=[];if(s.category_id.length>0){const t=s.category_id.map(r=>["category_id","=",r]);a.push(["or",...t])}if(s.subcategory_id.length>0){const t=s.subcategory_id.map(r=>["subcategory_id","=",r]);a.push(["and",...t])}if(s.brand_id.length>0){const t=s.brand_id.map(r=>["brand_id","=",r]);a.push(["or",...t])}return s.price&&a.push(["and",[["final_price",">=",s.price.min],"and",["final_price","<=",s.price.max]]]),s.name&&a.push(["name","contains",s.name]),a},Z=async(s=1)=>{b(!0);try{const t={filter:R(c),sort:c.sort,take:1e3},r=await J.paginate(t);B(r.data),L({currentPage:r.currentPage,totalPages:r.lastPage})}catch(a){console.error("Error fetching products:",a)}finally{b(!1)}};n.useEffect(()=>{Z()},[c]),n.useEffect(()=>{const s=new URLSearchParams(window.location.search),a=s.get("category"),t=s.get("subcategory");if(a){const l=p.find(i=>i.slug===a);l&&m(i=>({...i,category_id:[l.id]}))}if(t){let l=null,i=null;p.forEach(h=>{const v=h.subcategories.find(q=>q.slug===t);v&&(l=v,i=h)}),l&&i&&m(h=>({...h,category_id:[i.id],subcategory_id:[l.id]}))}const r=s.get("search");r&&m(l=>({...l,name:r}))},[k]);const u=(s,a)=>{m(t=>{if(s==="price")return{...t,price:t.price&&t.price.min===a.min&&t.price.max===a.max?null:a};const r=Array.isArray(t[s])?t[s]:[],l=r.includes(a)?r.filter(i=>i!==a):[...r,a];return{...t,[s]:l}})},f=s=>{$(a=>({...a,[s]:!a[s]}))},O=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[j,H]=n.useState(""),[y,V]=n.useState(""),I=p.filter(s=>s.name.toLowerCase().includes(j.toLowerCase())),K=A.filter(s=>s.name.toLowerCase().includes(y.toLowerCase())),[w,N]=n.useState(!1);return e.jsx("section",{className:"py-12 bg-sections-color customtext-neutral-dark",children:e.jsxs("div",{className:"mx-auto px-primary 2xl:px-0 2xl:max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between items-center mb-8 pb-4 border-b-2",children:[e.jsx("h2",{className:"text-[32px] md:text-4xl font-bold md:w-6/12",children:x==null?void 0:x.title}),e.jsxs("div",{className:"flex items-center gap-4 md:w-5/12",children:[e.jsxs("span",{className:"block w-6/12",children:["Productos seleccionados:"," ",e.jsx("strong",{children:d==null?void 0:d.length})]}),e.jsx("div",{className:"w-6/12",children:e.jsx(X,{options:O,placeholder:"Ordenar por",onChange:s=>{const[a,t]=s.split(":"),r=[{selector:a,desc:t==="desc"}];m(l=>({...l,sort:r}))},labelKey:"label",valueKey:"value"})})]})]}),e.jsxs("div",{className:"relative flex flex-col lg:flex-row gap-4",children:[e.jsxs("button",{className:"w-full flex lg:hidden gap-2 items-center",onClick:()=>N(!0),children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Filtros"}),e.jsx(C,{className:"h-5 w-5"})]}),e.jsxs("div",{className:`${w?"fixed inset-0 z-50 bg-white p-4 overflow-y-auto":"hidden"} lg:block lg:w-3/12 bg-white p-4 rounded-lg h-max`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsx(C,{className:"hidden lg:block h-5 w-5"}),e.jsx("button",{className:" lg:hidden ",onClick:()=>N(!w),children:e.jsx(G,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>f("marca"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Marca"}),e.jsx(g,{className:`h-5 w-5 transform transition-transform ${o.marca?"":"-rotate-180"}`})]}),o.marca&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:y,onChange:s=>V(s.target.value)})]}),e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:K.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 customtext-neutral-light",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>u("brand_id",s.id)}),e.jsx("span",{children:s.name})]},s.id))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>f("precio"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(g,{className:`h-5 w-5 transform transition-transform ${o.precio?"":"-rotate-180"}`})]}),o.precio&&e.jsx("div",{className:"space-y-3",children:M.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 customtext-neutral-light",children:[e.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>u("price",s),checked:c.price&&c.price.min===s.min&&c.price.max===s.max}),e.jsx("span",{children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>f("categoria"),className:"flex items-center justify-between w-full mb-4",children:[e.jsx("span",{className:"font-medium",children:"Categoría"}),e.jsx(g,{className:`h-5 w-5 transform transition-transform ${o.categoria?"":"-rotate-180"}`})]}),o.categoria&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:j,onChange:s=>H(s.target.value)})]}),e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:I.map(s=>{var a,t,r;return e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-3 customtext-neutral-light",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>u("category_id",s.id),checked:(a=c.category_id)==null?void 0:a.includes(s.id)}),e.jsx("span",{children:s.name})]}),((t=c.category_id)==null?void 0:t.includes(s.id))&&((r=s.subcategories)==null?void 0:r.length)>0&&e.jsx("ul",{className:"ml-6 mt-2 space-y-2",children:s.subcategories.map(l=>{var i;return e.jsxs("label",{className:"flex items-center space-x-3 customtext-neutral-light",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>u("subcategory_id",l.id),checked:(i=c.subcategory_id)==null?void 0:i.includes(l.id)}),e.jsx("span",{children:l.name})]},l.id)})})]},s.id)})})]})]}),e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl hover:brightness-90 transition-colors text-sm font-bold",children:"Aplicar Filtro"})]}),e.jsx("div",{className:"w-full lg:w-9/12 py-4",children:E?e.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(s=>e.jsx(Q,{},s))}):e.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:Array.isArray(d)&&d.length>0?d.map(s=>e.jsx("div",{className:"   w-1/2 lg:w-1/3 xl:w-1/4 lg:h-[460px] lg:max-h-[460px]  xl:h-[400px] xl:max-h-[400px] 2xl:h-[430px] 2xl:max-h-[430px] flex items-center justify-center",children:e.jsx(z,{data:x,product:s,widthClass:"w-full sm:w-full lg:w-full",cart:P,setCart:F})},s.id)):e.jsx(U,{})})})]})]})})};export{ve as default};
